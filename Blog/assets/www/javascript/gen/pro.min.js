MWF.P("mb.c");MWF.P("mb.x");MWF.P("mb.g");MWF.P("mb.m");MWF.P("mb.d");MWF.P("mb.w");(function(u,p){p._TAG_KEY=u._$randNumberString()})(MWF.P("mwf.u"),MWF.P("mb.c"));(function(u,j,d,x){var __trim=/(?:^\s+)|(?:\s+$)/g;x._$trim=function(_content){return !!_content&&!!_content.replace&&_content.replace(__trim,"")||""};x.top=function(){document.body.scrollTop=0;document.documentElement.scrollTop=0};x.scrollTop=function(_bst,_dst){document.body.scrollTop=_bst;document.documentElement.scrollTop=_dst};x.cancelNotification=function(){navigator.notification.cancel()};x.exit=function(){if(!!d._$$CacheMessage){d._$$CacheMessage._$close()}navigator.notification.cancel();mwf.mb._$doExit()};x.back=function(){mwf.mb._$exec("NUtils.moveApplicationToBack")};x.loadFinish=function(){mwf.mb._$doLoadFinish()};x.alert=function(_content){if(!!window.NUtils){try{mwf.u.showToast(_content,5000)}catch(e){}}else{alert(_content)}};x.confirm=function(_content,_callback){if(!!window.NUtils){try{mwf.u.PopUpDialog("",_content,["确定","取消"],_callback)}catch(e){_callback("false")}}else{_callback(confirm(_content)==true?"true":"false")}};x.refresh=function(){if(!!d._$$CacheMessage){d._$$CacheMessage._$close()}location.reload()};x._$datetime=(function(){var _tmin1=60*1000,_thor1=60*_tmin1,_tday1=24*_thor1;return function(_time){if(!_time){return}if(u._$isString(_time)){_time=parseInt(_time)}var _date0=new Date(),_date1=new Date(_time),_delta=_date0.getTime()-_time;if(_delta>13*_thor1){return u._$format(_time,(_date1.getFullYear()!=_date0.getFullYear()?"yyyy-":"")+"MM-dd HH:mm")}for(var i=12;i>0;i--){if(_delta>i*_thor1){return i+"小时前"}}if(_delta>30*_tmin1){return"半小时前"}if(_delta>15*_tmin1){return"一刻钟前"}if(_delta>10*_tmin1){return"10分钟前"}if(_delta>5*_tmin1){return"5分钟前"}return"1分钟前"}})();x._$getFileName=(function(){var _reg=/\/([^\/]*?)(?:\.|$)/i;return function(_path){_reg.test(_path||"");return RegExp.$1||""}})();x._$getParmvalByKey=function(_hash,_key){if(!u._$isString(_hash)){return _hash}_hash=x._$trim(_hash);_hash=_hash.substr(_hash.indexOf("#")+1);if(!_hash){return""}_hash=_hash.split("&");for(var i=0,l=_hash.length,d;i<l;i++){d=_hash[i].indexOf("=");if(_hash[i].substring(0,d)===_key){return _hash[i].substr(d+1)||""}}return""};x._$getHostName=function(){return x._$getParmvalByKey(location.hash,"uname")||d._$VISITOR.userName};x._$isOnline=function(){if(!!window.NUtils){return mwf.mb._$isOnline()}else{return true}};x._$subString=function(_content,_length){_content=_content||"";if(!_length){return _content}for(var i=0,k=0,l=_content.length;i<l;i++){k+=_content.charCodeAt(i)>255?2:1;if(k>=_length){return _content.substr(0,i+(k==_length?1:0))}}return _content};window.x.m=window.x.m||{};window.x.m.go=function(_url){location.href=(_url||"")};window.x.m.gotoMood=window.x.m.go._$bind(null,"#m=1&t=1");window.x.m.gotoBlog=window.x.m.go._$bind(null,"#m=1&t=2");window.x.m.gotoPhoto=window.x.m.go._$bind(null,"#m=1&t=3");x.post=function(){u.PopUpMenu("发布",'[{"title":"日志","action":"window.x.m.gotoBlog()"},{"title":"心情","action":"window.x.m.gotoMood()"}]')}})(MWF.P("mwf.u"),MWF.P("mwf.j"),MWF.P("mb.d"),MWF.P("mb.x"));(function(o,f,e,v,t,x,p){var __proSimpleList;p._$$SimpleList=MWF.C();__proSimpleList=p._$$SimpleList._$extend(t._$$Event);__proSimpleList.__init=function(_options){this.__super();_options=_options||o;this.__tkey=_options.jst;this.__tdat=_options.ext||o;this.__limit=_options.limit||10;this.__nsel=e._$get(_options.sel);this.__ntxt=e._$get(_options.txt);this.__nbox=e._$get(_options.box);this.__nbtn=e._$get(_options.btn);this.__ntip=e._$create("div","js-refresh");this.__jopt={datetime:x._$datetime};this.__sept=_options.empty||"没有数据！";this.__stip='<div class="m-dwnmore ${tag}">                    <a>                        <div class="m-refresh">                            <div class="dot dot0"></div>                            <div class="dot dot1"></div>                            <div class="dot dot2"></div>                            <div class="dot dot3"></div>                            <div class="dot dot4"></div>                            <div class="dot dot5"></div>                        </div>                                                            正在加载                    </a>                    </div>';this._$addEvent("onnext",_options.onnext||f);v._$addEvent(this.__nbtn,"click",this.__onNext._$bind(this));v._$addEvent(this.__nsel,"change",this.__onChange._$bind(this))};__proSimpleList.__onNext=function(_event){v._$stopDefault(_event);this.__nbtn.style.display="none";e._$removeByEC(this.__ntip);this.__ntip.innerHTML=this.__stip;this.__nbox.appendChild(this.__ntip);this.__offset+=this.__limit;this._$dispatchEvent("onnext",this.__offset,this.__limit,this.__type)};__proSimpleList.__onChange=function(){var _index=this.__nsel.selectedIndex;if(_index==0){return}this.__changeWithIndex(_index)};__proSimpleList.__refresh=function(){e._$removeByEC(this.__ntip);this.__offset=0-this.__limit;this.__nbox.innerHTML="";this.__onNext()};__proSimpleList.__changeWithIndex=function(_index){if(!!this.__nsel){var _option=this.__nsel.options[_index]||this.__nsel.options[1],_value=_option.value,_text=_option.text||"";if(this.__type==_value){return}this.__type=_value;this.__nsel.selectedIndex=0;if(!!this.__ntxt){this.__ntxt.innerText=_text}}this.__refresh()};__proSimpleList.__appendWithFullList=function(_list){this.__nbox.insertAdjacentHTML("beforeEnd",e._$getHtmlTemplate(this.__tkey,{xlist:_list,ext:this.__tdat,beg:0,end:Math.min(this.__limit,_list.length)},this.__jopt));if(_list.length+(_list.mergeCount||0)>=this.__limit){this.__nbtn.style.display=""}};__proSimpleList.__appendWithFragment=function(_list){var _delta=_list.length-this.__offset;this.__nbox.insertAdjacentHTML("beforeEnd",e._$getHtmlTemplate(this.__tkey,{xlist:_list,ext:this.__tdat,beg:this.__offset,end:this.__offset+Math.min(this.__limit,_delta)},this.__jopt));if(_delta+(_list.mergeCount||0)>=this.__limit){this.__nbtn.style.display=""}};__proSimpleList._$refresh=function(){this.__tdat=(arguments[1]||o).ext||this.__tdat;delete this.__type;this.__changeWithIndex(arguments[0])};__proSimpleList._$append=function(_list,_appendFull){e._$removeByEC(this.__ntip);if(!_list){return}if(this.__offset==0&&!_list.length){this.__ntip.innerHTML=this.__sept;this.__nbox.appendChild(this.__ntip);return}if(!!_appendFull){this.__appendWithFullList(_list)}else{this.__appendWithFragment(_list)}}})(MWF.O,MWF.F,MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mwf.ut"),MWF.P("mb.x"),MWF.P("mb.w"));(function(r,o,f,j,t,p,x){var __proCache;var __adjustOption=function(_options,_offset,_limit){_options.param=[_offset,_limit]};var __filterList=function(_data){return(_data.resultData||o).list};var __filterItem=function(_data){return _data};p._$$Cache=MWF.C();__proCache=p._$$Cache._$extend(t._$$Cache);__proCache.__getDWROption=function(){var _visitor=p._$VISITOR||o,_options={path:"http://wap.blog.163.com/w2/dwr/call/plaincall/",query:"from=AndroidClient1.0"};if(!!_visitor.userName){_options.query+="&h="+x._$getHostName()}if(!!p._$IP){_options.query+="&ip="+p._$IP}if(!!_visitor.sid){_options.headers={"Auth-Key":_visitor.sid}}return _options};__proCache.__getDWROptionPhoto=function(){var _visitor=p._$PHOTOVISITOR||o,_options={query:"u="+_visitor.userName+"&h="+_visitor.userName+"&NTES_SESS=&NTES_188SS=&sitefrom=blog_android",path:"http://photo.163.com/oauth/photo/"+_visitor.userName+"/dwr/call/plaincall/"};if(!!_visitor.sid){_options.headers={"Auth-Key":_visitor.sid}}return _options};__proCache._$getListByKeyInCache=function(_key){return this.__getDataLocalWithDefault(_key,[])};__proCache._$getListByDWR=function(_options){_options=_options||o;var _key=_options.key,_limit=_options.limit,_offset=_options.offset,_list=this._$getListByKeyInCache(_key);if(this.__hasFragment(_list,_offset,_limit)){this._$dispatchEvent.apply(this,_options.callback||r);return}var _option=!_options.photo?this.__getDWROption():this.__getDWROptionPhoto();_option.onload=this.__getListByDWR._$bind2(this,_options);_option.onerror=this.__getListByDWR._$bind(this,null);(_options.parse||__adjustOption)(_option,_offset,_limit);j._$requestByDWR(_options.url,_option)};__proCache.__getListByDWR=function(_data,_options){try{if(!!_data){_options=_options||o;var _key=_options.key,_limit=_options.limit,_offset=_options.offset,_list=(_options.filter||__filterList)(_data),_cache=this._$getListByKeyInCache(_key);if(!!_list){if(_list.length!=_limit){_cache.loaded=true}for(var i=0,k=0,l=_list.length,_item,_adjust=_options.adjust||__filterItem;i<l;i++){_item=_adjust(_list[i]);if(!!_item){_cache[_offset+k]=_item;k++}}}this.__setDataLocal(_key,_cache)}this._$dispatchEvent.apply(this,_options.callback||r)}catch(e){alert(e.message)}};__proCache._$clearDataLocal=function(_key){this.__delDataLocal(_key)}})([],MWF.O,MWF.F,MWF.P("mwf.j"),MWF.P("mwf.ut"),MWF.P("mb.d"),MWF.P("mb.x"));(function(t,p){var __proBlogXAuth,__proPhotoXAuth;p._$$BlogXAuth=MWF.C();__proBlogXAuth=p._$$BlogXAuth._$extend(t._$$OAuth,true);__proBlogXAuth.__initConfig=function(){p._$$BlogXAuth._$supro.__initConfig.call(this);this.__id="netease-blog-xauth";this.__consumer_key="a7ebe2ace2a9cb05ecc6c34ff263cc39";this.__consumer_secret="d350646e07c5a1c06a44107ff99128ba";this.__request_token_url="http://wap.blog.163.com/w2/oauth/OauthAccess";this.__authorize_url="http://wap.blog.163.com/w2/oauth/OauthAccess";this.__access_token_url="http://wap.blog.163.com/w2/oauth/OauthAccess"};p._$$PhotoXAuth=MWF.C();__proPhotoXAuth=p._$$PhotoXAuth._$extend(t._$$OAuth,true);__proPhotoXAuth.__initConfig=function(){p._$$PhotoXAuth._$supro.__initConfig.call(this);this.__id="netease-photo-xauth";this.__consumer_key="ca896e97dbaa5668011b4ae31b001614";this.__consumer_secret="4fae9ea6ed9b1b124500a504dc64fda3";this.__request_token_url="http://photo.163.com/papi/oauth/OauthAccess";this.__authorize_url="http://photo.163.com/papi/oauth/OauthAccess";this.__access_token_url="http://photo.163.com/papi/oauth/OauthAccess"}})(MWF.P("mwf.ut"),MWF.P("mb.d"));(function(f,j,u,x,p){var __proCacheUser,__accessToken="blogAccessToken";p._$$CacheUser=MWF.C();__proCacheUser=p._$$CacheUser._$extend(p._$$Cache);__proCacheUser._$logout=function(){delete p._$VISITOR;this._$setAutoLogin(false);u.SetLoginState("logout")};__proCacheUser._$loginByXAuth=function(_username,_password){if(!_username||!_password){mb.x.alert("请输入用户名密码！");return}var __this=this;p._$$BlogXAuth._$getAccexxToken(_username,_password,{passtype:0,onfail:function(_error){__this._$dispatchEvent("onlogin",-1)},onsucc:this._$getUserAccount._$bind(this,_username,_password)})};__proCacheUser._$loginPhotoByXAuth=function(_username,_password){if(!_username||!_password){return}p._$$PhotoXAuth._$getAccexxToken(_username,_password,{passtype:0,onfail:function(_error){},onsucc:this.__setPhotoXauthKey._$bind(this,_username)})};__proCacheUser._$getUserAccount=function(_username,_password,_xauthKey,_xauthToken){var _options=this.__getDWROption();_options.sync=true;_options.headers={"Auth-Key":_xauthKey};_options.onload=this.__getUserAccount._$bind(this,_username,_xauthKey,_xauthToken);_options.onerror=this.__getUserAccount._$bind2(this,null);j._$requestByDWR("MobileUserBean.getUserAccount",_options);this._$loginPhotoByXAuth(_username,_password)};__proCacheUser.__getUserAccount=function(_username,_xauthKey,_xauthToken,_data){var _result=-100;if(!!_data&&!!_data.resultData){_result=1;p._$VISITOR={sid:_xauthKey,xauthToken:_xauthToken,ulog:_username,userId:_data.resultData.userId,userName:_data.resultData.userName};if(!!this._$getRemember()){this._$setAutoLogin(true)}j._$setDataInStorage("visitor",p._$VISITOR);u.SetLoginState("login")}else{_result=-2;delete p._$VISITOR;if(!!p._$PHOTOVISITOR){delete p._$PHOTOVISITOR}}this._$dispatchEvent("onlogin",_result)};__proCacheUser.__setPhotoXauthKey=function(_username,_xauthKey,_xauthToken){if(!!_username){_username=this._$photo163Name(_username)}p._$PHOTOVISITOR={sid:_xauthKey,xauthToken:_xauthToken,userName:_username};j._$setDataInStorage("photovisitor",p._$PHOTOVISITOR)};__proCacheUser._$photo163Name=function(passportname){if(passportname.slice(-8)==="@163.com"){return passportname.replace("@163.com","")}if(passportname.slice(-8)==="@126.com"){return passportname.replace("@126.com","@126")}else{if(passportname.slice(-8)==="@188.com"){return passportname.replace("@188.com","@188")}else{if(passportname.slice(-13)==="@popo.163.com"){return passportname.replace("@popo.163.com",".popo")}else{if(passportname.slice(-12)==="@vip.163.com"){return passportname.replace("@vip.163.com",".vip")}else{if(passportname.slice(-9)==="@yeah.net"){return passportname.replace("@yeah.net","@yeah")}else{if(passportname.slice(-5)==="@game"){return passportname}else{if(passportname.slice(-12)==="@vip.126.com"){return passportname}}}}}}}return passportname};__proCacheUser._$isLogin=function(){return !!p._$VISITOR&&!!p._$VISITOR.sid};__proCacheUser._$autologin=function(){var __result=1;p._$VISITOR=j._$getDataInStorage("visitor");p._$PHOTOVISITOR=j._$getDataInStorage("photovisitor")||{};if(!this._$isAutoLogin()){__result=-101}else{if(!p._$VISITOR||!p._$VISITOR.sid){__result=-102}}this._$dispatchEvent("onlogin",__result);if(__result!=1){delete p._$VISITOR;delete p._$PHOTOVISITOR}return __result==1};__proCacheUser._$getUserLogin=function(){return j._$getDataInStorage("login")};__proCacheUser._$isRemember=function(){return j._$getDataInStorage("remember")};__proCacheUser._$setRemember=function(_remember){j._$setDataInStorage("remember",!!_remember)};__proCacheUser._$getRemember=function(){return j._$getDataInStorage("remember")};__proCacheUser._$isAutoLogin=function(){return j._$getDataInStorage("autologin")};__proCacheUser._$setAutoLogin=function(_auto){j._$setDataInStorage("autologin",!!_auto)};__proCacheUser._$checkUserName=function(_username){if(!!_username&&_username.indexOf("@")>-1){return true}return false};__proCacheUser._$getUserInfoInCache=function(_uname){_uname=_uname||p._$VISITOR.userName;return this.__getDataLocal("user-"+_uname)};__proCacheUser._$getUserInfo=function(_uname){var _data=this._$getUserInfoInCache(_uname);if(!!_data){this._$dispatchEvent("onuserload",_uname,_data);return}var _options=this.__getDWROption();_options.sync=true;_options.param=null;_options.method="POST";_options.onload=this.__getUserInfo._$bind2(this,_uname);_options.onerror=this.__getUserInfo._$bind(this,null);j._$requestByDWR("MobileUserBean.getUserInfo",_options)};__proCacheUser.__getUserInfo=(function(){var _sex={M:"男",F:"女"},_cst=["水瓶座","双鱼座","白羊座","金牛座","双子座","巨蟹座","狮子座","处女座","天秤座","天蝎座","射手座","摩羯座"];return function(_data,_uname){if(!!_data&&!!_data.resultData){_uname=_uname||p._$VISITOR.userName;_data=_data.resultData;_data.gender=_sex[_data.gender]||"未知";_data.constellation=_cst[_data.constellation-1]||"未知";this.__setDataLocal("user-"+_uname,_data)}this._$dispatchEvent("onuserload",_uname,_data||MWF.O)}})();__proCacheUser._$getBlogInfoInCache=function(_uname){_uname=_uname||p._$VISITOR.userName;return this.__getDataLocal("user-blog-info-"+_uname)};__proCacheUser._$getBlogInfo=function(_uname){var _data=this._$getBlogInfoInCache(_uname);if(!!_data){this._$dispatchEvent("onbloginfoload",_uname,_data);return}var _options=this.__getDWROption();_options.param=null;_options.method="POST";_options.onload=this.__getBlogInfo._$bind2(this,_uname);_options.onerror=this.__getBlogInfo._$bind(this,null);j._$requestByDWR("MobileUserBean.getBlogInfo",_options)};__proCacheUser.__getBlogInfo=(function(){return function(_data,_uname){if(!!_data&&!!_data.resultData){_uname=_uname||p._$VISITOR.userName;_data=_data.resultData;this.__setDataLocal("user-blog-info-"+_uname,_data)}this._$dispatchEvent("onbloginfoload",_uname,_data)}})();__proCacheUser._$getNBUserList=function(_position,_offset,_limit){this._$dispatchEvent("onnbuserload",_offset,_limit)};__proCacheUser._$getNBUserListInCache=function(){return new Array(10)};__proCacheUser._$getFollowList=function(_offset,_limit){this._$getListByDWR({callback:["onfollowload"],offset:_offset,limit:_limit,url:"MobileFriendBean.getFollowers",key:"follow-"+p._$VISITOR.userId,filter:function(_data){return(_data.resultData||o).friends}})};__proCacheUser._$getFollowListInCache=function(){return this._$getListByKeyInCache("follow-"+p._$VISITOR.userId)};__proCacheUser._$getFollowCount=function(){var _count=this.__getDataLocal("follow-count-"+p._$VISITOR.userId);if(!!_count){this._$dispatchEvent("onfollowcountload",_count);return}var _options=this.__getDWROption();_options.onload=this.__getFollowCount._$bind(this);_options.onerror=this.__getFollowCount._$bind(this,null);j._$requestByDWR("MobileFriendBean.getFollowUsersCount",_options)};__proCacheUser.__getFollowCount=function(_data){var _count=((_data||o).resultData||o).count;if(!!_count){this.__setDataLocal("follow-count-"+p._$VISITOR.userId,_count)}this._$dispatchEvent("onfollowcountload",_count||0)};__proCacheUser._$addFollow=function(_uname){var _options=this.__getDWROption();_options.onload=this.__addFollow._$bind2(this,_uname);_options.onerror=this.__addFollow._$bind(this,null,_uname);j._$requestByDWR("MobileFriendBean.followUser",_options)};__proCacheUser.__addFollow=function(_data,_uname){if(!!_data&&!!_data.resultData&&_data.resultData.result==1){this._$clearUserCache(_uname);this._$clearUserFollowCache()}this._$dispatchEvent("onaddfollow",_data)};__proCacheUser._$clearUserCache=function(_uname){this._$clearDataLocal("user-"+_uname);return};__proCacheUser._$clearUserFollowCache=function(){this._$clearDataLocal("user-friend-static-counts-"+p._$VISITOR.userName);this._$clearDataLocal("follow-count-"+p._$VISITOR.userId);this._$clearDataLocal("follow-"+p._$VISITOR.userId);return};__proCacheUser._$clearUserFriendCache=function(){this._$clearDataLocal("user-friend-static-counts-"+p._$VISITOR.userName);return};__proCacheUser._$cancelFollow=function(_uname){var _options=this.__getDWROption();_options.onload=this.__cancelFollow._$bind2(this,_uname);_options.onerror=this.__cancelFollow._$bind(this,null,_uname);j._$requestByDWR("MobileFriendBean.cancelFollowUser",_options)};__proCacheUser.__cancelFollow=function(_data,_uname){if(!!_data&&!!_data.resultData&&_data.resultData.result==1){this._$clearUserCache(_uname);this._$clearUserFollowCache()}this._$dispatchEvent("oncancelfollow",_data)};__proCacheUser._$getFollowedList=function(_offset,_limit){this._$getListByDWR({callback:["onfollowedload"],offset:_offset,limit:_limit,key:"followed-"+p._$VISITOR.userId,url:"MobileFriendBean.getFollowedUsers",filter:function(_data){return(_data.resultData||o).friends}})};__proCacheUser._$getFollowedListInCache=function(){return this._$getListByKeyInCache("followed-"+p._$VISITOR.userId)};__proCacheUser._$getFollowedCount=function(){var _count=this.__getDataLocal("followed-count-"+p._$VISITOR.userId);if(_count!=null){this._$dispatchEvent("onfollowedcountload",_count);return}var _options=this.__getDWROption();_options.onload=this.__getFollowedCount._$bind(this);_options.onerror=this.__getFollowedCount._$bind(this,null);j._$requestByDWR("MobileFriendBean.getFollowedUsersCount",_options)};__proCacheUser.__getFollowedCount=function(_data){var _count=((_data||o).resultData||o).count;if(_count!=null){this.__setDataLocal("followed-count-"+p._$VISITOR.userId,_count)}this._$dispatchEvent("onfollowedcountload",_count||0)};__proCacheUser._$getBlogFriendCountsInCache=function(_uname){_uname=_uname||p._$VISITOR.userName;return this._$getListByKeyInCache("user-friend-static-counts-"+_uname)};__proCacheUser._$getBlogFriendCounts=function(_uname){_uname=_uname||p._$VISITOR.userName;var _counts=this.__getDataLocal("user-friend-static-counts-"+_uname);if(!!_counts){this._$dispatchEvent("onblogfriendcountsload",_counts);return}var _options=this.__getDWROption();_options.onload=this.__getBlogFriendCounts._$bind2(this,_uname);_options.onerror=this.__getBlogFriendCounts._$bind(this,null,_uname);j._$requestByDWR("MobileUserBean.getUserStatistic",_options)};__proCacheUser.__getBlogFriendCounts=function(_data,_uname){_data=((_data||o).resultData)||o;if(!!_data){if(!!_data.friendsCount){this.__setDataLocal("user-friend-static-counts-"+_uname,_data)}}this._$dispatchEvent("onblogfriendcountsload",!!_data)}})(MWF.F,MWF.P("mwf.j"),MWF.P("mwf.u"),MWF.P("mb.x"),MWF.P("mb.d"));(function(o,f,e,v,t,x,d,i,u,p){var __proEditorLayer,__supEditorLayer;p._$$EditorLayer=MWF.C();__proEditorLayer=p._$$EditorLayer._$extend(i._$$Abstract);__supEditorLayer=p._$$EditorLayer._$supro;__proEditorLayer.__init=function(_options){this._$resetOption(_options);this.__super();this._$addEditorEvents()};__proEditorLayer.__setLayerHeight=function(_options){_options.totalHeight=_options.totalHeight||500;if(u._$isNumber(_options.totalHeight)){this.__parent.style.height=_options.totalHeight+"px"}else{var _node=e._$get(_options.totalHeight);if(!!_node){this.__parent.style.height=_node.clientHeight+"px"}}};__proEditorLayer.__reset=function(_options){this._$resetOption(_options);__supEditorLayer.__reset.apply(this,arguments);this._$addEditorEvents()};__proEditorLayer._$resetOption=function(_options){_options=_options||{};this.__options=_options;_options.parent=_options.parent||"mwblog-layer";this.__parent=e._$get(_options.parent);this.__setLayerHeight(_options)};__proEditorLayer._$addEditorEvents=f;__proEditorLayer._$clearFields=f;__proEditorLayer._$show=function(){this._$clearFields();x.top();document.body.style.overflowY="hidden";this.__parent.style.display="block";__supEditorLayer._$show.apply(this,arguments)};__proEditorLayer._$hide=function(){document.body.style.overflowY="auto";this.__parent.style.display="none";__supEditorLayer._$hide.apply(this,arguments)}})(MWF.O,MWF.F,MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mwf.ut"),MWF.P("mb.x"),MWF.P("mb.d"),MWF.P("mwf.ui"),MWF.P("mwf.u"),MWF.P("mb.w"));(function(o,f,e,v,t,x,d,p){var __proCommentList,__proCommentCache;p._$$CommentCache=MWF.C();__proCommentCache=p._$$CommentCache._$extend(d._$$Cache);__proCommentCache.__init=function(_options){this.__super();_options=_options||{};this.__ckey=_options.ckey||""};__proCommentCache._$getCommentListInCache=function(_ckey){_ckey=_ckey||this.__ckey;return this._$getListByKeyInCache(_ckey)};__proCommentCache._$setCommentListInCache=function(_list,_ckey){_ckey=_ckey||this.__ckey;this.__setDataLocal(_ckey,_list)};__proCommentCache._$getCommentList=function(_id,_ckey,_offset,_limit){};__proCommentCache._$cbAddMainComment=function(_options){_options=_options||{};_options.commentItem=_options.commentItem||{};var _list=this._$getCommentListInCache()||[];_list.unshift(_options.commentItem);this._$setCommentListInCache([]);this._$dispatchEvent("onmaincommentadd",_options.subjectId)};__proCommentCache._$cbReplyComment=function(_options){_options=_options||{};_options.commentItem=_options.commentItem||{};var _mainComId=_options.commentItem.mainComId||"-1";var _replyComId=_options.commentItem.replyComId||"-1";var _mainCommentItem=this.__setMainCommentToTop(_mainComId);this.__appendSubCommentToEnd(_mainCommentItem,_options.commentItem);var _list=this._$getCommentListInCache()||[];this._$setCommentListInCache([]);this._$dispatchEvent("onrelycomment",_options.subjectId)};__proCommentCache.__setMainCommentToTop=function(_mainComId){var _mainItem;var _list=this._$getCommentListInCache()||[];for(var i=0;i<_list.length;i++){if(_list[i].id==_mainComId){_mainItem=_list.splice(i,1);break}}if(!!_mainItem&&!!_mainItem[0]){_list.unshift(_mainItem[0]);return _mainItem[0]}else{return null}};__proCommentCache.__appendSubCommentToEnd=function(_mainCommentItem,_subCommentItem){if(!!_mainCommentItem&&!!_subCommentItem){var _subComments=_mainCommentItem.subComments||[];_subComments.push(_subCommentItem);_mainCommentItem.subComments=_subComments;_mainCommentItem.subCommentCount+=1}};__proCommentCache.__cbAddCommentError=function(_options){mb.x.alert("添加评论失败！")};var __mianCommentItemStr1='        {if !!mitmdata}		<div id="${mitmdata.id}" class="maincmtitem">		  <div class="maincmtcnt">		    <div class="mainleft"><a class="avatar" hidefocus="true" {if mitmdata.publisherId > 0}href="#m=3&t=0&r=t&uname=${mitmdata.publisherName|escape}"{/if} ><img src="http://os.blog.163.com/common/ava.s?host=${mitmdata.publisherName|escape}" /></a></div>		    <div class="mainright" onclick="mb.w.g.mainReply(\'${mitmdata.id}\',\'${mitmdata.publisherId}\',\'${mitmdata.publisherName}\',\'${mitmdata.publisherNickName|escape}\')">		      <div class=""><div class="maintime thide">${mitmdata.publishTime|datetime}</div><div class="maimttl"><div class="ttltxt thide">${ext.fsubstr(mitmdata.publisherNickName,16)|escape}：</div></div></div>		      <div class="maincnt g_t_hide_mulline">${mitmdata.content|default:""}</div>		      <div>		        <div style="display:none;" class="mainreply" onclick="mb.w.g.mainReply(\'${mitmdata.id}\',\'${mitmdata.publisherId}\',\'${mitmdata.publisherName}\',\'${mitmdata.publisherNickName|escape}\')">回复</div>		      </div>		    </div>		  </div>		  <div class="subcomments">		';var __mianCommentItemStr2="	  </div>	</div>	{/if}	";var __subCommentItemStr='    {if !!sitmdata}	<div id="${sitmdata.id}" class="subcmtitem">	  <div class="subleft"><a class="avatar" hidefocus="true" {if sitmdata.publisherId > 0}href="#m=3&t=0&r=t&uname=${sitmdata.publisherName|escape}"{/if} ><img src="http://os.blog.163.com/common/ava.s?host=${sitmdata.publisherName|escape}" /></a></div>	  <div class="subright" onclick="mb.w.g.subReply(\'${sitmdata.mainComId}\',\'${sitmdata.id}\',\'${sitmdata.publisherId}\',\'${sitmdata.publisherName}\',\'${sitmdata.publisherNickName|escape}\')">	    <div class=""><div class="subtime">${sitmdata.publishTime|datetime}</div><div class="subttl thide"><div class="">${ext.fsubstr(sitmdata.publisherNickName,16)|escape}：</div></div></div>        <div class="subcnt g_t_hide_mulline">${sitmdata.content|default:""}</div>        <div>          <div style="display:none;" class="subreply" onclick="mb.w.g.subReply(\'${sitmdata.mainComId}\',\'${sitmdata.id}\',\'${sitmdata.publisherId}\',\'${sitmdata.publisherName}\',\'${sitmdata.publisherNickName|escape}\')">回复</div>        </div>	  </div>	</div>	{/if}    ';var __commentListStr="{if xlist.length>0}{list xlist as mitmdata}"+__mianCommentItemStr1+"{if !!mitmdata.subComments && mitmdata.subComments.length>0}{list mitmdata.subComments as sitmdata}"+__subCommentItemStr+"{/list}{/if}"+__mianCommentItemStr2+"{/list}{/if}";var __tkeyCommentList=e._$addHtmlTemplate(__commentListStr);p._$$CommentList=MWF.C();__proCommentList=p._$$CommentList._$extend(t._$$Event);__proCommentList.__init=function(_options){this.__super();this._$resetOption(_options)};__proCommentList.__initGInterface=function(){var _namespace=MWF.P("mb.w.g");_namespace.mainReply=this.__replyMainComment._$bind(this);_namespace.subReply=this.__replySubComment._$bind(this)};__proCommentList.__replyMainComment=function(_commentId,_replyToUserId,_replyToUserName,_replyToUserNick){var _options={mainComId:_commentId,replyComId:_commentId,subjectId:this.__id,replyToUserId:_replyToUserId,replyToUserName:_replyToUserName,replyToUserNick:_replyToUserNick};this._$dispatchEvent("onreply",_options)};__proCommentList.__replySubComment=function(_mainComId,_replyComId,_replyToUserId,_replyToUserName,_replyToUserNick){var _options={mainComId:_mainComId,replyComId:_replyComId,subjectId:this.__id,replyToUserId:_replyToUserId,replyToUserName:_replyToUserName,replyToUserNick:_replyToUserNick};this._$dispatchEvent("onreply",_options)};__proCommentList._$resetOption=function(_options){this.__initGInterface();_options=_options||o;this.__tkeyCommentList=_options.tkeyCommentListJst||__tkeyCommentList;this.__id=_options.id||"";this.__ckey=_options.ckey||this.__id;this.__cmtbox=e._$get(_options.cmtbox||"");if(!!_options.maincmtipt){this.__addMainCmtBtn=e._$get(_options.maincmtipt)}else{if(!this.__addMainCmtBtn||this.__addMainCmtBtn.parentNode.parentNode!=this.__cmtbox){var _btnWrap=e._$create("div","m-addarea",this.__cmtbox);this.__addMainCmtBtn=e._$create("input","maincmtipt m-input s-fc3",_btnWrap);this.__addMainCmtBtn.type="button";this.__addMainCmtBtn.value="添加新评论"}}if(!!_options.cmtmore){this.__cmtmore=e._$get(_options.cmtmore)}else{if(!this.__cmtlistbox||this.__cmtlistbox.parentNode!=this.__cmtbox){if(!!this.__cmtlistbox){e._$remove(this.__cmtlistbox)}this.__cmtlistbox=e._$create("div","cmtlistbox",this.__cmtbox);if(!!this.__cmtmore){e._$remove(this.__cmtmore)}}if(!this.__cmtmore||this.__cmtmore.parentNode!=this.__cmtbox){if(!!this.__cmtmore){e._$remove(this.__cmtmore)}this.__cmtmore=e._$create("div","m-dwnmore",this.__cmtbox);this.__loadmoreBtn=e._$create("a","",this.__cmtmore);this.__loadmoreBtn.innerHTML="加载更多..."}}this.__limit=_options.limit||10;this.__emptytip=_options.emptytip||"暂无评论...";this.__cacheClass=_options.cacheClass||p._$$CommentCache;this.__cache=new this.__cacheClass({ckey:this.__ckey});this.__cache._$addEvent("oncommentload",this.__cbLoadComment._$bind(this));!!this.__mcmt||(this.__mcmt=new p._$$SimpleList({jst:this.__tkeyCommentList,ext:{fsubstr:x._$subString,},box:this.__cmtlistbox||this.__cmtbox,btn:this.__cmtmore,empty:this.__emptytip,limit:this.__limit,onnext:this.__onLoadComment._$bind(this)}));this.__mcmt._$refresh();v._$addEvent(this.__addMainCmtBtn,"click",this.__addMainComment._$bind(this));this._$addEvent("addcommentcount",_options.addcommentcount||f);this._$addEvent("onwrite",_options.onwrite||f);this._$addEvent("onreply",_options.onreply||f)};__proCommentList.__addMainComment=function(){var _options={subjectId:this.__id};this._$dispatchEvent("onwrite",_options)};__proCommentList._$refresh=function(){this.__mcmt._$refresh()};__proCommentList.__onLoadComment=function(_offset,_limit){var _hostname=x._$getParmvalByKey(location.hash,"uname");this.__cache._$getCommentList(this.__id,this.__ckey,_offset,_limit,_hostname)};__proCommentList.__cbLoadComment=function(_ckey,_offset,_limit){var _appendList=[];var _list=this.__cache._$getCommentListInCache(_ckey)||[];for(var i=_offset;i<_list.length&&i<_offset+_limit;i++){if(!!_list[i]){_appendList.push(_list[i])}}this.__mcmt._$append(_appendList,true)};__proCommentList._$addSubCommentItem=function(_options){this.__cache._$addSubComment(_options)}})(MWF.O,MWF.F,MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mwf.ut"),MWF.P("mb.x"),MWF.P("mb.d"),MWF.P("mb.w"));(function(u,ut,e,v,x,p){var __proImgLazyLoad,__ikey="__"+u._$randString(8)+"__";var __filter=function(_scrollbody,_node){if(!_scrollbody||!_node){return true}if((!!_node.id&&_node.id==_scrollbody.id)||_node==document.body||_node.id=="blog-163-com"){return true}else{return false}};var __getOffset=function(_element,_type,_filter){_element=e._$get(_element);if(!_element){return 0}_filter=_filter||F;var _offset=0;while(!!_element&&!_filter(_element)){_offset+=_element[_type];_element=_element.offsetParent}return _offset};p._$$ImgLazyLoad=MWF.C();__proImgLazyLoad=p._$$ImgLazyLoad._$extend(ut._$$Event);p._$$ImgLazyLoad._$bind=function(_parent,_options){_parent=e._$get(_parent);if(!_parent){return}return new (p._$$ImgLazyLoad)(_parent,_options)};__proImgLazyLoad.__init=function(_parent,_options){this.__super();this.__imgsContainer=e._$get(_parent);this._$resetOption(_options);v._$addEvent(window,"resize",this.__onWindowResize._$bind(this))};__proImgLazyLoad._$resetOption=function(_options){_options=_options||{};this.__lazyimgsrc=_options.lazyimgsrc||"";this.__granularity=_options.granularity||"";this.__statetime=_options.statetime||200;this.__defaultimg=_options.defaultimg||"http://b.bst.126.net/common/empty.png";this.__oldScrollBody=this.__scrollbody;this.__scrollbody=e._$get(_options.scrollbody||window);if(!this.__imgsContainer||!this.__lazyimgsrc){return}var _ntmp=this.__imgsContainer.getElementsByTagName("img")||[];this.__lazyLoadImgs=[];for(var i=0;i<_ntmp.length;i++){if(!!_ntmp[i].getAttribute(this.__lazyimgsrc)&&!_ntmp[i].getAttribute("src")){_ntmp[i].src=this.__defaultimg;this.__lazyLoadImgs.push(_ntmp[i])}}this._$loadInViewImg();if(!!this.__scrollbody){if(!this.__oldScrollBody||!__filter(this.__oldScrollBody,this.__scrollbody)){v._$clearEvent(this.__scrollbody,"scroll");v._$addEvent(this.__scrollbody,"scroll",this.__onWindowScroll._$bind(this))}}};__proImgLazyLoad.__onWindowScroll=function(){if(!!this.__timer){this.__timer=window.clearTimeout(this.__timer)}this.__timer=window.setTimeout(this._$loadInViewImg._$bind(this),this.__statetime)};__proImgLazyLoad.__onWindowResize=function(){if(!!this.__timer){this.__timer=window.clearTimeout(this.__timer)}this.__timer=window.setTimeout(this._$loadInViewImg._$bind(this),this.__statetime)};__proImgLazyLoad._$loadInViewImg=function(){if(!this.__lazyLoadImgs||this.__lazyLoadImgs.length<1){v._$clearEvent(window,"resize");v._$clearEvent(this.__scrollbody,"scroll");return}if(this.__granularity!="img"){if(this._$isInView(this.__imgsContainer)){for(var i=0;i<this.__lazyLoadImgs.length;i++){if(!!this.__lazyLoadImgs[i]){this.__lazyLoadImgs[i].src=this.__lazyLoadImgs[i].getAttribute(this.__lazyimgsrc);this.__lazyLoadImgs[i].removeAttribute(this.__lazyimgsrc)}}this.__lazyLoadImgs=null}return}var _isLastInView=false,_isThisInView=false;for(var i=0;i<this.__lazyLoadImgs.length;i++){_isThisInView=this._$isInView(this.__lazyLoadImgs[i]);if(!!_isThisInView){this.__lazyLoadImgs[i].src=this.__lazyLoadImgs[i].getAttribute(this.__lazyimgsrc);this.__lazyLoadImgs[i].removeAttribute(this.__lazyimgsrc);this.__lazyLoadImgs.splice(i,1);i--}if(_isLastInView&&!_isThisInView){break}}};p._$offsetX=function(_element,_filter){return __getOffset(_element,"offsetLeft",_filter)};p._$offsetY=function(_element,_filter){return __getOffset(_element,"offsetTop",_filter)};__proImgLazyLoad._$isInView=function(_node){if(!_node){return false}var _widthInView=false;var _heightInView=false;var _body0=document.documentElement||document.body,_body1=document.body||document.documentElement;var _viewLeft=(_body0.scrollLeft||_body1.scrollLeft||this.__scrollbody.scrollLeft||0);var _viewTop=(_body0.scrollTop||_body1.scrollTop||this.__scrollbody.scrollTop||0);var _viewRight=_viewLeft+_body0.clientWidth;var _viewBottom=_viewTop+_body0.clientHeight;var _offsetLeft=p._$offsetX(_node,__filter._$bind(null,this.__scrollbody));var _offsetTop=p._$offsetY(_node,__filter._$bind(null,this.__scrollbody));var _offsetRight=_offsetLeft+_node.clientWidth;var _offsetBottom=_offsetTop+_node.clientHeight;if(_node.clientWidth<=_body0.clientWidth){if((_offsetLeft>=_viewLeft&&_offsetLeft<=_viewRight)||(_offsetRight>=_viewLeft&&_offsetRight<_viewRight)){_widthInView=true}}else{if((_viewLeft>=_offsetLeft&&_viewLeft<=_offsetRight)||(_viewRight>=_offsetLeft&&_viewRight<_offsetRight)){_widthInView=true}}if(_node.clientHeight<=_body0.clientHeight){if((_offsetTop>=_viewTop&&_offsetTop<=_viewBottom)||(_offsetBottom>=_viewTop&&_offsetBottom<_viewBottom)){_heightInView=true}}else{if((_viewTop>=_offsetTop&&_viewTop<=_offsetBottom)||(_viewBottom>=_offsetTop&&_viewBottom<_offsetBottom)){_heightInView=true}}return _widthInView&&_heightInView}})(MWF.P("mwf.u"),MWF.P("mwf.ut"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.x"),MWF.P("mb.w"));(function(o,j,p){var __proCacheMood;p._$$CacheMood=MWF.C();__proCacheMood=p._$$CacheMood._$extend(p._$$Cache);__proCacheMood._$getMoodListInCache=function(_username){return this._$getListByKeyInCache("mood-"+_username)};__proCacheMood._$getMoodList=function(_offset,_limit,_username){this._$getListByDWR({offset:_offset,limit:_limit,callback:["onmoodload"],url:"MobileFeelingBean.getFeelingList",key:"mood-"+_username,adjust:this.__filterMood._$bind(this),parse:function(_options){_options.param=[_offset,_limit]}})};__proCacheMood.__filterMood=function(_mood){this.__addMoodInCache(_mood);return _mood};__proCacheMood._$getMoodInCache=function(_id){return(this.__getDataInCache("hash-mood-"+p._$VISITOR.userId)||o)[_id]};__proCacheMood._$getMood=function(_id){var _options=this.__getDWROption();_options.param=[_id];_options.onload=this.__getMood._$bind(this);_options.onerror=this.__getMood._$bind(this,null);j._$requestByDWR("MobileFeelingBean.getFeelingCard",_options)};__proCacheMood.__getMood=function(_data){try{_data=(_data||o).resultData;if(!!_data){this.__addMoodInCache(_data)}this._$dispatchEvent("onmooddataload",(_data||o))}catch(e){alert(e.message)}};__proCacheMood._$addMood=function(_mood){_mood=_mood||{};var _options=this.__getDWROption();_options.param=[_mood.content||""];_options.onload=this.__addMood._$bind2(this,_mood);_options.onerror=this.__addMood._$bind(this,null);j._$requestByDWR("MobileFeelingBean.addFeeling",_options)};__proCacheMood.__addMood=function(_data,_mood){_data=(_data||o).resultData;if(!!_data&&_data.result==1){_mood.accessCount=0;_mood.commentCount=0;_mood.id=_data.cardId;_mood.publishTime=_data.publishTime;this.__addMoodInCache(_mood);var _list=this._$getMoodListInCache(p._$VISITOR.userName);_list.unshift(_mood)}this._$dispatchEvent("onmoodadd",(_mood||o).id)};__proCacheMood.__addMoodInCache=function(_mood){var _key="hash-mood-"+p._$VISITOR.userId,_hash=this.__getDataInCache(_key)||{},_id=_mood.id;!_hash[_id]?_hash[_id]=_mood:_mood=_hash[_id];this.__setDataInCache(_key,_hash)};__proCacheMood._$getCommentListInCache=function(_mid){return this._$getListByKeyInCache("moodcomment-"+p._$VISITOR.userId+"-"+_mid)};__proCacheMood._$getCommentList=function(_mid,_offset,_limit){this._$getListByDWR({offset:_offset,limit:_limit,url:"MobileFeelingBean.getFeelingsCommentList",callback:["oncommentload",_mid],key:"moodcomment-"+p._$VISITOR.userId+"-"+_mid,adjust:function(_comment){if(!!_comment){_comment.publisherNickName=_comment.publisherNickname}return _comment},parse:function(_option){_option.param=[_mid,_offset,_limit,0]}})};__proCacheMood._$addComment=function(_mid,_content){var _options=this.__getDWROption();_options.param=[_mid||null,_content];_options.onload=this.__addComment._$bind2(this,_mid,_content);_options.onerror=this.__addComment._$bind(this,null,_mid);j._$requestByDWR("MobileFeelingBean.addNewFeelingComment",_options)};__proCacheMood.__addComment=function(_data,_mid,_content){if(!!_data&&!!_data.resultData){var _user=p._$VISITOR,_data=_data.resultData,_list=this._$getCommentListInCache(_mid);_list.unshift({cardId:_mid,content:_content,id:_data.commentId,replyToUserId:_user.userId,replyToUserName:_user.userName,replyToUserNick:_user.userNickname,publisherId:_user.userId,publisherName:_user.userName,publisherNickName:_user.userNickname,publishTime:_data.publishTime});var _mood=this._$getMoodInCache(_mid);_mood.commentCount+=1}this._$dispatchEvent("oncommentadd",_mid)}})(MWF.O,MWF.P("mwf.j"),MWF.P("mb.d"));(function(o,j,p){var __proCacheTrack,__track_url=["getAllTracks","getFriendTracks","getTrackHistory"];p._$$CacheTrack=MWF.C();__proCacheTrack=p._$$CacheTrack._$extend(p._$$Cache);__proCacheTrack._$getTrackListInCache=function(_type,_username){return this._$getListByKeyInCache("track-"+_username+"-"+_type)};__proCacheTrack._$getTrackList=function(_type,_offset,_limit,_userName){this._$getListByDWR({offset:_offset,limit:_limit,callback:["ontrackload",_type],parse:function(_options){_options.param=[_offset,_limit]},key:"track-"+_userName+"-"+_type,filter:this.__filterTrack._$bind(this),url:"MobileTrackBean."+__track_url[_type]||__track_url[0]})};__proCacheTrack.__filterTrack=function(_list){return((_list||o).resultData||o).list}})(MWF.O,MWF.P("mwf.j"),MWF.P("mb.d"));(function(f,j,p){var __proCacheHome;p._$$CacheHome=MWF.C();__proCacheHome=p._$$CacheHome._$extend(p._$$Cache);__proCacheHome._$getNoteListInCache=function(_username){return this._$getListByKeyInCache("note-"+_username)};__proCacheHome._$getNoteList=function(_offset,_limit,_userName){this._$getListByDWR({callback:["onnoteload"],offset:_offset,limit:_limit,url:"MobileNoteBean.getNotes",key:"note-"+_userName,parse:function(_options){_options.param=[_offset,_limit]},filter:function(_data){return(_data.resultData||o).notes}})};__proCacheHome._$deleteNote=function(_id){var _dwrOptions=this.__getDWROption();_dwrOptions.url="MobileNoteBean.delNote";_dwrOptions.onload=this.__deleteNoteInCache._$bind(this,_id);_dwrOptions.param=[_id];j._$requestByDWR(_dwrOptions.url,_dwrOptions)};__proCacheHome.__deleteNoteInCache=function(_id,_result){if(!!_result){var _list=this._$getListByKeyInCache("note-"+p._$VISITOR.userId);for(var i=0;i<_list.length;i++){var _item=_list[i];if(_item.noteId==_id){_list.splice(i,1)}}}this._$dispatchEvent("onnotedelete",!!_result)};__proCacheHome._$getVisitorListInCache=function(_uname){return this._$getListByKeyInCache("visitor-"+p._$VISITOR.userId+"-"+_uname)};__proCacheHome._$getVisitorList=function(_offset,_limit,_uname){this._$getListByDWR({parse:f,offset:_offset,limit:_limit,callback:["onvisitorload"],key:"visitor-"+p._$VISITOR.userId+"-"+_uname,url:"MobileUserBean.getRecentVisitor"})};__proCacheHome._$getVisitorWhoListInCache=function(){return this._$getListByKeyInCache("visitor-who-"+p._$VISITOR.userId)};__proCacheHome._$getVisitorWhoList=function(_offset,_limit){this._$getListByDWR({parse:f,offset:_offset,limit:_limit,callback:["onvisitorwhoload"],key:"visitor-who-"+p._$VISITOR.userId,url:"MobileUserBean.getRecentVisitWho"})};__proCacheHome._$addNote=function(_content,_nickname){var _options=this.__getDWROption();_options.param=[_content||"",_nickname||""];_options.onload=this.__addNote._$bind(this,_content,_nickname);_options.onerror=this.__addNote._$bind2(this,null);_options.method="POST";j._$requestByDWR("MobileNoteBean.addNote",_options)};__proCacheHome.__addNote=function(_content,_nickname,_data){var __result=((_data||o).resultData||o);if(__result.result==1){var __noteListInCache=this._$getListByKeyInCache("note-"+mb.x._$getHostName());var __note={content:_content,publisherName:p._$VISITOR.userName,publisherNickName:_nickname||p._$VISITOR.userName};if(!!__noteListInCache){__noteListInCache.splice(0,0,__note);this.__setDataLocal("note-"+mb.x._$getHostName(),__noteListInCache)}}this._$dispatchEvent("oncbaddnote",__result.result)}})(MWF.F,MWF.P("mwf.j"),MWF.P("mb.d"));(function(o,f,j,x,p){var __proCacheBlog,__writeBlogCache="write-blog-cache";p._$$CacheBlog=MWF.C();__proCacheBlog=p._$$CacheBlog._$extend(p._$$Cache);__proCacheBlog._$writeTextToCache=function(_text){this.__setDataInCache(__writeBlogCache,_text)};__proCacheBlog._$getTextFromCache=function(_text){return this.__getDataInCache(__writeBlogCache)};__proCacheBlog._$getBlogClassListInCache=function(_username){return this._$getListByKeyInCache("blogclass-"+_username||p._$VISITOR.userName)};__proCacheBlog._$getBlogClassList=function(_username){this._$getListByDWR({offset:0,limit:100,callback:["onblogclassload"],key:"blogclass-"+_username||p._$VISITOR.userName,url:"MobileBlogBean.getBlogClassList",parse:function(_options){_options.param=[]},filter:function(_data){return(_data.resultData||o).blogClasses}})};__proCacheBlog._$getBlogListInCache=function(_cid,_username){var _list=this._$getListByKeyInCache("blog-"+_username+"-"+(_cid||"all"));return _list};__proCacheBlog._$getBlogList=function(_cid,_offset,_limit,_username){this._$getListByDWR({offset:_offset,limit:_limit,callback:["onblogload",_cid],url:"MobileBlogBean.getBlogs",key:"blog-"+_username+"-"+(_cid||"all"),adjust:this.__filterBlog._$bind(this),parse:function(_options){_options.param=[_cid,_offset,_limit]},filter:function(_data){return(_data.resultData||o).blogs}})};__proCacheBlog.__filterBlog=function(_blog){var _key="hash-blog-"+p._$VISITOR.userId,_hash=this.__getDataInCache(_key)||{},_id=_blog.id;if(!_hash[_id]){_hash[_id]=_blog}else{_blog=_hash[_id]}this.__setDataInCache(_key,_hash);return _blog};__proCacheBlog._$getBlogInCache=function(_bid){return(this.__getDataInCache("hash-blog-"+p._$VISITOR.userId)||o)[_bid]};__proCacheBlog._$getBlogContent=function(_bid,_username){if(!_username){_username=x._$getHostName()}if(!_bid){location.hash="#m=3&uname="+_username;return}var _data=this._$getBlogInCache(_bid)||o;if(_data.content!=null){this._$dispatchEvent("onblogcontentload",_bid,_data);return}var _options=this.__getDWROption();_options.param=[_bid];_options.method="POST";_options.onload=this.__getBlogContent._$bind2(this,_bid);_options.onerror=this.__getBlogContent._$bind(this,_bid,null);j._$requestByDWR("MobileBlogBean.getBlog4View",_options)};__proCacheBlog.__getBlogContent=function(_data,_bid){var _blog;if(!!_data&&!!_data.resultData){_data=_data.resultData;_blog=this._$getBlogInCache(_bid);if(!_blog){_blog={id:_data.id,title:_data.title,publishTime:_data.publishTime,accessCount:_data.accessCount,commentCount:_data.commentCount};this.__filterBlog(_blog)}_blog.content=_data.content||""}this._$dispatchEvent("onblogcontentload",_bid,_blog)};__proCacheBlog._$addBlog=function(_blog){_blog=_blog||{};var _options=this.__getDWROption();_options.param=[_blog.title||"",_blog.content||"",_blog.cid||"",-100,1];_options.onload=this.__addBlog._$bind2(this,_blog);_options.onerror=this.__addBlog._$bind(this,null);j._$requestByDWR("MobileBlogBean.addBlog",_options)};__proCacheBlog.__addBlog=function(_data,_blog){_data=(_data||o).resultData;if(!!_data){_blog.id=_data.blogId;_blog.accessCount=0;_blog.commentCount=0;_blog.publishTime=_data.publishTime;_blog=this.__filterBlog(_blog);var _list=this._$getBlogListInCache("all",p._$VISITOR.userName);_list.unshift(_blog);this.__setDataLocal("blog-"+p._$VISITOR.userName+"-all",_list)}this._$dispatchEvent("onblogpost",!!_data)};__proCacheBlog._$deleteBlog=function(_bid){var _options=this.__getDWROption();_options.param=[_bid];_options.method="POST";_options.onload=this.__deleteBlog._$bind2(this,_bid);_options.onerror=this.__deleteBlog._$bind(this,_bid,null);j._$requestByDWR("MobileBlogBean.delBlog",_options)};__proCacheBlog.__deleteBlog=function(_data,_bid){if(!!_data&&!!_data.resultData&&_data.resultData.result==1){mb.x.alert("日志删除成功！");var _key="blog-"+p._$VISITOR.userName+"-all";this.__setDataLocal(_key,[]);this._$dispatchEvent("onblogdelete",_bid)}else{mb.x.alert("日志删除失败！")}};__proCacheBlog._$allowRecommendBlog=function(_bid){var _options=this.__getDWROption();_options.param=[_bid];_options.method="POST";_options.onload=this.__allowRecommendBlog._$bind2(this,_bid);_options.onerror=this.__allowRecommendBlog._$bind(this,_bid,null);j._$requestByDWR("MobileBlogBean.allowRecommend",_options)};__proCacheBlog.__allowRecommendBlog=function(_data,_bid){if(!!_data&&!!_data.resultData&&!!_data.resultData.result){this._$dispatchEvent("onallowrecommend",true)}else{this._$dispatchEvent("onallowrecommend",false)}};__proCacheBlog._$recommendBlog=function(_bid,_cnt){var _options=this.__getDWROption();_options.param=[_bid,_cnt||"",false];_options.method="POST";_options.onload=this.__recommendBlog._$bind2(this,_bid);_options.onerror=this.__recommendBlog._$bind(this,_bid,null);j._$requestByDWR("MobileBlogBean.addBlogRecommend",_options)};__proCacheBlog.__recommendBlog=function(_data,_bid){if(!!_data&&!!_data.resultData&&_data.resultData.result==1){this._$dispatchEvent("onblogrecommend",_bid)}else{this._$dispatchEvent("onblogrecommend",null)}};__proCacheBlog._$getDraftListInCache=function(){return this._$getListByKeyInCache("blogdraft-"+p._$VISITOR.userId)};__proCacheBlog._$getDraftList=function(_offset,_limit){this._$getListByDWR({offset:_offset,limit:_limit,callback:["onblogdraftload"],url:"MobileBlogBean.getDrafts",key:"blogdraft-"+p._$VISITOR.userId,filter:function(_data){return(_data.resultData||o).blogs}})};__proCacheBlog._$deleteDraft=function(_id){var _dwrOptions=this.__getDWROption();_dwrOptions.url="MobileBlogBean.delBlog";_dwrOptions.onload=this.__deleteDraftInCache._$bind(this,_id);_dwrOptions.param=[_id];j._$requestByDWR(_dwrOptions.url,_dwrOptions)};__proCacheBlog.__deleteDraftInCache=function(_id,_result){if(!!_result){var _list=this._$getListByKeyInCache("blogdraft-"+p._$VISITOR.userId);for(var i=0;i<_list.length;i++){var _item=_list[i];if(_item.id==_id){_list.splice(i,1)}}}this._$dispatchEvent("onblogdraftdelete",!!_result)};__proCacheBlog._$getDraftCount=function(){var _count=this.__getDataLocal("blogdraft-count-"+p._$VISITOR.userId);if(_count!=null){this._$dispatchEvent("onblogdraftcountload",_count);return}var _options=this.__getDWROption();_options.onload=this.__getDraftCount._$bind(this);_options.onerror=this.__getDraftCount._$bind(this,null);j._$requestByDWR("MobileBlogBean.getDraftCount",_options)};__proCacheBlog.__getDraftCount=function(_data){var _count=((_data||o).resultData||o).draftCount;if(_count!=null){this.__setDataLocal("blogdraft-count-"+p._$VISITOR.userId,_count)}this._$dispatchEvent("onblogdraftcountload",_count||0)};__proCacheBlog._$addDraft=function(_blog){_blog=_blog||{};var _options=this.__getDWROption();_options.param=[_blog.title||"",_blog.content||"",_blog.cid||"",-100,0];_options.onload=this.__addDraft._$bind2(this,_blog);_options.onerror=this.__addDraft._$bind(this,null);j._$requestByDWR("MobileBlogBean.addBlog",_options)};__proCacheBlog.__addDraft=function(_data,_blog){_data=(_data||o).resultData;if(!!_data){_blog.id=_data.blogId;_blog.publishTime=_data.publishTime;var _count=this.__getDataLocal("blogdraft-count-"+p._$VISITOR.userId);if(_count!=null){_count+=1;this.__setDataLocal("blogdraft-count-"+p._$VISITOR.userId,_count)}var _list=this._$getDraftListInCache();_list.unshift(_blog);this.__setDataLocal("blogdraft-"+p._$VISITOR.userId,_list)}this._$dispatchEvent("onblogdraft",!!_data)};__proCacheBlog._$getCommentListInCache=function(_bid){return this._$getListByKeyInCache("blogcomment-"+p._$VISITOR.userId+"-"+_bid)};__proCacheBlog._$getCommentList=function(_bid,_offset,_limit){this._$getListByDWR({offset:_offset,limit:_limit,url:"MobileBlogBean.getBlogComments",callback:["oncommentload",_bid],key:"blogcomment-"+p._$VISITOR.userId+"-"+_bid,parse:function(_option){_option.param=[_bid,_offset,_limit,0]},filter:function(_data){return(_data.resultData||o).blogComments}})};__proCacheBlog._$addComment=function(_bid,_content){var _options=this.__getDWROption();_options.param=[_content,_bid||null];_options.onload=this.__addComment._$bind2(this,_bid,_content);_options.onerror=this.__addComment._$bind(this,null,_bid);j._$requestByDWR("MobileBlogBean.addBlogComment",_options)};__proCacheBlog.__addComment=function(_data,_bid,_content){if(!!_data&&!!_data.resultData){var _user=p._$VISITOR,_data=_data.resultData,_list=this._$getCommentListInCache(_bid);_list.unshift({blogId:_bid,content:_content,id:_data.commentId,replyToUserId:_user.userId,replyToUserName:_user.userName,replyToUserNick:_user.userNickname,publisherId:_user.userId,publisherName:_user.userName,publisherNickName:_user.userNickname,publishTime:_data.publishTime});var _blog=this._$getBlogInCache(_bid);_blog.commentCount+=1}this._$dispatchEvent("oncommentadd",_bid)}})(MWF.O,MWF.F,MWF.P("mwf.j"),MWF.P("mb.x"),MWF.P("mb.d"));(function(o,f,u,j,p){var __proCachePhoto;p._$$CachePhoto=MWF.C();__proCachePhoto=p._$$CachePhoto._$extend(p._$$Cache);__proCachePhoto._$getAlbumSpaceInCache=function(){return this.__getDataInCache("albumspace-"+p._$VISITOR.userId)};__proCachePhoto._$getAlbumListInCache=function(_username){return this._$getListByKeyInCache("album-"+_username)};__proCachePhoto._$getAlbumList=function(_offset,_limit,_username){var _list=this._$getAlbumListInCache(_username),_time=(_list[_offset-1]||o).createTime||(new Date().getTime());this._$getListByDWR({callback:["onalbumload"],offset:_offset,limit:_limit,url:"MobilePhotoBean.getAlbums",key:"album-"+_username,filter:this.__filterAlbum._$bind(this),adjust:this.__filterAlbumItem._$bind(this),parse:function(_options){_options.param=[_time,_limit]}})};__proCachePhoto._$getAlbumListAll=function(_username){this._$getAlbumList(0,0,_username)};__proCachePhoto.__filterAlbum=function(_data){var _space=((_data.resultData||o).netease||o).albums||{totalCount:0,photoCount:0};var _list=_space.album;delete _space.album;this.__setDataInCache("albumspace-"+p._$VISITOR.userId,_space);if(!_list){return null}return u._$isArray(_list)?_list:[_list]};__proCachePhoto.__filterAlbumItem=function(_album){var _key="hash-album-"+p._$VISITOR.userId,_hash=this.__getDataLocal(_key)||{};!_hash[_album.id]?_hash[_album.id]=_album:_album=_hash[_album.id];this.__setDataLocal(_key,_hash);return _album};__proCachePhoto._$getAlbumInCache=function(_aid){return(this.__getDataLocal("hash-album-"+p._$VISITOR.userId)||o)[_aid]};__proCachePhoto._$getPhotoListInCache=function(_aid,_username){return this._$getListByKeyInCache("photo-"+_username+"-"+_aid)};__proCachePhoto._$getPhotoList=function(_aid,_offset,_limit,_username){var _list=this._$getPhotoListInCache(_aid,_username),_time=(_list[_offset-1]||o).createTime||(new Date().getTime());this._$getListByDWR({offset:_offset,limit:_limit,callback:["onphotoload",_aid],url:"MobilePhotoBean.getPhotos",key:"photo-"+_username+"-"+_aid,adjust:this.__filterPhoto._$bind(this),parse:function(_options){_options.param=[_aid||null,_time,_limit]},filter:function(_data){var _list=(((_data.resultData||o).netease||o).photos||o).photo;if(!_list){return null}return u._$isArray(_list)?_list:[_list]}})};__proCachePhoto.__filterPhoto=function(_photo){var _key="hash-photo-"+p._$VISITOR.userId,_hash=this.__getDataLocal(_key)||{};!_hash[_photo.id]?_hash[_photo.id]=_photo:_photo=_hash[_photo.id];this.__setDataLocal(_key,_hash);return _photo};__proCachePhoto._$getPhotoInCache=function(_pid){return(this.__getDataLocal("hash-photo-"+p._$VISITOR.userId)||o)[_pid]};__proCachePhoto._$addPhoto=(function(){var _url="http://upload.photo.163.com/USER/oauth/web/upload?sitefrom=blog_android&NTES_SESS=";return function(_photo){_photo=_photo||o;var _visitor=p._$VISITOR;_url=_url.replace("USER",_visitor.userName)+"&aid="+_photo.album,_photo.file;navigator.file.upload(_url,{onload:this.__addPhoto._$bind2(this,_photo),headers:{Authorization:mwf.ut._$$OAuth._$getAuthHeader("Auth-Key",{m:"POST",r:_url})},finish:"/html/index.html#m=1&t=0",onerror:this.__addPhoto._$bind(this,null),pgtitle:"网易博客",pgdesc:"正在上传相册图片...",tipcnt:"正在上传图片，请在通知窗口查看进度...",tiptime:5000})}})();__proCachePhoto.__addPhoto=function(_xml,_options){var _photo=(u._$xml2object(_xml)||o).netease;if(!_photo){this._$dispatchEvent("onphotoadd",-1);return}this.__count=0;j._$beginBatch();var _optionss=this.__getDWROptionPhoto();_optionss.param=[_photo.id,_options.album,_options.desc||""];_optionss.onload=this.__cbBatchPhotoInfo._$bind2(this,_options);_optionss.onerror=this.__cbBatchPhotoInfo._$bind(this,null,_options);j._$requestByDWR("PhotoBean.updateDesc",_optionss);var _optionss=this.__getDWROptionPhoto();_optionss.param=[_photo.id,_options.deg];_optionss.onload=this.__cbBatchPhotoInfo._$bind2(this,_options);_optionss.onerror=this.__cbBatchPhotoInfo._$bind(this,null,_options);j._$requestByDWR("PhotoBean.rotateImage",_optionss);j._$endBatch()};__proCachePhoto.__cbBatchPhotoInfo=function(_photo,_options){try{this.__count++;this.__isok=!!this.__isok&&!!_photo;if(this.__count!=2){return}if(!this.__isok){this._$dispatchEvent("onphotoadd",-2);return}_photo=this.__filterPhoto(_photo);var _list=this._$getPhotoListInCache(_options.album);_list.unshift(_photo);this._$dispatchEvent("onphotoadd",_photo.id)}catch(e){alert(e.message)}};__proCachePhoto._$uploadPhoto=(function(){var _url="http://upload.photo.163.com/anony/web/upload/userdefinesize?sitefrom=blog_android&userdefinesize=280x280x0";return function(_file,_options){var _uploadOptions={onload:this.__uploadPhoto._$bind(this,_file),onerror:this.__uploadPhoto._$bind(this,_file,null),onprogress:this.__uploadPhoto._$bind(this,_file)};if(!!_options.pgtitle){_uploadOptions.pgtitle=_options.pgtitle}if(!!_options.pgdesc){_uploadOptions.pgdesc=_options.pgdesc}if(!!_options.pgsucc){_uploadOptions.pgsucc=_options.pgsucc}if(!!_options.pgfail){_uploadOptions.pgfail=_options.pgfail}if(!!_options.tipcnt){_uploadOptions.tipcnt=_options.tipcnt}if(!!_options.tiptime){_uploadOptions.tiptime=_options.tiptime}if(!!_options.finish){_uploadOptions.finish=_options.finish}navigator.file.upload(_url,_file,_uploadOptions)}})();__proCachePhoto.__uploadPhoto=function(_file,_data){var _photo=(u._$xml2object(_data)||o).netease;if(!!_photo){_photo.file=_file}this._$dispatchEvent("onphotoupload",_photo||null)};__proCachePhoto._$copyPhoto=function(_photoUpLoadWraper){var _options=this.__getDWROptionPhoto();var _pwrapers=[_photoUpLoadWraper];_options.param=[_pwrapers];_options.onload=this.__copyPhoto._$bind2(this);_options.onerror=this.__copyPhoto._$bind(this,null);j._$requestByDWR("PhotoBean.copy",_options)};__proCachePhoto.__copyPhoto=function(_succ){this._$dispatchEvent("onphotocopy",_succ)};__proCachePhoto._$getCommentCount=function(_pid){var _data=this._$getPhotoInCache(_pid);if(_data.commentCount!=null){this._$dispatchEvent("oncommentcountload",_pid);return}var _options=this.__getDWROptionPhoto();_options.param=[_pid,0,0,true];_options.onload=this.__getCommentCount._$bind2(this,_pid);_options.onerror=this.__getCommentCount._$bind(this,null,_pid);j._$requestByDWR("CommentBean.getAllPComms",_options)};__proCachePhoto.__getCommentCount=function(_photo,_pid){if(!!_photo){var _data=this._$getPhotoInCache(_pid);_data.commentCount=_photo.allcommcount||0}this._$dispatchEvent("oncommentcountload",_pid)};__proCachePhoto._$getCommentListInCache=function(_pid){return this._$getListByKeyInCache("photocomment-"+p._$VISITOR.userId+"-"+_pid)};__proCachePhoto._$getCommentList=function(_pid,_offset,_limit){this._$getListByDWR({photo:true,offset:_offset,limit:_limit,url:"CommentBean.getAllPComms",callback:["oncommentload",_pid],key:"photocomment-"+p._$VISITOR.userId+"-"+_pid,adjust:this.__filterCommentItem._$bind(this),filter:function(_data){var _list=(_data||o).commlist;if(!_list){return null}return u._$isArray(_list)?_list:[_list]},parse:function(_option){_option.param=[_pid,_limit,_offset,false]}})};__proCachePhoto.__filterCommentItem=function(_comment){if(!!_comment){_comment.content=_comment.con;_comment.publishTime=_comment.t;_comment.publisherName=_comment.runame;_comment.publisherNickName=_comment.rnname}return _comment};__proCachePhoto._$addComment=function(_pid,_content){var _visitor=p._$VISITOR,_options=this.__getDWROptionPhoto();_options.param=[_pid,_visitor.userName,_visitor.userNickname,"",1,_content,null,0,0,_visitor.userName,_visitor.userNickname,false];_options.onload=this.__addComment._$bind2(this,_pid,_content);_options.onerror=this.__addComment._$bind(this,null,_pid);j._$requestByDWR("CommentBean.addPCommNew",_options)};__proCachePhoto.__addComment=function(_data,_pid,_content){if(!!_data&&_data.errorType==0){var _list=this._$getCommentListInCache(_pid);_list.unshift(this.__filterCommentItem(_data));var _photo=this._$getPhotoInCache(_pid);_photo.commentCount+=1}this._$dispatchEvent("oncommentadd",_pid)};__proCachePhoto._$deletePhoto=function(_pid,_aid){var _options=this.__getDWROptionPhoto();_options.param=[[parseInt(_pid)],parseInt(_aid),(mb.d._$PHOTOVISITOR||o).userName];_options.method="POST";_options.onload=this.__deletePhoto._$bind(this,_pid,_aid);_options.onerror=this.__deletePhoto._$bind(this,_pid,_aid,null);j._$requestByDWR("PhotoBean.deleteWithoutAcegi",_options)};__proCachePhoto.__deletePhoto=function(_pid,_aid,_data){if(!!_data&&_data.errorType==0){var albumInCache=this._$getAlbumInCache(_aid);albumInCache.count-=1;this.__delDataLocal("photo-"+mb.x._$getHostName()+"-"+_aid);var photoListCache=this._$getPhotoListInCache(_aid,mb.x._$getHostName());for(var i=0;i<photoListCache.length;i++){if((photoListCache[i]||o).id==_pid){photoListCache.splice(i,1);break}}mb.x.alert("照片删除成功！");location.hash="#m=11&t=0&aid="+_aid+"&r=t"}else{mb.x.alert("照片删除失败！")}}})(MWF.O,MWF.F,MWF.P("mwf.u"),MWF.P("mwf.j"),MWF.P("mb.d"));(function(f,j,u,x,p){var __proCacheFriend;p._$$CacheFriend=MWF.C();__proCacheFriend=p._$$CacheFriend._$extend(p._$$Cache);__proCacheFriend._$getGroupListInCache=function(_username){return this._$getListByKeyInCache("friendgroup-"+_username||p._$VISITOR.userName)};__proCacheFriend._$getGroupList=function(_username){this._$getListByDWR({offset:0,limit:100,callback:["ongroupload"],url:"MobileFriendBean.getFriendsGroup",key:"friendgroup-"+(_username||p._$VISITOR.userName),parse:function(_options){_options.param=[]},filter:function(_data){return(_data.resultData||o).userGroups}})};__proCacheFriend._$getFriendListInCache=function(_gid,_username){return this._$getListByKeyInCache("friend-"+_username+"-"+(_gid||"all"))};__proCacheFriend._$getFriendList=function(_gid,_offset,_limit,_username){var _option={offset:_offset,limit:_limit,callback:["onfriendload",_gid],url:"MobileFriendBean.getFriendsByGroup",key:"friend-"+_username+"-"+(_gid||"all"),parse:function(_options){_options.param=[_gid,_offset,_limit]},filter:function(_data){return(_data.resultData||o).friends}};if(!_gid){_option.url="MobileFriendBean.getAllFriends";_option.parse=function(_options){_options.param=[_offset,_limit]}}this._$getListByDWR(_option)};__proCacheFriend._$addFriend=function(_uname,_groupId,_msg){var _options=this.__getDWROption();_options.param=[_msg||null,_groupId||0];_options.onload=this.__addFriend._$bind2(this,_uname);_options.onerror=this.__addFriend._$bind(this,null,_uname);j._$requestByDWR("MobileFriendBean.inviteFriend",_options)};__proCacheFriend.__addFriend=function(_data,_uname){this._$dispatchEvent("oninvitefriend",_data)};__proCacheFriend._$delFriend=function(_uname){var _options=this.__getDWROption();_options.param=[_uname];_options.onload=this.__delFriend._$bind2(this,_uname);_options.onerror=this.__delFriend._$bind(this,null,_uname);j._$requestByDWR("MobileFriendBean.delFriend",_options)};__proCacheFriend.__delFriend=function(_data,_uname){if(!!_data&&!!_data.resultData&&(_data.resultData.result==1)){this._$clearDataLocal("friend-"+p._$VISITOR.userName+"-all")}this._$dispatchEvent("ondeletefriend",_data)}})(MWF.F,MWF.P("mwf.j"),MWF.P("mwf.u"),MWF.P("mb.x"),MWF.P("mb.d"));(function(f,u,j,p){var __msgdata,__needNotification,__listener=[],__connected=false,__comtserver="ws://websocket.blog.163.com:8080/",__proCacheMessage;var __onCometOpen=function(){var _visitor=p._$VISITOR;j._$sendDataByCNT(__comtserver,'{"consumerKey":"a7ebe2ace2a9cb05ecc6c34ff263cc39","xauthToken":"'+_visitor.xauthToken+'"}')};var __onCometClose=function(){__connected=false;window.setTimeout(__buildComet,50)};var __onCometMessage=function(_data){var _msg=JSON.parse(_data.data);if(!_msg){return}var _key="notification-"+p._$VISITOR.userId;var _lastMsg=__proCacheMessage.__getDataLocal(_key);__needNotification=false;if(!!_lastMsg){var _type=["userMsgNewCount","alertMsgNewCount","comMsgNewCount","comReplyMsgNewCount","noteMsgNewCount"];for(var i=0,l=_type.length;i<l;i++){if(_lastMsg[_type[i]]<_msg[_type[i]]){__needNotification=true;break}}}__proCacheMessage.__setDataLocal(_key,_msg);__msgdata=_msg;for(var i=0,l=__listener.length;i<l;i++){try{__listener[i]()}catch(e){}}};var __buildComet=function(){if(__connected){return}__connected=true;j._$connect(__comtserver,{type:1,onopen:__onCometOpen,onclose:__onCometClose,onerror:__onCometClose,onmessage:__onCometMessage})};p._$$CacheMessage=MWF.C();__proCacheMessage=p._$$CacheMessage._$extend(p._$$Cache);p._$$CacheMessage._$close=function(){j._$closeConnection(__comtserver)};__proCacheMessage.__init=function(){this.__super();__buildComet()};__proCacheMessage._$addMsgListener=function(_callback){if(!u._$isFunction(_callback)){return}__listener.unshift(_callback);_callback()};__proCacheMessage._$getMessageInCache=function(){return __msgdata};__proCacheMessage._$needNotification=function(){return __needNotification};__proCacheMessage._$getTotalNewCount=function(){var _type=["userMsgNewCount","alertMsgNewCount","comMsgNewCount","comReplyMsgNewCount","noteMsgNewCount"];var _count=0;_msgData=this._$getMessageInCache();if(!_msgData){return _count}for(var i=0,l=_type.length;i<l;i++){_count+=_msgData[_type[i]]||0}return _count};__proCacheMessage._$getUsrMsgListInCache=function(){return this._$getListByKeyInCache("usrmsg-"+p._$VISITOR.userId)};__proCacheMessage._$getUsrSentMsgListInCache=function(){return this._$getListByKeyInCache("usrsentmsg-"+p._$VISITOR.userId)};__proCacheMessage._$getUsrMsgList=function(_offset,_limit){this._$getListByDWR({callback:["onusrmsgload"],offset:_offset,limit:_limit,key:"usrmsg-"+p._$VISITOR.userId,url:"MobileMsgBean.getUserRecvMsg"})};__proCacheMessage._$getUsrSentMsgList=function(_offset,_limit){this._$getListByDWR({callback:["onusrsentmsgload"],offset:_offset,limit:_limit,key:"usrsentmsg-"+p._$VISITOR.userId,url:"MobileMsgBean.getUserSentMsg"})};__proCacheMessage._$deleteUsrMsg=function(_id){var _dwrOptions=this.__getDWROption();_dwrOptions.url="MobileMsgBean.delUserMsg";_dwrOptions.onload=this.__deleteUsrMsgInCache._$bind(this,_id);_dwrOptions.param=[_id];j._$requestByDWR(_dwrOptions.url,_dwrOptions)};__proCacheMessage.__deleteUsrMsgInCache=function(_id,_result){if(!!_result){var _list=this._$getListByKeyInCache("usrmsg-"+p._$VISITOR.userId);for(var i=0;i<_list.length;i++){var _item=_list[i];if(_item.id==_id){_list.splice(i,1)}}}this._$dispatchEvent("onusrmsgdelete",!!_result)};__proCacheMessage._$getSndMsgListInCache=function(){return this._$getListByKeyInCache("sndmsg-"+p._$VISITOR.userId)};__proCacheMessage._$getSndMsgList=function(_offset,_limit){this._$getListByDWR({callback:["onsendmsgload"],offset:_offset,limit:_limit,key:"sndmsg-"+p._$VISITOR.userId,url:"MobileMsgBean.getUserSentMsg"})};__proCacheMessage._$getSysMsgListInCache=function(){return this._$getListByKeyInCache("sysmsg-"+p._$VISITOR.userId)};__proCacheMessage._$getSysMsgList=function(_offset,_limit){this._$getListByDWR({callback:["onsysmsgload"],offset:_offset,limit:_limit,key:"sysmsg-"+p._$VISITOR.userId,url:"MobileMsgBean.getAlertMsg"})};__proCacheMessage._$deleteSysMsg=function(_id){var _dwrOptions=this.__getDWROption();_dwrOptions.url="MobileMsgBean.delAlertMsg";_dwrOptions.onload=this.__deleteSysMsgInCache._$bind(this,_id);_dwrOptions.param=[_id];j._$requestByDWR(_dwrOptions.url,_dwrOptions)};__proCacheMessage.__deleteSysMsgInCache=function(_id,_result){if(!!_result){var _list=this._$getListByKeyInCache("sysmsg-"+p._$VISITOR.userId);for(var i=0;i<_list.length;i++){var _item=_list[i];if(_item.id==_id){_list.splice(i,1)}}}this._$dispatchEvent("onsysmsgdelete",!!_result)};__proCacheMessage._$getCmtMsgListInCache=function(){return this._$getListByKeyInCache("cmtmsg-"+p._$VISITOR.userId)};__proCacheMessage._$getCmtMsgList=function(_offset,_limit){this._$getListByDWR({offset:_offset,limit:_limit,callback:["oncommentmsgload"],key:"cmtmsg-"+p._$VISITOR.userId,url:"MobileMsgBean.getCommentMsg"})};__proCacheMessage._$deleteCommentMsg=function(_id){var _dwrOptions=this.__getDWROption();_dwrOptions.url="MobileMsgBean.delCommentMsg";_dwrOptions.onload=this.__deleteCommentMsgInCache._$bind(this,_id);_dwrOptions.param=[_id];j._$requestByDWR(_dwrOptions.url,_dwrOptions)};__proCacheMessage.__deleteCommentMsgInCache=function(_id,_result){if(!!_result){var _list=this._$getListByKeyInCache("cmtmsg-"+p._$VISITOR.userId);for(var i=0;i<_list.length;i++){var _item=_list[i];if(_item.id==_id){_list.splice(i,1)}}}this._$dispatchEvent("oncommentmsgdelete",!!_result)};__proCacheMessage._$getReplyMsgListInCache=function(){return this._$getListByKeyInCache("crpmsg-"+p._$VISITOR.userId)};__proCacheMessage._$getReplyMsgList=function(_offset,_limit){this._$getListByDWR({offset:_offset,limit:_limit,key:"crpmsg-"+p._$VISITOR.userId,callback:["oncommentreplymsgload"],url:"MobileMsgBean.getCommentReplyMsg"})};__proCacheMessage._$deleteCommentReplyMsg=function(_id){var _dwrOptions=this.__getDWROption();_dwrOptions.url="MobileMsgBean.delCommentMsg";_dwrOptions.onload=this.__deleteCommentReplyMsgInCache._$bind(this,_id);_dwrOptions.param=[_id];j._$requestByDWR(_dwrOptions.url,_dwrOptions)};__proCacheMessage.__deleteCommentReplyMsgInCache=function(_id,_result){if(!!_result){var _list=this._$getListByKeyInCache("crpmsg-"+p._$VISITOR.userId);for(var i=0;i<_list.length;i++){var _item=_list[i];if(_item.id==_id){_list.splice(i,1)}}}this._$dispatchEvent("oncommentreplymsgdelete",!!_result)};__proCacheMessage._$getNoteMsgListInCache=function(){return this._$getListByKeyInCache("notmsg-"+p._$VISITOR.userId)};__proCacheMessage._$getNoteMsgList=function(_offset,_limit){this._$getListByDWR({callback:["onnotemsgload"],offset:_offset,limit:_limit,key:"notmsg-"+p._$VISITOR.userId,url:"MobileMsgBean.getNoteMsg"})};__proCacheMessage._$deleteNoteMsg=function(_id){var _dwrOptions=this.__getDWROption();_dwrOptions.url="MobileMsgBean.delNoteMsg";_dwrOptions.onload=this.__deleteNoteMsgInCache._$bind(this,_id);_dwrOptions.param=[_id];j._$requestByDWR(_dwrOptions.url,_dwrOptions)};__proCacheMessage.__deleteNoteMsgInCache=function(_id,_result){if(!!_result){var _list=this._$getListByKeyInCache("notmsg-"+p._$VISITOR.userId);for(var i=0;i<_list.length;i++){var _item=_list[i];if(_item.id==_id){_list.splice(i,1)}}}this._$dispatchEvent("onnotemsgdelete",!!_result)};__proCacheMessage._$feedback=function(_content,_phone){var _options=this.__getDWROption();_options.param=[_content||"","",_phone||"","AndroidClient_1.0"];_options.onload=this.__feedback._$bind(this);_options.onerror=this.__feedback._$bind(this,null);j._$requestByDWR("MobileUserBean.sendFeedback",_options)};__proCacheMessage.__feedback=function(_data){var _code=((_data||o).resultData||o).result;this._$dispatchEvent("onfeedback",_code==1)};__proCacheMessage._$sendMsg=function(_receiverId,_content){var _options=this.__getDWROption();_options.param=[parseInt(_receiverId||"0"),_content||""];_options.onload=this.__sendMsg._$bind(this);_options.onerror=this.__sendMsg._$bind(this,null);_options.method="POST";j._$requestByDWR("MobileMsgBean.sendUserMsg",_options)};__proCacheMessage.__sendMsg=function(_data){var __result=((_data||o).resultData||o);if(__result.result==1){var __usrMsg={counterUserNick:__result.counterUserNick,publishTime:__result.publishTime,content:__result.content,counterUserName:__result.counterUserName};var __sentMsgListInCache=this._$getUsrSentMsgListInCache();if(!!__sentMsgListInCache){__sentMsgListInCache.splice(0,0,__usrMsg);this.__setDataLocal("usrsentmsg-"+p._$VISITOR.userId,__sentMsgListInCache)}}this._$dispatchEvent("onSendMsg",__result.result)};__proCacheMessage._$replyMsg=function(_msgId,_content){var _options=this.__getDWROption();_options.param=[parseInt(_msgId||"0"),_content||""];_options.onload=this.__replyMsg._$bind(this);_options.onerror=this.__replyMsg._$bind(this,null);_options.method="POST";j._$requestByDWR("MobileMsgBean.replyMsg",_options)};__proCacheMessage.__replyMsg=function(_data){var __result=((_data||o).resultData||o);if(__result.result==1){var __usrMsg={counterUserNick:__result.counterUserNick,publishTime:__result.publishTime,content:__result.content,counterUserName:__result.counterUserName};var __sentMsgListInCache=this._$getUsrSentMsgListInCache();if(!!__sentMsgListInCache){__sentMsgListInCache.splice(0,0,__usrMsg);this.__setDataLocal("usrsentmsg-"+p._$VISITOR.userId,__sentMsgListInCache)}}this._$dispatchEvent("onReplyMsg",__result.result)};__proCacheMessage._$replyNote=function(_noteId,_publishId,_content){var _options=this.__getDWROption();_options.param=[parseInt(_noteId||"0"),parseInt(_publishId||"0"),_content||""];_options.onload=this.__replyNote._$bind(this);_options.onerror=this.__replyNote._$bind(this,null);_options.method="POST";j._$requestByDWR("MobileNoteBean.replyNote",_options)};__proCacheMessage.__replyNote=function(_data){var __result=((_data||o).resultData||o);this._$dispatchEvent("oncbreplynote",__result.result)};__proCacheMessage._$acceptFriend=function(_msgId,_invitorId){var _options=this.__getDWROption();_options.param=[parseInt(_msgId||"0"),parseInt(_invitorId||"0")];_options.onload=this.__handleFriendinvitation._$bind(this,_msgId,102);_options.onerror=this.__handleFriendinvitation._$bind(this,_msgId,102,null);_options.method="POST";j._$requestByDWR("MobileMsgBean.acceptFriend",_options)};__proCacheMessage._$rejectFriend=function(_msgId,_invitorId){var _options=this.__getDWROption();_options.param=[parseInt(_msgId||"0"),parseInt(_invitorId||"0")];_options.onload=this.__handleFriendinvitation._$bind(this,_msgId,101);_options.onerror=this.__handleFriendinvitation._$bind(this,_msgId,101,null);_options.method="POST";j._$requestByDWR("MobileMsgBean.rejectFriend",_options)};__proCacheMessage.__handleFriendinvitation=function(_msgId,_code,_data){var __result=((_data||o).resultData||o);if(__result.result==1){var __sysMsgList=this._$getListByKeyInCache("sysmsg-"+p._$VISITOR.userId);if(!!__sysMsgList){for(var i=0;i<__sysMsgList.length;i++){if((__sysMsgList[i]||o).id==_msgId){__sysMsgList[i].responseCode=_code;break}}this.__setDataLocal("sysmsg-"+p._$VISITOR.userId,__sysMsgList)}}this._$dispatchEvent("onhandlefrdinvt",__result.result==1,_code)};__proCacheMessage._$deleteMsgListInCache=function(_type){var __key="";if(_type=="userMsgNewCount"){__key="usrmsg-"+p._$VISITOR.userId}else{if(_type=="alertMsgNewCount"){__key="sysmsg-"+p._$VISITOR.userId}else{if(_type=="comMsgNewCount"){__key="cmtmsg-"+p._$VISITOR.userId}else{if(_type=="comReplyMsgNewCount"){__key="crpmsg-"+p._$VISITOR.userId}else{if(_type=="noteMsgNewCount"){__key="notmsg-"+p._$VISITOR.userId}}}}}this.__delDataLocal(__key)}})(MWF.F,MWF.P("mwf.u"),MWF.P("mwf.j"),MWF.P("mb.d"));(function(o,f,e,u,v,t,d,p){var __proModule,__supModule,__proModuleSP;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$Module,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return u._$randNumberString(4)};__proModule.__getAlbumName=function(_aid){var __album=this.__photoCache._$getAlbumInCache(_aid)||o;return __album.name||"查看相册"};__proModule._$show=function(_options){this.__options=_options;if(this.__options.m==0){u.SetCustomTitle('{"TITLE":{"text":"网易博客","actiontype":"js", "action":"mb.x.top()"}}')}else{if(this.__options.m==1){if(this.__options.t==0){u.SetCustomTitle('{"TITLE":{"text":"网易博客","actiontype":"js", "action":"mb.x.top()"}                              ,"BOTTOM":{"checked":"home"}                              ,"BTN_ZERO":{"type":"WRITE_BLOG","actiontype":"js", "action":"mb.x.post()"}                              ,"BTN_ONE":{"type":"REFRESH","actiontype":"js", "action":"mb.m[\'m'+this._$getId()+"'].r()\"}}")}else{if(this.__options.t==1){u.SetCustomTitle('{"TITLE":{"text":"发布心情","actiontype":"js", "action":"mb.x.top()"}}')}else{if(this.__options.t==2){u.SetCustomTitle('{"TITLE":{"text":"发布日志","actiontype":"js", "action":"mb.x.top()"}                              ,"BTN_ZERO":{"type":"ADD_PHOTO","actiontype":"js","action":"mb.m[\'m'+this.__options.m+"'].u()\"}}")}else{if(this.__options.t==3){u.SetCustomTitle('{"TITLE":{"text":"上传到博客相册","actiontype":"js", "action":"mb.x.top()"}}')}else{if(this.__options.t==4){u.SetCustomTitle('{"TITLE":{"text":"'+(!!this.__options.s?"分享图片":"上传图片")+'","actiontype":"js", "action":"mb.x.top()"}}')}else{if(this.__options.t==5){u.SetCustomTitle('{"TITLE":{"text":"撰写正文","actiontype":"js", "action":"mb.x.top()"}}')}}}}}}}else{if(this.__options.m==2){var _title;if(this.__options.t==0){_title="消息中心"}else{if(this.__options.t==1){_title="短消息"}else{if(this.__options.t==2){_title="系统通知"}else{if(this.__options.t==3){_title="评论通知"}else{if(this.__options.t==4){_title="评论回复通知"}else{if(this.__options.t==5){_title="留言通知"}else{if(this.__options.t==6){_title="短消息"}else{if(this.__options.t==7){_title="消息回复"}else{if(this.__options.t==8){_title="留言回复"}}}}}}}}}if(!!_title){if("消息中心"==_title){u.SetCustomTitle('{"TITLE":{"text":"'+_title+'","actiontype":"js", "action":"mb.x.top()"}        		         ,"BOTTOM":{"checked":"msg"}}')}else{u.SetCustomTitle('{"TITLE":{"text":"'+_title+'","actiontype":"js", "action":"mb.x.top()"}}')}}}else{if(this.__options.m==4){var _title;if(this.__options.t==1){_title="日志草稿"}else{if(this.__options.t==5){_title="设置"}else{if(this.__options.t==6){_title="反馈"}else{if(this.__options.t==7){_title="关于"}else{_title="更多"}}}}if(!!_title){if("更多"==_title){u.SetCustomTitle('{"TITLE":{"text":"'+_title+'","actiontype":"js", "action":"mb.x.top()"}        		         ,"BOTTOM":{"checked":"more"}}')}else{u.SetCustomTitle('{"TITLE":{"text":"'+_title+'","actiontype":"js", "action":"mb.x.top()"}}')}}}else{if(this.__options.m==5){var _title;if(this.__options.t==1){_title="博友"}else{if(this.__options.t==3){_title="我关注的人"}else{if(this.__options.t==4){_title="关注我的人"}else{if(this.__options.t==5){_title="最近来访"}else{if(this.__options.t==6){_title="最近走访"}else{_title="博友与关注"}}}}}if(!!_title){u.SetCustomTitle('{"TITLE":{"text":"'+_title+'","actiontype":"js", "action":"mb.x.top()"}}')}}else{if(this.__options.m==3){if(!!this.__options.uname&&!(this.__options.uname==d._$VISITOR.userName)){u.SetCustomTitle('{"TITLE":{"text":"网易博客","actiontype":"js", "action":"mb.x.top()"}		                        ,"BOTTOM":{"checked":"other"}		                        ,"BTN_ZERO":{"type":"REFRESH","actiontype":"js", "action":"mb.m[\'m'+this._$getId()+"'].r()\"}}")}else{u.SetCustomTitle('{"TITLE":{"text":"网易博客","actiontype":"js", "action":"mb.x.top()"}		                        ,"BOTTOM":{"checked":"blog"}			                    ,"BTN_ZERO":{"type":"WRITE_BLOG","actiontype":"js", "action":"mb.x.post()"}		                        ,"BTN_ONE":{"type":"REFRESH","actiontype":"js", "action":"mb.m[\'m'+this._$getId()+"'].r()\"}}")}}else{if(this.__options.m==8){u.SetCustomTitle('{"TITLE":{"text":"反馈"}}')}else{if(this.__options.m==6){if(!!this.__options.uname&&!(this.__options.uname==d._$VISITOR.userName)){if(this.__options.t==0){u.SetCustomTitle('{"TITLE":{"text":"阅读日志","actiontype":"js", "action":"mb.x.top()"}            			,"BTN_ZERO":{"type":"REC_BLOG","actiontype":"js", "action":"mb.m[\'m'+this._$getId()+"'].r()\"}}")}}else{if(this.__options.t==0&&!this.__options.draft){u.SetCustomTitle('{"TITLE":{"text":"阅读日志","actiontype":"js", "action":"mb.x.top()"}            			,"BTN_ZERO":{"type":"DELETE","actiontype":"js", "action":"mb.m[\'m'+this._$getId()+"'].d()\"}}")}}}else{if(this.__options.m==7){if(!!this.__options.cid){u.SetCustomTitle('{"TITLE":{"text":"回复评论"}}')}else{u.SetCustomTitle('{"TITLE":{"text":"评论日志"}}')}}else{if(this.__options.m==9){u.SetCustomTitle('{"TITLE":{"text":"阅读心情"}}')}else{if(this.__options.m==10){if(!!this.__options.cid){u.SetCustomTitle('{"TITLE":{"text":"回复评论"}}')}else{u.SetCustomTitle('{"TITLE":{"text":"评论心情"}}')}}else{if(this.__options.m==13){if(this.__options.t==0){u.SetCustomTitle('{"TITLE":{"text":"发消息","actiontype":"js", "action":"mb.x.top()"}}')}else{if(this.__options.t==1){u.SetCustomTitle('{"TITLE":{"text":"网易博客","actiontype":"js", "action":"mb.x.top()"}}')}}}else{if(this.__options.m==11){if(this.__options.t==1){if(mb.d._$VISITOR.userName==mb.x._$getHostName()){u.SetCustomTitle('{"TITLE":{"text":"查看照片","actiontype":"js", "action":"mb.x.top()"}                        ,"BTN_ZERO":{"type":"DELETE","actiontype":"js", "action":"mb.m[\'m'+this._$getId()+"'].d()\"}}")}else{u.SetCustomTitle('{"TITLE":{"text":"查看照片","actiontype":"js", "action":"mb.x.top()"}}')}}else{if(this.__options.t==0){u.SetCustomTitle('{"TITLE":{"text":"'+this.__getAlbumName(this.__options.aid)+'","actiontype":"js", "action":"mb.x.top()"}}')}}}else{if(this.__options.m==14){if(this.__options.t==0){u.SetCustomTitle('{"TITLE":{"text":"留言","actiontype":"js", "action":"mb.x.top()"}                    ,"BTN_ZERO":{"type":"REFRESH","actiontype":"js", "action":"mb.m[\'m'+this._$getId()+"'].r()\"}}")}else{if(this.__options.t==1){u.SetCustomTitle('{"TITLE":{"text":"留言","actiontype":"js", "action":"mb.x.top()"}}')}}}else{if(this.__options.m==15){u.SetCustomTitle('{"TITLE":{"text":"网易博客","actiontype":"js", "action":"mb.x.top()"}                ,"BOTTOM":{"checked":"other"}}')}else{if(this.__options.m==16){u.SetCustomTitle('{"TITLE":{"text":"推荐日志"}}')}else{u.SetCustomTitle('{"TITLE":{"type":"button type","actiontype":"js", "text":"网易博客","action":"mb.x.top()"}                        ,"BTN_ZERO":{"type":"REFRESH","actiontype":"js", "action":"mb.m[\'m'+this._$getId()+"'].r()\"}}")}}}}}}}}}}}}}}}}if(this.__options.m==0){u.SetLoginState("logout")}else{if((this.__options.m==1)&&(this.__options.t==0)){u.SetLoginState("personal_center")}else{if((this.__options.m==4)&&(this.__options.t==7)){if(!this.__cache._$isLogin()){u.SetLoginState("logout")}else{u.SetLoginState("other")}}else{u.SetLoginState("other")}}}__supModule._$show.apply(this,arguments)};__proModule.__setTop=function(){mb.x.top()};__proModule._$hide=function(){this.__onBeforeHide();this.__body.style.display="none"};__proModule.__hasTopbar=function(){return false};__proModule.__buildModule=function(){d._$IP=mwf.mb._$getIpAddress();var _mid=this._$getId();this.__tkey="js-"+mb.c._TAG_KEY;this.__body=e._$create("div","g-mdl mdl-"+_mid);this.__body.innerHTML=this.__getXhtml()||"";this.__pbody=this.__body;var _id=_mid.split("-")[0];p["m"+_mid]=p["m"+_mid]||{};p["m"+_mid].g=this.__onGo._$bind(this);if(!!this.__hasTopbar()||_mid=="14-0"){p["m"+_mid].r=this.__onRefresh._$bind(this)}this.__cache=new d._$$CacheUser();this.__photoCache=new d._$$CachePhoto()};__proModule.__onGo=function(_hash){location.hash=_hash};__proModule.__onRefresh=function(){if(!mb.x._$isOnline()){mb.x.alert("网络连接出现问题，请检查网络！");return}if(!!this.__cache){this.__cache._$clearDataLocal()}this._$show(this.__options,true)};__proModule.__onAfterShow=function(){mb.x.loadFinish()};__proModule.__getXhtml=f;p._$$ModuleSP=MWF.C();p._$$ModuleSP._$extend(t._$$ModuleCP,true)})(MWF.O,MWF.F,MWF.P("mwf.e"),MWF.P("mwf.u"),MWF.P("mwf.v"),MWF.P("mwf.ut"),MWF.P("mb.d"),MWF.P("mb.m"));(function(t,p){var __proHashManager;p._$$HashManager=MWF.C();__proHashManager=p._$$HashManager._$extend(t._$$HashManager,true);__proHashManager.__needHistory=function(_hash){var _history=this.__history[this.__pointer],_new=this.__query2obj(_hash),_old=this.__query2obj(_history);if((((_new.t==0)&&(_old.t==undefined))||((_new.t==undefined)&&(_old.t==0)))&&(_new.m==_old.m)){return false}if((_new.t==4||_new.t==5)&&_new.m==1){return false}if((_new.m==7||_new.m==10)){return false}if(_new.m==11&&_new.t==1){return false}if(_new.m==2){if(_new.t==6||_new.t==7||_new.t==8){return false}}if(_new.m==8){return false}if(_new.m==13){return false}if(_new.m==15){return false}if(_new.m==16){return false}if(_new.m==0&&!_new.t){return false}if(_new.m==1&&!_new.t){return false}if(_new.m==14&&_new.t==1){return false}if(_new.m==1&&_new.t==2){return false}return true}})(MWF.P("mwf.ut"),MWF.P("mb.m"));(function(j,t,d,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true);__proValidator.__init=function(){this.__super();this.__cache=new d._$$CacheUser();this.__cache._$addEvent("onlogin",this.__cbLogin._$bind(this))};__proValidator.__isLogin=function(){if(this.__cache._$isLogin()){return true}return this.__cache._$autologin()};__proValidator.__cbLogin=function(_result){this.__logined=(_result==1);if(!this.__logined){return}this.__mcache=new d._$$CacheMessage();this.__mcache._$addMsgListener(this.__onMessage._$bind(this))};__proValidator.__onMessage=function(){var _count=this.__mcache._$getTotalNewCount()||0;var _needNotification=this.__mcache._$needNotification();if(_count>=0){if(j._$getDataInPreference("notification")=="1"){if(_needNotification){var _ring=j._$getDataInPreference("ring");if(!!_ring){navigator.notification.ring(_ring)}if(j._$getDataInPreference("vibrate")=="1"){navigator.notification.vibrate(500)}}if(_count==0){mb.x.cancelNotification()}else{var _ticker="",_title="网易博客",_text="你有"+_count+"条新消息";navigator.notification.notify({ticker:_ticker,title:_title,message:_text,manual:true})}}}};__proValidator._$validate=function(_options){if(_options.m==4&&_options.t==7){this._$dispatchEvent("onpass",_options);return}this.__isLogin()?this._$dispatchEvent("onpass",_options):this._$dispatchEvent("onredirect","#m=0",true)}})(MWF.P("mwf.j"),MWF.P("mwf.ut"),MWF.P("mb.d"),MWF.P("mb.m"));(function(t,p){var __proConfiguration;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m0"));(function(o,j,e,v,d,t,p){var __proModule,__supModule;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$Module,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"0"};__proModule.__buildModule=function(){__supModule.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheUser();this.__cache._$addEvent("onlogin",this.__cbLogin._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__form={username:_list[1],cleanUserName:_list[2],password:_list[3],cleanPassWord:_list[4],remember:_list[5],"btn-login":_list[6]};this.__form.reset=function(){for(var x in this){if(x=="reset"||x=="btn-login"){continue}this[x].value=""}e._$delClassName(this["remember"].parentNode,"js-ok")};v._$addEvent(this.__form.cleanUserName,"click",this.__onClear._$bind(this,"username"));v._$addEvent(this.__form.cleanPassWord,"click",this.__onClear._$bind(this,"password"));v._$addEvent(this.__form["btn-login"],"click",this.__onLogin._$bind(this));v._$addEvent(this.__form.remember,"click",this.__onRemember._$bind(this));v._$addEvent(_list[0],"click",this.__onItemClick._$bind(this));this.__form.reset();var _info=this.__cache._$getUserLogin()||o;this.__form.username.value=_info.u||"";this.__form.username.value="";this.__form.password.value="";e._$addClassName(this.__form.remember.parentNode,"js-ok");this.__form.remember.checked=true};__proModule._$show=function(_options){__supModule._$show.apply(this,arguments);mb.x.loadFinish()};__proModule.__getXhtml=function(){return e._$getHtmlTemplate("m0-jst-0",{tag:this.__tkey})};__proModule.__onRemember=function(_event){var _checked=!!this.__form.remember.checked,_ui=this.__form.remember.parentNode;!!_checked?e._$addClassName(_ui,"js-ok"):e._$delClassName(_ui,"js-ok")};__proModule.__onClear=function(_name){var _node=this.__form[_name];_node.value="";_node.focus()};__proModule.__abled=function(_btn){e._$delClassName(_btn,"s-fc1");_btn.disabled=false};__proModule.__disabled=function(_btn){e._$addClassName(_btn,"s-fc1");_btn.disabled=true};__proModule.__onItemClick=function(_event){var _elementTop=v._$getElement(_event,function(e){return !!e.className&&e.className.indexOf("top")>=0});var _elementBottom=v._$getElement(_event,function(e){return !!e.className&&e.className.indexOf("bottom")>=0});if(!!_elementTop){this.__form.cleanUserName.style.display="";this.__form.cleanPassWord.style.display="none"}else{if(!!_elementBottom){this.__form.cleanUserName.style.display="none";this.__form.cleanPassWord.style.display=""}else{this.__form.cleanUserName.style.display="none";this.__form.cleanPassWord.style.display="none"}}};__proModule.__nodeBlur=function(_event){var __node=_event.srcElement};__proModule.__onLogin=function(_event){v._$stop(_event);if(!mb.x._$isOnline()){mb.x.alert("网络连接出现问题，请检查网络！");return}this.__disabled(this.__form["btn-login"]);try{mwf.u.showToast("正在登录...",10000)}catch(e){}var _node=this.__form.username,_username=_node.value;if(!this.__cache._$checkUserName(_username)){mb.x.alert("请输入正确格式的用户名!");_node.select();this.__abled(this.__form["btn-login"]);return}_node=this.__form.password;var _password=_node.value;if(!_password){mb.x.alert("请输入密码!");_node.select();this.__abled(this.__form["btn-login"]);return}this.__cache._$setRemember(this.__form.remember.checked);this.__cache._$loginByXAuth(_username,_password)};__proModule.__cbLogin=function(_result){var _message="暂时无法登录，请稍后再试！";this.__abled(this.__form["btn-login"]);switch(_result){case 1:_message="";this.__mcache=new d._$$CacheMessage();this.__mcache._$addMsgListener(this.__onMessage._$bind(this));this._$dispatchEvent("onredirect","m=1");break;case 0:case -1:_message="用户名或者密码错误！";break;case -2:_message="请激活网易博客后登录！";break}if(!!_message){mb.x.alert(_message)}};__proModule.__onMessage=function(){var _count=this.__mcache._$getTotalNewCount()||0;var _needNotification=this.__mcache._$needNotification();if(_count>=0){if(j._$getDataInPreference("notification")=="1"){if(_needNotification){var _ring=j._$getDataInPreference("ring");if(!!_ring){navigator.notification.ring(_ring)}if(j._$getDataInPreference("vibrate")=="1"){navigator.notification.vibrate(500)}}if(_count==0){mb.x.cancelNotification()}else{var _ticker="",_title="网易博客",_text="你有"+_count+"条新消息";navigator.notification.notify({ticker:_ticker,title:_title,message:_text,manual:true})}}}}})(MWF.O,MWF.P("mwf.j"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mb.m.m0"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true);__proValidator._$validate=function(_options){if(this.__isLogin()){this._$dispatchEvent("onredirect","#m=1&t=0",true)}else{this._$dispatchEvent("onpass",_options)}}})(MWF.P("mb.m"),MWF.P("mb.m.m0"));(function(t,p){var __proConfiguration,__proConfigurationMA,__proConfigurationMB,__proConfigurationMC,__proConfigurationMD,__proConfigurationME,__proConfigurationMF;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationMA=MWF.C();__proConfigurationMA=p._$$ConfigurationMA._$extend(t._$$Configuration,true);__proConfigurationMA.__getModule=function(){return p._$$ModuleA._$allocate(this.__mopt)};p._$$ConfigurationMB=MWF.C();__proConfigurationMB=p._$$ConfigurationMB._$extend(t._$$Configuration,true);__proConfigurationMB.__getModule=function(){return p._$$ModuleB._$allocate(this.__mopt)};p._$$ConfigurationMC=MWF.C();__proConfigurationMC=p._$$ConfigurationMC._$extend(t._$$Configuration,true);__proConfigurationMC.__getModule=function(){return p._$$ModuleC._$allocate(this.__mopt)};p._$$ConfigurationMD=MWF.C();__proConfigurationMD=p._$$ConfigurationMD._$extend(t._$$Configuration,true);__proConfigurationMD.__getModule=function(){return p._$$ModuleD._$allocate(this.__mopt)};p._$$ConfigurationME=MWF.C();__proConfigurationME=p._$$ConfigurationME._$extend(t._$$Configuration,true);__proConfigurationME.__getModule=function(){return p._$$ModuleE._$allocate(this.__mopt)};p._$$ConfigurationMF=MWF.C();__proConfigurationMF=p._$$ConfigurationMF._$extend(t._$$Configuration,true);__proConfigurationMF.__getModule=function(){return p._$$ModuleF._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m1"));(function(o,u,e,v,j,w,d,x,t,p){var __proModule,__supModule,__proModuleA,__supModuleA,__proModuleB,__supModuleB,__proModuleC,__supModuleC,__proModuleD,__supModuleD,__proModuleE,__supModuleE,__proModuleF,__supModuleF;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"1"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationMA,1:p._$$ConfigurationMB,2:p._$$ConfigurationMC,3:p._$$ConfigurationMD,4:p._$$ConfigurationME,5:p._$$ConfigurationMF},onerror:this._$dispatchEvent._$bind(this,"onredirect","m=1&t=0",true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleA=MWF.C();__proModuleA=p._$$ModuleA._$extend(t._$$Module,true);__supModuleA=p._$$ModuleA._$supro;__proModuleA._$getId=function(){return"1-0"};__proModuleA.__hasTopbar=function(){return true};__proModuleA._$show=function(_options,_refresh){__supModuleA._$show.apply(this,arguments);if(!this.__referrer||this.__referrer.indexOf("m=0")>=0||this.__container.children.length<5||!!_refresh){this.__refreshModule()}else{mb.x.scrollTop(this.__bst,this.__dst)}mb.x.loadFinish()};__proModuleA.__refreshModule=function(){mb.x.top();this.__mtrack._$refresh()};__proModuleA.__buildModule=function(){__supModuleA.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheTrack();this.__cache._$addEvent("ontrackload",this.__cbLoadTrack._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__mtrack=new w._$$SimpleList({jst:"m-jst-2",box:_list[0],btn:_list[1],empty:"没有动态数据！",onnext:this.__onLoadTrack._$bind(this)});e._$mbhover(_list[0],"js-click",function(e){return e.tagName=="A"});v._$addEvent(_list[0],"click",this.__onItemClick._$bind(this));this.__container=_list[0];window.x.m1t0=window.x.m1t0||{};window.x.m1t0.gotoHome=function(_name){this._$dispatchEvent("onredirect","#m=3&t=0&uname="+_name)}._$bind(this);this.__bst=0;this.__dst=0};__proModuleA.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleA.__onItemClick=function(_event){var _element=v._$getElement(_event,function(e){return !!e.className&&e.className.indexOf("w-face")==0});if(!!_element){v._$stop(_event);var _src=_element.children[0].src||"",_username=_src.split("host=")[1];this._$dispatchEvent("onredirect","#m=3&t=0&uname="+_username)}else{_element=v._$getElement(_event,function(e){return((e||o).className||"").indexOf("js-merge")>=0});if(!!_element){v._$stop(_event);var _names=_element.attributes.followusernames.value.split("||"),_nicks=_element.attributes.follownicknames.value.split("||"),_str=[],i=0,l=_names.length-1;for(;i<l;i++){if(!!_names[i]){_str.push('{"title":"'+_nicks[i]+'","action":"window.x.m1t0.gotoHome(\''+_names[i]+"')\"}")}}u.PopUpMenu("关注了","["+_str.join(",")+"]")}}};__proModuleA.__getXhtml=function(){return e._$getHtmlTemplate("m1-jst-0",{tag:this.__tkey,user:d._$VISITOR})};__proModuleA.__onLoadTrack=function(_offset,_limit){this.__cache._$getTrackList(1,_offset,_limit,d._$VISITOR.userName)};__proModuleA.__cbLoadTrack=function(_type,_offset,_limit){this.__mtrack._$append(this.__cache._$getTrackListInCache(_type,d._$VISITOR.userName))};__proModuleA.__mergeTrack=function(_clist){var _list=_clist.slice(0),i=0,j=0,l=_list.length,_ol=l,_item;for(;i<l;i++){if(_list[i].type==-4){_item=_list[i];_item.followUserNames=[];_item.followNickNames=[];_item.followUserNames.push(_item.follow_userName);_item.followNickNames.push(_item.follow_nickName);for(j=i+1;j<l;j++){if(_list[j].type==-4&&_list[j].userId==_item.userId){_item.followUserNames.push(_list[j].follow_userName);_item.followNickNames.push(_list[j].follow_nickName);_list.splice(j,1);j--;l--}}}}_list.mergeCount=_ol-l;return _list};p._$$ModuleB=MWF.C();__proModuleB=p._$$ModuleB._$extend(t._$$Module,true);__supModuleB=p._$$ModuleB._$supro;__proModuleB._$getId=function(){return"1-1"};__proModuleB._$show=function(_options){__supModuleB._$show.apply(this,arguments);this.__resetModule(_options)};__proModuleB.__resetModule=function(_options){this.__cnt.value="";this.__cnt.focus();e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=true};__proModuleB.__getXhtml=function(){return e._$getHtmlTemplate("m1-jst-1",{tag:this.__tkey})};__proModuleB.__buildModule=function(){__supModuleB.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMood();this.__cache._$addEvent("onmoodadd",this.__cbMoodPost._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__cnt=_list[0];this.__btn=_list[1];e._$mbfocus(this.__cnt);v._$addEvent(this.__cnt,"input",this.__onMoodInput._$bind(this));v._$addEvent(this.__btn,"click",this.__onMoodPost._$bind(this))};__proModuleB.__onMoodInput=function(_event){if(this.__cnt.value==""){e._$addClassName(this.__btn,"s-fc1");this.__btn.disabled=true}else{e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=false}};__proModuleB.__onMoodPost=function(){var _node=this.__cnt;if(!_node.value){mb.x.alert("请输入心情内容！");_node.focus();return}if(!!this.__btn.disabled){return}this.__btn.disabled=true;var _mood={content:_node.value,userName:d._$VISITOR.userName};this.__cache._$addMood(_mood)};__proModuleB.__cbMoodPost=function(_id){this.__btn.disabled=false;if(!_id){mb.x.alert("暂时无法发布心情，请稍后再试！");return}this._$dispatchEvent("onredirect","m=3&t=2",true)};p._$$ModuleC=MWF.C();__proModuleC=p._$$ModuleC._$extend(t._$$Module,true);__supModuleC=p._$$ModuleC._$supro;__proModuleC._$getId=function(){return"1-2"};__proModuleC._$show=function(_options){__supModuleC._$show.apply(this,arguments);this.__resetModule(_options);p.u=this.__onUploadPhoto._$bind(this)};__proModuleC.__getXhtml=function(){return e._$getHtmlTemplate("m1-jst-2",{tag:this.__tkey})};__proModuleC.__buildModule=function(){__supModuleC.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheBlog();this.__cache._$addEvent("onblogpost",this.__cbBlogPost._$bind(this));this.__cache._$addEvent("onblogdraft",this.__cbBlogDraft._$bind(this));this.__pcache=new d._$$CachePhoto();this.__pcache._$addEvent("onphotoupload",this.__cbUploadPhoto._$bind(this));this.__pcache._$addEvent("onphotocopy",this.__cbPhotoCopy._$bind(this));this.__imgs=[];this.__imgsSrc=[];this.__imgsSrcUrl=[];this.__photoIndex=0;var _list=e._$getByClassName(this.__body,this.__tkey);this.__title=_list[0];this.__content=_list[1];this.__photoC=_list[2];this.__class=_list[3];this.__postBtn=_list[4];v._$addEvent(this.__postBtn,"click",this.__onBlogAdd._$bind(this));v._$addEvent(this.__class.parentNode,"click",this.__showBlogClass._$bind(this));v._$addEvent(this.__title,"focus",this.__showImage._$bind(this,false));v._$addEvent(this.__title,"blur",this.__showImage._$bind(this,true));v._$addEvent(this.__content,"tap",this.__gotoWrite._$bind(this));this.__cache._$getBlogClassList(d._$VISITOR.userName);window.x.m1t2=window.x.m1t2||{};window.x.m1t2.getPictureFromCamera=this._$getPictureFromCamera._$bind(this);window.x.m1t2.getPictureFromStorage=this._$getPictureFromStorage._$bind(this);window.x.m1t2.onBlogClassSelect=this._$onBlogClassSelect._$bind(this);window.x.m1t2.onDelete=this.__onDelete._$bind(this)};__proModuleC.__gotoWrite=function(){this._$dispatchEvent("onredirect","#m=1&t=5")};__proModuleC.__createImageNode=function(_src){var _li=e._$create("li");_li.innerHTML='<img src="'+_src+'"/><div class="del" onClick="window.x.m1t2.onDelete(\''+_src+"');\"></div>";return _li};__proModuleC.__resetModule=function(_options){this.__src=unescape(_options.src);this.__txt=this.__cache._$getTextFromCache()||"";this.__content.innerText=(!!this.__txt?this.__txt:"");this.__postBtn.disabled=!this.__txt;if(!!_options.src&&u._$indexOf(this.__imgs,_options.src)==-1){if(this.__imgs.length>=6){mb.x.alert("图片不能超过六张！");return}this.__imgs.push(_options.src);var _imgNode=this.__createImageNode(this.__src);this.__photoC.appendChild(_imgNode)}this.__showImage(true)};__proModuleC.__clear=function(){this.__title.value="";this.__txt=this.__content.innerText="";delete this.__classId;this.__class.innerText="默认分类";this.__postBtn.disabled=false;this.__imgs=[];this.__imgsSrc=[];this.__imgsSrcUrl=[];this.__photoIndex=0;this.__photoC.innerHTML="";this.__cache._$writeTextToCache("")};__proModuleC.__showImage=function(_show){_show=!!_show&&!!this.__imgs.length;this.__photoC.style.display=(_show?"":"none");this.__content.style.bottom=(_show?"219px":"118px")};__proModuleC.__onUploadPhoto=function(_event){u.PopUpMenu("上传图片",'[{"title":"拍照","action":"window.x.m1t2.getPictureFromCamera()"}                           ,{"title":"打开图库","action":"window.x.m1t2.getPictureFromStorage()"}]')};__proModuleC.__showBlogClass=function(){var _list=this.__cache._$getBlogClassListInCache(d._$VISITOR.userName),_strArr=[],_className;if(!_list||!_list.length){try{u.showToast("日志分类正在加载中...",5000)}catch(e){}return}for(var i=0,l=_list.length;i<l;i++){_className=u._$escape(_list[i].className);_strArr.push('{"title":"'+_className+'","action":"window.x.m1t2.onBlogClassSelect(\''+_list[i].id+"','"+_className+"')\"}")}u.PopUpMenu("选择日志分类","["+_strArr.join(",")+"]")};__proModuleC._$onBlogClassSelect=function(_id,_className){this.__classId=_id;this.__class.innerText=u._$unescape(_className)||"默认分类"};__proModuleC._$getPictureFromCamera=function(_event){try{navigator.capture.getImage({onsuccess:this.__cbGetFile._$bind(this),onerror:this.__cbGetFile._$bind(this,null)})}catch(e){mb.x.alert(e.message)}};__proModuleC._$getPictureFromStorage=function(){try{navigator.file.select(this.__cbGetFile._$bind(this))}catch(e){mb.x.alert(e.message)}};__proModuleC.__cbGetFile=function(_file){if(!_file){return}location.hash="#m=1&t=4&s=2&src="+escape(_file)};__proModuleC.__onDelete=function(_src,_event){var _index=u._$indexOf(this.__imgs,escape(_src));if(_index>=0){this.__imgs.splice(_index,1);e._$remove(this.__photoC.children[_index])}this.__showImage(true);delete this.__src};__proModuleC.__onBlogAdd=function(){this.__type=0;if(!this.__txt){u.showToast("请输入日志内容！");return}if(!!this.__postBtn.disabled){return}this.__postBtn.disabled=true;if(!!this.__imgs.length){this.__isDraft=false;this.__onUpload();return}this.__onBlogPost()};__proModuleC.__onUpload=function(){_index=this.__photoIndex||0;if(_index>=this.__imgs.length){return}this.__pcache._$uploadPhoto(unescape(this.__imgs[_index]),{finish:"/html/index.html#m=1&t=0",pgtitle:"网易博客",pgdesc:"正在上传日志图片...",tipcnt:"正在上传图片，请在通知窗口查看进度...",tiptime:5000});this.__postBtn.disabled=false;this.__uploading=true;if((location.hash!="#m=1&t=0")&&(location.hash.indexOf("m=3")<0)&&!this.__isDraft){this._$dispatchEvent("onredirect","m=3&t=0",true)}else{if((location.hash!="#m=1&t=0")&&(location.hash.indexOf("m=3")<0)&&!!this.__isDraft){this._$dispatchEvent("onredirect","m=1&t=0",true)}}};__proModuleC.__onBlogSave=function(_result){this.__type=1;if(_result=="true"){if(!!this.__imgs.length){this.__isDraft=true;this.__onUpload();return}this.__onBlogDraft()}else{this.__clear();this._$dispatchEvent("onredirect","m=3&t=0",true)}};__proModuleC.__onBlogPost=function(_suffix){_suffix=_suffix||"";this.__postBtn.disabled=true;mb.x.alert("正在发布日志...");this.__cache._$addBlog({cid:this.__classId||0,title:this.__title.value||(u._$format(new Date(),"yyyy年MM月dd日")),content:this.__txt+"<br/>"+_suffix})};__proModuleC.__onBlogDraft=function(_suffix){_suffix=_suffix||"";this.__postBtn.disabled=true;mb.x.alert("正在保存草稿...");this.__cache._$addDraft({cid:this.__classId||0,title:this.__title.value||(u._$format(new Date(),"yyyy年MM月dd日")),content:this.__txt+"<br/>"+_suffix})};__proModuleC.__cbUploadPhoto=function(_photo){this.__uploading=false;if(!_photo){mb.x.alert("图片上传失败,请稍后再试!");this._$dispatchEvent("onredirect","#m=1&t=2");this.__postBtn.disabled=false;return}this.__photoIndex++;this.__imgsSrc.push('<img src="'+(_photo.userDef1Url)+'"/>');this.__imgsSrcUrl.push(_photo.userDef1Url);if(this.__photoIndex>=this.__imgs.length){var _photoUpLoadWraper={},i=0;_photoUpLoadWraper.imgStorageType=3;for(;i<this.__imgs.length;i++){if(i==0){_photoUpLoadWraper.userDef1Url=this.__imgsSrcUrl[i]||""}else{if(i==1){_photoUpLoadWraper.userDef2Url=this.__imgsSrcUrl[i]||""}else{if(i==2){_photoUpLoadWraper.userDef3Url=this.__imgsSrcUrl[i]||""}else{if(i==3){_photoUpLoadWraper.murl=this.__imgsSrcUrl[i]||""}else{if(i==4){_photoUpLoadWraper.surl=this.__imgsSrcUrl[i]||""}else{if(i==5){_photoUpLoadWraper.turl=this.__imgsSrcUrl[i]||""}}}}}}}this.__pcache._$copyPhoto(_photoUpLoadWraper)}else{this.__onUpload()}};__proModuleC.__cbPhotoCopy=function(_succ){if(!_succ){mb.x.alert("图片保存失败，请稍后再试！");return}var _img=this.__imgsSrc.join("<br/>");this.__type==1?this.__onBlogDraft(_img):this.__onBlogPost(_img)};__proModuleC.__cbBlogPost=function(_isok){if(!_isok){this.__postBtn.disabled=false;mb.x.alert("暂时无法发表日志，请稍后再试！");return}this.__clear();if((location.hash!="#m=1&t=0")&&(location.hash.indexOf("m=3")<0)){this._$dispatchEvent("onredirect","m=3&t=0",true)}};__proModuleC.__cbBlogDraft=function(_isok){if(!_isok){this.__postBtn.disabled=false;mb.x.alert("暂时无法保存草稿，请稍后再试！");return}this.__clear();this._$dispatchEvent("onredirect","m=1&t=0")};__proModuleC.__onBeforeExit=function(_options){if(_options.m==1&&(_options.t==4||_options.t==5)){return true}if(!this.__txt||!!this.__uploading){return true}mb.x.confirm("日志未发布，确定要离开？",this.__onConfirmExit._$bind(this));return false};__proModuleC.__onConfirmExit=function(_result){if(_result=="true"){this.__clear();this._$dispatchEvent("onredirect","m=3&t=0",true)}};p._$$ModuleD=MWF.C();__proModuleD=p._$$ModuleD._$extend(t._$$Module,true);__supModuleD=p._$$ModuleD._$supro;__proModuleD._$getId=function(){return"1-3"};__proModuleD._$show=function(_options){__supModuleD._$show.apply(this,arguments);this.__src=unescape(_options.src);this.__deg=_options.deg};__proModuleD.__getXhtml=function(){return e._$getHtmlTemplate("m1-jst-3",{tag:this.__tkey})};__proModuleD.__buildModule=function(){__supModuleD.__buildModule.apply(this,arguments);this.__cache=new d._$$CachePhoto();this.__cache._$addEvent("onalbumload",this.__cbLoadAlbum._$bind(this));window.x.m1t3=window.x.m1t3||{};window.x.m1t3.onPhotoAlbumSelect=this.__onPhotoAlbumSelect._$bind(this);var _list=e._$getByClassName(this.__body,this.__tkey);this.__desc=_list[0];v._$addEvent(_list[1],"click",this.__onPhotoUpload._$bind(this))};__proModuleD.__onPhotoUpload=function(){if(!this.__desc.value){mb.x.alert("请输入相片描述！");return}this.__cache._$getAlbumListAll(d._$VISITOR.userName)};__proModuleD.__cbLoadAlbum=function(){var _list=this.__cache._$getAlbumListInCache(d._$VISITOR.userName),_strArr=[];for(var i=0;i<_list.length;i++){_strArr.push('{"title":"'+_list[i].name+'","action":"window.x.m1t3.onPhotoAlbumSelect(\''+_list[i].id+"')\"}")}u.PopUpMenu("选择相册","["+_strArr.join(",")+"]")};__proModuleD.__onPhotoAlbumSelect=function(_albumId){this.__cache._$addPhoto({deg:this.__deg,file:this.__src,desc:this.__desc.value,album:_albumId});location.href="#m=1&t=0&s=1"};__proModuleD.__cbAddPhoto=function(_state){if(_state==-1){mb.x.alert("相片上传失败，请稍后再试！");return}if(_state==-2){mb.x.alert("暂时无法更新相片的编辑信息！");return}this._$dispatchEvent("onredirect","m=3&t=2&k=1&pid="+_state)};p._$$ModuleE=MWF.C();__proModuleE=p._$$ModuleE._$extend(t._$$Module,true);__supModuleE=p._$$ModuleE._$supro;__proModuleE._$getId=function(){return"1-4"};__proModuleE._$show=function(_options){__supModuleE._$show.apply(this,arguments);this.__src=this.__img.src=unescape(_options.src);this.__deg=0;this.__img.style.maxWidth=document.body.scrollWidth+"px";this.__img.style.maxHeight=(document.body.scrollHeight-50)+"px";p.rtt=this.__onRotate._$bind2(this)};__proModuleE.__getXhtml=function(){return e._$getHtmlTemplate("m1-jst-4",{tag:this.__tkey})};__proModuleE.__buildModule=function(){__supModuleE.__buildModule.apply(this,arguments);var _list=e._$getByClassName(this.__body,this.__tkey);this.__img=_list[0];v._$addEvent(_list[1],"click",this.__goWrite._$bind(this));window.x.m1t4=window.x.m1t4||{};window.x.m1t4.onPhotoRotateClockwise=this.__onPhotoRotate._$bind(this,1);window.x.m1t4.onPhotoRotateAntiClockwise=this.__onPhotoRotate._$bind(this,-1);this.__rotateWithDeg(0)};__proModuleE.__onRotate=function(){u.PopUpMenu("旋转",'[{"title":"顺时针旋转90度","action":"window.x.m1t4.onPhotoRotateClockwise()"}                 ,{"title":"逆时针旋转90度","action":"window.x.m1t4.onPhotoRotateAntiClockwise()"}]')};__proModuleE.__onPhotoRotate=function(_flag){this.__rotateWithDeg(this.__deg+_flag*90)};__proModuleE.__rotateWithDeg=function(_deg,_duration){this.__deg=_deg;this.__img.style.webkitTransform="rotate("+this.__deg+"deg)"};__proModuleE.__goWrite=function(){location.hash="#m=1&t=2&src="+escape(this.__src)};p._$$ModuleF=MWF.C();__proModuleF=p._$$ModuleF._$extend(t._$$Module,true);__supModuleF=p._$$ModuleF._$supro;__proModuleF._$getId=function(){return"1-5"};__proModuleF.__getXhtml=function(){return e._$getHtmlTemplate("m1-jst-5",{tag:this.__tkey})};__proModuleF._$show=function(){__supModuleF._$show.apply(this,arguments);this.__content.value=this.__cache._$getTextFromCache()||"";this.__content.focus()};__proModuleF.__buildModule=function(){__supModuleF.__buildModule.apply(this,arguments);var _list=e._$getByClassName(this.__body,this.__tkey);this.__content=_list[0];this.__cache=new d._$$CacheBlog();e._$mbfocus(this.__content);v._$addEvent(_list[1],"click",this.__write._$bind(this))};__proModuleF.__write=function(){this.__cache._$writeTextToCache(this.__content.value);this._$dispatchEvent("onredirect","#m=1&t=2",true)}})(MWF.O,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mwf.j"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.x"),MWF.P("mb.m"),MWF.P("mb.m.m1"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m1"));(function(t,p){var __proConfiguration,__proConfigurationMA,__proConfigurationMB,__proConfigurationMC,__proConfigurationMD,__proConfigurationME,__proConfigurationMF,__proConfigurationMG,__proConfigurationMH,__proConfigurationMI;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationMA=MWF.C();__proConfigurationMA=p._$$ConfigurationMA._$extend(t._$$Configuration,true);__proConfigurationMA.__getModule=function(){return p._$$ModuleA._$allocate(this.__mopt)};p._$$ConfigurationMB=MWF.C();__proConfigurationMB=p._$$ConfigurationMB._$extend(t._$$Configuration,true);__proConfigurationMB.__getModule=function(){return p._$$ModuleB._$allocate(this.__mopt)};p._$$ConfigurationMC=MWF.C();__proConfigurationMC=p._$$ConfigurationMC._$extend(t._$$Configuration,true);__proConfigurationMC.__getModule=function(){return p._$$ModuleC._$allocate(this.__mopt)};p._$$ConfigurationMD=MWF.C();__proConfigurationMD=p._$$ConfigurationMD._$extend(t._$$Configuration,true);__proConfigurationMD.__getModule=function(){return p._$$ModuleD._$allocate(this.__mopt)};p._$$ConfigurationME=MWF.C();__proConfigurationME=p._$$ConfigurationME._$extend(t._$$Configuration,true);__proConfigurationME.__getModule=function(){return p._$$ModuleE._$allocate(this.__mopt)};p._$$ConfigurationMF=MWF.C();__proConfigurationMF=p._$$ConfigurationMF._$extend(t._$$Configuration,true);__proConfigurationMF.__getModule=function(){return p._$$ModuleF._$allocate(this.__mopt)};p._$$ConfigurationMG=MWF.C();__proConfigurationMG=p._$$ConfigurationMG._$extend(t._$$Configuration,true);__proConfigurationMG.__getModule=function(){return p._$$ModuleG._$allocate(this.__mopt)};p._$$ConfigurationMH=MWF.C();__proConfigurationMH=p._$$ConfigurationMH._$extend(t._$$Configuration,true);__proConfigurationMH.__getModule=function(){return p._$$ModuleH._$allocate(this.__mopt)};p._$$ConfigurationMI=MWF.C();__proConfigurationMI=p._$$ConfigurationMI._$extend(t._$$Configuration,true);__proConfigurationMI.__getModule=function(){return p._$$ModuleI._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m2"));(function(o,e,v,x,w,d,t,p){var __proModule,__supModule,__proModuleA,__supModuleA,__proModuleB,__supModuleB,__proModuleC,__supModuleC,__proModuleD,__supModuleD,__proModuleE,__supModuleE,__proModuleF,__supModuleF,__proModuleG,__supModuleG,__proModuleH,__supModuleH,__proModuleI,__supModuleI;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"2"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationMA,1:p._$$ConfigurationMB,2:p._$$ConfigurationMC,3:p._$$ConfigurationMD,4:p._$$ConfigurationME,5:p._$$ConfigurationMF,6:p._$$ConfigurationMG,7:p._$$ConfigurationMH,8:p._$$ConfigurationMI},onerror:this._$dispatchEvent._$bind(this,"onredirect","#m=2&t=0",true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleA=MWF.C();__proModuleA=p._$$ModuleA._$extend(t._$$Module,true);__supModuleA=p._$$ModuleA._$supro;__proModuleA._$getId=function(){return"2-0"};__proModuleA.__getXhtml=function(){return e._$getHtmlTemplate("m2-jst-0",{tag:this.__tkey})};__proModuleA.__buildModule=function(){__supModuleA.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__list=e._$getByClassName(this.__body,this.__tkey);this.__cache._$addMsgListener(this.__cbLoadMsgCount._$bind(this));this._list=e._$getByClassName(this.__body,"msgcentertag");e._$mbhover(this._list[0],"js-click",function(e){return e.tagName=="A"})};__proModuleA._$show=function(){__supModuleP._$show.apply(this,arguments);mb.x.loadFinish()};__proModuleA.__cbLoadMsgCount=(function(){var _type=["userMsgNewCount","alertMsgNewCount","comMsgNewCount","comReplyMsgNewCount","noteMsgNewCount"];return function(){var _data=this.__cache._$getMessageInCache();if(!_data){return}for(var i=0,l=_type.length,_count;i<l;i++){_count=_data[_type[i]]||0;this.__list[i].innerText=!_count?"":("("+_count+")");if(_count>0){this.__cache._$deleteMsgListInCache(_type[i])}}}})();p._$$ModuleB=MWF.C();__proModuleB=p._$$ModuleB._$extend(t._$$Module,true);__supModuleB=p._$$ModuleB._$supro;__proModuleB._$getId=function(){return"2-1"};__proModuleB.__getXhtml=function(){return e._$getHtmlTemplate("m2-jst-1",{tag:this.__tkey})};__proModuleB.__buildModule=function(){__supModuleB.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("onusrmsgload",this.__cbLoadMessage._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__mmsg=new w._$$SimpleList({jst:"m2-jst-1a",box:_list[0],btn:_list[1],empty:"没有消息！",onnext:this.__onLoadMessage._$bind(this)});e._$mbhover(_list[0],"js-click",function(e){return e.tagName=="DIV"&&e.className=="itm"});this.__bst=0;this.__dst=0};__proModuleB._$show=function(){__supModuleB._$show.apply(this,arguments);if(this.__referrer.indexOf("m=2")>=0&&this.__referrer.indexOf("t=7")>=0){mb.x.scrollTop(this.__bst,this.__dst)}else{this.__refreshModule()}};__proModuleB.__refreshModule=function(){mb.x.top();this.__mmsg._$refresh()};__proModuleB.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleB.__onLoadMessage=function(_offset,_limit){this.__cache._$getUsrMsgList(_offset,_limit)};__proModuleB.__cbLoadMessage=function(_offset,_limit){this.__mmsg._$append(this.__cache._$getUsrMsgListInCache())};__proModuleB.__onDeleteMessage=function(_event,_id){this.__cache._$deleteUsrMsg(_id)};p._$$ModuleC=MWF.C();__proModuleC=p._$$ModuleC._$extend(t._$$Module,true);__supModuleC=p._$$ModuleC._$supro;__proModuleC._$getId=function(){return"2-2"};__proModuleC.__getXhtml=function(){return e._$getHtmlTemplate("m2-jst-2",{tag:this.__tkey})};__proModuleC.__buildModule=function(){__supModuleC.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("onsysmsgload",this.__cbLoadMessage._$bind(this));this.__cache._$addEvent("onhandlefrdinvt",this.__cbHandleFriendinvitation._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__mmsg=new w._$$SimpleList({jst:"m2-jst-2a",box:_list[0],btn:_list[1],empty:"没有消息！",onnext:this.__onLoadMessage._$bind(this)});v._$addEvent(_list[0],"click",this.__onItemClick._$bind(this));e._$mbhover(_list[0],"js-click",function(e){return e.tagName=="DIV"&&e.className=="itm"})};__proModuleC.__onItemClick=function(_event){this.__element=v._$getElement(_event,function(e){return !!e.className&&e.className.indexOf("frd-acct-btn")>=0});if(!!this.__element){v._$stop(_event);this.__cache._$acceptFriend((this.__element.parentNode||o).children[2].value,(this.__element.parentNode||o).children[3].value)}else{this.__element=v._$getElement(_event,function(e){return !!e.className&&e.className.indexOf("frd-rejt-btn")>=0});if(!!this.__element){v._$stop(_event);this.__cache._$rejectFriend((this.__element.parentNode||o).children[2].value,(this.__element.parentNode||o).children[3].value)}}};__proModuleC._$show=function(){__supModuleC._$show.apply(this,arguments);this.__refreshModule()};__proModuleC.__refreshModule=function(){this.__mmsg._$refresh()};__proModuleC.__onLoadMessage=function(_offset,_limit){this.__cache._$getSysMsgList(_offset,_limit)};__proModuleC.__cbLoadMessage=function(_offset,_limit){this.__mmsg._$append(this.__cache._$getSysMsgListInCache())};__proModuleC.__cbHandleFriendinvitation=function(_result,_code){var _action="忽略";var _className="w-disallow";if(_code==102){_action="接受";var _className="w-allow"}if(!!_result){var __parentNode=(this.__element.parentNode||o).parentNode;if(!!__parentNode){e._$remove(this.__element.parentNode,false);(e._$create("span","other "+_className,__parentNode.children[0])||o).innerText="已"+_action;mb.x.alert(_action+"博友邀请成功！")}}else{mb.x.alert(_action+"博友邀请失败！")}};__proModuleC.__onDeleteMessage=function(_event,_id){this.__cache._$deleteSysMsg(_id)};p._$$ModuleD=MWF.C();__proModuleD=p._$$ModuleD._$extend(t._$$Module,true);__supModuleD=p._$$ModuleD._$supro;__proModuleD._$getId=function(){return"2-3"};__proModuleD.__getXhtml=function(){return e._$getHtmlTemplate("m2-jst-3",{tag:this.__tkey})};__proModuleD.__buildModule=function(){__supModuleD.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("oncommentmsgload",this.__cbLoadMessage._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__mmsg=new w._$$SimpleList({jst:"m2-jst-3a",box:_list[0],btn:_list[1],empty:"没有消息！",onnext:this.__onLoadMessage._$bind(this)});e._$mbhover(_list[0],"js-click",function(e){return e.tagName=="DIV"&&e.className=="itm"});this.__bst=0;this.__dst=0};__proModuleD._$show=function(){__supModuleD._$show.apply(this,arguments);if((this.__referrer.indexOf("m=6")>=0&&this.__referrer.indexOf("t=0")>=0)||this.__referrer.indexOf("m=9")>=0){mb.x.scrollTop(this.__bst,this.__dst)}else{this.__refreshModule()}};__proModuleD.__refreshModule=function(){mb.x.top();this.__mmsg._$refresh()};__proModuleD.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleD.__onLoadMessage=function(_offset,_limit){this.__cache._$getCmtMsgList(_offset,_limit)};__proModuleD.__cbLoadMessage=function(_offset,_limit){this.__mmsg._$append(this.__cache._$getCmtMsgListInCache())};__proModuleD.__onDeleteMessage=function(_event,_id){this.__cache._$deleteCommentMsg(_id)};p._$$ModuleE=MWF.C();__proModuleE=p._$$ModuleE._$extend(t._$$Module,true);__supModuleE=p._$$ModuleE._$supro;__proModuleE._$getId=function(){return"2-4"};__proModuleE.__getXhtml=function(){return e._$getHtmlTemplate("m2-jst-4",{tag:this.__tkey})};__proModuleE.__buildModule=function(){__supModuleE.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("oncommentreplymsgload",this.__cbLoadMessage._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__mmsg=new w._$$SimpleList({jst:"m2-jst-4a",box:_list[0],btn:_list[1],empty:"没有消息！",onnext:this.__onLoadMessage._$bind(this)});e._$mbhover(_list[0],"js-click",function(e){return e.tagName=="DIV"&&e.className=="itm"});this.__bst=0;this.__dst=0};__proModuleE._$show=function(){__supModuleE._$show.apply(this,arguments);if((this.__referrer.indexOf("m=6")>=0&&this.__referrer.indexOf("t=0")>=0)||this.__referrer.indexOf("m=9")>=0){mb.x.scrollTop(this.__bst,this.__dst)}else{this.__refreshModule()}};__proModuleE.__refreshModule=function(){mb.x.top();this.__mmsg._$refresh()};__proModuleE.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleE.__onLoadMessage=function(_offset,_limit){this.__cache._$getReplyMsgList(_offset,_limit)};__proModuleE.__cbLoadMessage=function(_offset,_limit){this.__mmsg._$append(this.__cache._$getReplyMsgListInCache())};__proModuleE.__onDeleteMessage=function(_event,_id){this.__cache._$deleteCommentReplyMsg(_id)};p._$$ModuleF=MWF.C();__proModuleF=p._$$ModuleF._$extend(t._$$Module,true);__supModuleF=p._$$ModuleF._$supro;__proModuleF._$getId=function(){return"2-5"};__proModuleF.__getXhtml=function(){return e._$getHtmlTemplate("m2-jst-5",{tag:this.__tkey})};__proModuleF.__buildModule=function(){__supModuleF.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("onnotemsgload",this.__cbLoadMessage._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__mmsg=new w._$$SimpleList({jst:"m2-jst-5a",box:_list[0],btn:_list[1],empty:"没有消息！",onnext:this.__onLoadMessage._$bind(this)});e._$mbhover(_list[0],"js-click",function(e){return e.tagName=="DIV"&&e.className=="itm"});this.__bst=0;this.__dst=0};__proModuleF._$show=function(){__supModuleF._$show.apply(this,arguments);if(this.__referrer.indexOf("m=2")>=0&&this.__referrer.indexOf("t=8")>=0){mb.x.scrollTop(this.__bst,this.__dst)}else{this.__refreshModule()}};__proModuleF.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleF.__refreshModule=function(){mb.x.top();this.__mmsg._$refresh()};__proModuleF.__onLoadMessage=function(_offset,_limit){this.__cache._$getNoteMsgList(_offset,_limit)};__proModuleF.__cbLoadMessage=function(_offset,_limit){this.__mmsg._$append(this.__cache._$getNoteMsgListInCache())};__proModuleF.__onDeleteMessage=function(_event,_id){this.__cache._$deleteNoteMsg(_id)};p._$$ModuleG=MWF.C();__proModuleG=p._$$ModuleG._$extend(t._$$Module,true);__supModuleG=p._$$ModuleG._$supro;__proModuleG._$getId=function(){return"2-6"};__proModuleG.__getXhtml=function(){return e._$getHtmlTemplate("m2-jst-6",{tag:this.__tkey})};__proModuleG.__buildModule=function(){__supModuleG.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("onusrsentmsgload",this.__cbLoadMessage._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__mmsg=new w._$$SimpleList({jst:"m2-jst-6a",box:_list[0],btn:_list[1],empty:"没有消息！",onnext:this.__onLoadMessage._$bind(this)});e._$mbhover(_list[0],"js-click",function(e){return e.tagName=="A"})};__proModuleG._$show=function(){__supModuleG._$show.apply(this,arguments);this.__refreshModule()};__proModuleG.__refreshModule=function(){this.__mmsg._$refresh()};__proModuleG.__onLoadMessage=function(_offset,_limit){this.__cache._$getUsrSentMsgList(_offset,_limit)};__proModuleG.__cbLoadMessage=function(_offset,_limit){this.__mmsg._$append(this.__cache._$getUsrSentMsgListInCache())};p._$$ModuleH=MWF.C();__proModuleH=p._$$ModuleH._$extend(t._$$Module,true);__supModuleH=p._$$ModuleH._$supro;__proModuleH._$getId=function(){return"2-7"};__proModuleH.__getXhtml=function(){return e._$getHtmlTemplate("m2-jst-7",{tag:this.__tkey})};__proModuleH.__buildModule=function(){__supModuleH.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("onReplyMsg",this.__cbReplyMsg._$bind(this));this.__list=e._$getByClassName(this.__body,this.__tkey);this.__content=this.__list[0];this.__btn=this.__list[1];v._$addEvent(this.__content,"input",this.__onContentInput._$bind(this));v._$addEvent(this.__btn,"click",this.__onReplyMsg._$bind(this));e._$mbfocus(this.__content)};__proModuleH.__onContentInput=function(_event){if(this.__content.value==""){e._$addClassName(this.__btn,"s-fc1");this.__btn.disabled=true}else{e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=false}};__proModuleH._$show=function(_options){this.__msgId=_options.mid;this.__resetModule();__supModuleH._$show.apply(this,arguments);window.setTimeout(function(){this.__content.focus()}._$bind(this),100)};__proModuleH.__resetModule=function(){this.__content.value="";e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=true};__proModuleH.__onReplyMsg=function(){e._$addClassName(this.__btn,"s-fc1");this.__btn.disabled=true;if(!this.__content.value){mb.x.alert("请输入回复内容！");this.__content.focus();return}this.__cache._$replyMsg(this.__msgId,this.__content.value)};__proModuleH.__cbReplyMsg=function(_code){if(_code==1){mb.x.alert("回复消息成功！");this._$dispatchEvent("onredirect","m=2&t=1")}else{if(_code==-5){mb.x.alert("没有回复此消息的权限！");this._$dispatchEvent("onredirect","m=2&t=1")}else{mb.x.alert("回复消息失败！")}}e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=false};p._$$ModuleI=MWF.C();__proModuleI=p._$$ModuleI._$extend(t._$$Module,true);__supModuleI=p._$$ModuleI._$supro;__proModuleI._$getId=function(){return"2-8"};__proModuleI.__getXhtml=function(){return e._$getHtmlTemplate("m2-jst-7",{tag:this.__tkey})};__proModuleI.__buildModule=function(){__supModuleI.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("oncbreplynote",this.__cbReplyNote._$bind(this));this.__list=e._$getByClassName(this.__body,this.__tkey);this.__content=this.__list[0];this.__btn=this.__list[1];e._$mbfocus(this.__content);v._$addEvent(this.__content,"input",this.__onContentInput._$bind(this));v._$addEvent(this.__btn,"click",this.__onReplyNote._$bind(this))};__proModuleI.__onContentInput=function(_event){if(this.__content.value==""){e._$addClassName(this.__btn,"s-fc1");this.__btn.disabled=true}else{e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=false}};__proModuleI._$show=function(_options){__supModuleI._$show.apply(this,arguments);this.__noteId=_options.nid;this.__publisherId=_options.nuid;this.__resetModule();window.setTimeout(function(){this.__content.focus()}._$bind(this),100)};__proModuleI.__resetModule=function(){this.__content.value="";e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=true};__proModuleI.__onReplyNote=function(){e._$addClassName(this.__btn,"s-fc1");this.__btn.disabled=true;if(!this.__content.value){mb.x.alert("请输入回复内容！");this.__content.focus();return}this.__cache._$replyNote(this.__noteId,this.__publisherId,this.__content.value)};__proModuleI.__cbReplyNote=function(_code){if(_code==1){mb.x.alert("回复留言成功！");this._$dispatchEvent("onredirect","m=2&t=5")}else{if(_code==-5){mb.x.alert("没有权限回复此留言！");this._$dispatchEvent("onredirect","m=2&t=5")}else{mb.x.alert("回复留言失败！")}}e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=false}})(MWF.O,MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.x"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mb.m.m2"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true);__proValidator._$validate=function(_options){if(!this.__isLogin()){this._$dispatchEvent("onredirect","#m=0",true)}else{this._$dispatchEvent("onpass",_options)}}})(MWF.P("mb.m"),MWF.P("mb.m.m2"));(function(t,p){var __proConfiguration,__proConfigurationMA,__proConfigurationMB,__proConfigurationMC,__proConfigurationMD;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationMA=MWF.C();__proConfigurationMA=p._$$ConfigurationMA._$extend(t._$$Configuration,true);__proConfigurationMA.__getModule=function(){return p._$$ModuleA._$allocate(this.__mopt)};p._$$ConfigurationMB=MWF.C();__proConfigurationMB=p._$$ConfigurationMB._$extend(t._$$Configuration,true);__proConfigurationMB.__getModule=function(){return p._$$ModuleB._$allocate(this.__mopt)};p._$$ConfigurationMC=MWF.C();__proConfigurationMC=p._$$ConfigurationMC._$extend(t._$$Configuration,true);__proConfigurationMC.__getModule=function(){return p._$$ModuleC._$allocate(this.__mopt)};p._$$ConfigurationMD=MWF.C();__proConfigurationMD=p._$$ConfigurationMD._$extend(t._$$Configuration,true);__proConfigurationMD.__getModule=function(){return p._$$ModuleD._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m3"));(function(o,f,u,e,v,x,w,d,t,p){var __proModule,__supModule,__proModuleA,__supModuleA,__proModuleB,__supModuleB,__proModuleC,__supModuleC,__proModuleD,__supModuleD;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"3"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationMA,1:p._$$ConfigurationMB,2:p._$$ConfigurationMC,3:p._$$ConfigurationMD},onerror:this._$dispatchEvent._$bind(this,"onredirect","m=3&t=0",true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleP=MWF.C();__proModuleP=p._$$ModuleP._$extend(t._$$Module,true);__supModuleP=p._$$ModuleP._$supro;__proModuleP.__hasTopbar=function(){return true};__proModuleP._$show=function(_options){this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}window.x.m3.addfollow=this.__onAddFollow._$bind(this);window.x.m3.cancelfollow=this.__onCancelFollow._$bind(this);window.x.m3.deletefriend=this.__onDeleteFriend._$bind(this);this.__refreshP();__supModuleP._$show.apply(this,arguments)};__proModuleP.__buildModule=function(){this.__uname=x._$getHostName();__supModuleP.__buildModule.apply(this,arguments);this.__pcnt=document.createElement("div");var _mbox=this.__body.lastElementChild;_mbox.insertAdjacentElement("afterBegin",this.__pcnt);this.__ucache=new d._$$CacheUser();this.__ucache._$addEvent("onuserload",this.__onUserLoad._$bind(this));this.__ucache._$addEvent("onaddfollow",this.__cbAddFollow._$bind(this));this.__ucache._$addEvent("oncancelfollow",this.__cbCancelFollow._$bind(this));this.__fcache=new d._$$CacheFriend();this.__fcache._$addEvent("ondeletefriend",this.__cbDeleteFriend._$bind(this));window.x.m3=window.x.m3||{};window.x.m3.ongo=this.__onGo._$bind(null)};__proModuleP.__refreshP=function(){this.__pcnt.innerHTML="";this.__ucache._$getUserInfo(mb.x._$getHostName())};__proModuleP.__onUserLoad=function(_user,_data){if(!!_user){this.__refreshTop(_data)}};__proModuleP.__refreshTop=function(_user){this.__user=_user;var _index=this._$getId().split("-")[1]||"";this.__pcnt.innerHTML=e._$getHtmlTemplate("m3-jst-a",{idx:_index,isEdit:!this.__uname,user:_user});var _list=this.__pcnt.children[1].getElementsByTagName("a");for(var i=0,l=_list.length;i<l;i++){v._$addEvent(_list[i],"tap",(function(_index){return function(){var _url=_list[_index].href;location.hash=_url.substr(_url.indexOf("#"))}})(i))}v._$addEvent(this.__pcnt.children[0].children[2],"tap",this.__onAction._$bind(this))};__proModuleP.__onAction=function(){var _arr=[];if(!!this.__uname){_arr.push('{"title":"查看个人资料","action":"window.x.m3.ongo(\'#m=12&uname='+this.__uname+"')\"}");_arr.push('{"title":"查看留言", "action":"window.x.m3.ongo(\'#m=14&t=0&uname='+this.__uname+"')\"}")}else{_arr.push('{"title":"查看个人资料","action":"window.x.m3.ongo(\'#m=12\')"}');_arr.push('{"title":"查看留言", "action":"window.x.m3.ongo(\'#m=14&t=0\')"}')}if(!!this.__uname){_arr.push('{"title":"发消息","action":"window.x.m3.ongo(\'#m=13&t=0&recuid='+this.__user.userId+"')\"}");if(this.__user.friendStatus=="friend"){_arr.push('{"title":"取消博友","action":"window.x.m3.deletefriend(\''+this.__uname+"')\"}")}else{if(this.__user.friendStatus=="inviting"){if(this.__user.followStatus=="follow"){_arr.push('{"title":"取消关注","action":"window.x.m3.cancelfollow(\''+this.__uname+"')\"}")}else{_arr.push('{"title":"加关注","action":"window.x.m3.addfollow()"}')}}else{if(this.__user.followStatus=="follow"){_arr.push('{"title":"取消关注","action":"window.x.m3.cancelfollow(\''+this.__uname+"')\"}")}else{_arr.push('{"title":"加关注","action":"window.x.m3.addfollow()"}')}_arr.push('{"title":"加博友","action":"window.x.m3.ongo(\'#m=13&t=1&uname='+this.__uname+"')\"}")}}}u.PopUpMenu(this.__user.nickName||this.__user.userName,"["+_arr.reverse().join(",")+"]")};__proModuleP.__onAddFollow=function(){this.__ucache._$addFollow(this.__uname)};__proModuleP.__cbAddFollow=function(_data){if(!!_data&&!!_data.resultData){if(_data.resultData.result==1){x.alert("关注成功");this.__refreshP();return}else{if(_data.resultData.result==2){x.alert("关注成功");this.__refreshP();return}else{if(_data.resultData.result==-1){x.alert("关注失败！");return}}}}else{x.alert("关注失败")}return};__proModuleP.__onCancelFollow=function(_uname){this.__ucache._$cancelFollow(_uname)};__proModuleP.__cbCancelFollow=function(_data){if(!!_data&&!!_data.resultData){if(_data.resultData.result==1){x.alert("取消关注成功");this.__refreshP();return}else{if(_data.resultData.result==2){x.alert("取消关注成功！");this.__refreshP();return}else{if(_data.resultData.result==-1){x.alert("取消关注失败！");return}}}}else{x.alert("取消关注失败")}return};__proModuleP.__onDeleteFriend=function(_uname){this.__fcache._$delFriend(_uname)};__proModuleP.__cbDeleteFriend=function(_data){if(!!_data&&!!_data.resultData){if(_data.resultData.result==1){this.__ucache._$clearUserCache(this.__uname);this.__ucache._$clearUserFriendCache();x.alert("取消博友成功");this.__refreshP();return}else{x.alert("取消博友失败！");return}}else{x.alert("取消博友失败")}return};__proModuleP._$hide=function(){__supModuleP._$hide.apply(this,arguments);this.__pcnt.innerHTML=""};p._$$ModuleA=MWF.C();__proModuleA=p._$$ModuleA._$extend(p._$$ModuleP,true);__supModuleA=p._$$ModuleA._$supro;__proModuleA._$getId=function(){return"3-0"};__proModuleA.__buildModule=function(){__supModuleA.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheBlog();this.__cache._$addEvent("onblogload",this.__cbLoadBlog._$bind(this));this.__list=e._$getByClassName(this.__body,this.__tkey);this.__mblog=new w._$$SimpleList({jst:"m3-jst-0a",box:this.__list[0],btn:this.__list[1],ext:{uname:this.__uname||d._$VISITOR.userName},empty:"没有日志数据！",onnext:this.__onLoadBlog._$bind(this)});e._$mbhover(this.__list[0],"js-click",function(e){return e.tagName=="A"});this.__bst=0;this.__dst=0};__proModuleA.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleA._$show=function(_options,_refresh){__supModuleA._$show.apply(this,arguments);this.__r=_options.r||"f";if(this.__referrer.indexOf("m=6")>=0&&(this.__r=="f")&&!_refresh){mb.x.scrollTop(this.__bst,this.__dst)}else{this.__refreshModule()}};__proModuleA.__refreshModule=function(){mb.x.top();this.__mblog._$refresh(null,{ext:{uname:this.__uname||d._$VISITOR.userName}})};__proModuleA.__getXhtml=function(){return e._$getHtmlTemplate("m3-jst-0",{tag:this.__tkey})};__proModuleA.__onBeforeShow=function(){this.__referrer.indexOf("m=3")<0?this.__pbody=this.__body:this.__pbody=this.__body.lastElementChild.lastElementChild;__supModuleA.__onBeforeShow.apply(this,arguments)};__proModuleA.__onLoadBlog=function(_offset,_limit,_tid){this.__cache._$getBlogList(_tid||0,_offset,_limit,this.__uname||d._$VISITOR.userName)};__proModuleA.__cbLoadBlog=function(_tid,_offset,_limit){this.__mblog._$append(this.__cache._$getBlogListInCache(_tid,this.__uname||d._$VISITOR.userName))};p._$$ModuleB=MWF.C();__proModuleB=p._$$ModuleB._$extend(p._$$ModuleP,true);__supModuleB=p._$$ModuleB._$supro;__proModuleB._$getId=function(){return"3-1"};__proModuleB.__buildModule=function(){__supModuleB.__buildModule.apply(this,arguments);this.__cache=new d._$$CachePhoto();this.__cache._$addEvent("onalbumload",this.__cbLoadAlbum._$bind(this));this.__list=e._$getByClassName(this.__body,this.__tkey);this.__malbum=new w._$$SimpleList({jst:"m3-jst-1a",box:this.__list[0],btn:this.__list[1],empty:"没有相册数据！",onnext:this.__onLoadAlbum._$bind(this)});e._$mbhover(this.__list[0],"js-click",function(e){return e.tagName=="A"});this.__bst=0;this.__dst=0};__proModuleB.__refreshModule=function(){mb.x.top();this.__malbum._$refresh(null,{ext:{uname:this.__uname||d._$VISITOR.userName}})};__proModuleB.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleB._$show=function(_options,_refresh){__supModuleB._$show.apply(this,arguments);this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}if(this.__referrer.indexOf("m=11")>=0&&!_refresh&&(_options.r||"")!="t"){mb.x.scrollTop(this.__bst,this.__dst)}else{this.__refreshModule()}};__proModuleB.__getXhtml=function(){return e._$getHtmlTemplate("m3-jst-1",{tag:this.__tkey,user:d._$VISITOR||o})};__proModuleB.__onLoadAlbum=function(_offset,_limit){this.__cache._$getAlbumList(_offset,_limit,this.__uname||d._$VISITOR.userName)};__proModuleB.__cbLoadAlbum=function(){this.__malbum._$append(this.__cache._$getAlbumListInCache(this.__uname||d._$VISITOR.userName))};p._$$ModuleC=MWF.C();__proModuleC=p._$$ModuleC._$extend(p._$$ModuleP,true);__supModuleC=p._$$ModuleC._$supro;__proModuleC._$getId=function(){return"3-2"};__proModuleC.__buildModule=function(){__supModuleC.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMood();this.__cache._$addEvent("onmoodload",this.__cbLoadMood._$bind(this));this.__list=e._$getByClassName(this.__body,this.__tkey);this.__mmood=new w._$$SimpleList({jst:"m3-jst-2a",box:this.__list[0],btn:this.__list[1],ext:{uname:this.__uname||d._$VISITOR.userName},empty:"没有心情数据！",onnext:this.__onLoadMood._$bind(this)});e._$mbhover(this.__list[0],"js-click",function(e){return e.tagName=="A"});this.__bst=0;this.__dst=0};__proModuleC._$show=function(_options,_refresh){__supModuleC._$show.apply(this,arguments);this.__r=_options.r||"f";if(this.__referrer.indexOf("m=9")>=0&&(this.__r=="f")&&!_refresh){mb.x.scrollTop(this.__bst,this.__dst)}else{this.__refreshModule()}};__proModuleC.__refreshModule=function(){mb.x.top();this.__mmood._$refresh(null,{ext:{uname:this.__uname||d._$VISITOR.userName}})};__proModuleC.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleC.__getXhtml=function(){return e._$getHtmlTemplate("m3-jst-2",{tag:this.__tkey})};__proModuleC.__onBeforeShow=function(){this.__referrer.indexOf("m=3")<0?this.__pbody=this.__body:this.__pbody=this.__body.lastElementChild.lastElementChild;__supModuleC.__onBeforeShow.apply(this,arguments)};__proModuleC.__onLoadMood=function(_offset,_limit){this.__cache._$getMoodList(_offset,_limit,this.__uname||d._$VISITOR.userName)};__proModuleC.__cbLoadMood=function(){this.__mmood._$append(this.__cache._$getMoodListInCache(this.__uname||d._$VISITOR.userName))};p._$$ModuleD=MWF.C();__proModuleD=p._$$ModuleD._$extend(p._$$ModuleP,true);__supModuleD=p._$$ModuleD._$supro;__proModuleD._$getId=function(){return"3-3"};__proModuleD.__getXhtml=function(){return e._$getHtmlTemplate("m3-jst-3",{tag:this.__tkey,uname:this.__uname||d._$VISITOR.userName})};__proModuleD.__buildModule=function(_options){__supModuleD.__buildModule.apply(this,arguments);var _list=e._$getByClassName(this.__body,this.__tkey);var _index=0;this.__contain=_list[_index++];this.__friendsCount_a=_list[_index++];this.__friendsCount=_list[_index++];this.__followCount_a=_list[_index++];this.__followCount=_list[_index++];this.__followedCount_a=_list[_index++];this.__followedCount=_list[_index++];this.__vistor_a=_list[_index++];this.__vistorwho_a=_list[_index++];this.__cache=new d._$$CacheUser();this.__cache._$addEvent("onblogfriendcountsload",this.__cbLoadBlogFriendCounts._$bind(this));e._$mbhover(this.__contain,"js-click",function(e){return e.tagName=="A"})};__proModuleD.__onBeforeShow=function(){__supModuleD.__onBeforeShow.apply(this,arguments);this.__friendsCount_a.href="#m=5&t=1&uname="+(this.__uname||d._$VISITOR.userName);this.__followCount_a.href="#m=5&t=3&uname="+(this.__uname||d._$VISITOR.userName);this.__followedCount_a.href="#m=5&t=4&uname="+(this.__uname||d._$VISITOR.userName);this.__vistor_a.href="#m=5&t=5&uname="+(this.__uname||d._$VISITOR.userName);this.__vistorwho_a.href="#m=5&t=6&uname="+(this.__uname||d._$VISITOR.userName)};__proModuleD._$show=function(_options){this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}if(!!this.__uname){this.__followCount_a.style.display="none";this.__followedCount_a.style.display="none";this.__vistorwho_a.style.display="none"}else{this.__followCount_a.style.display="";this.__followedCount_a.style.display="";this.__vistorwho_a.style.display=""}__supModuleD._$show.apply(this,arguments);this.__cache._$getBlogFriendCounts(this.__uname||d._$VISITOR.userName)};__proModuleD.__cbLoadBlogFriendCounts=function(){var _data=this.__cache._$getBlogFriendCountsInCache(this.__uname||d._$VISITOR.userName);if(!!_data&&!!_data.friendsCount){this.__friendsCount.innerText="("+_data.friendsCount+")";this.__followCount.innerText="("+_data.followCount+")";this.__followedCount.innerText="("+_data.followedCount+")"}else{this.__friendsCount.innerText="";this.__followCount.innerText="";this.__followedCount.innerText=""}}})(MWF.O,MWF.F,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.x"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mb.m.m3"));(function(t,d,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true);__proValidator.__init=function(){this.__super();this.__cache=new d._$$CacheUser();this.__cache._$addEvent("onuserload",this.__onuserload._$bind(this))};__proValidator.__onuserload=function(_uname,_data){if(!!_data&&!!_data.resultCode&&_data.resultCode!=200){this.__rejecthash="#m=15&t=1"}else{if(!!_uname&&!!_data&&_uname==(_data.userName||MWF.O)&&!!_data.isMultiUserBlog){this.__rejecthash="#m=15&t=0"}else{this.__rejecthash=null}}if(!!this.__rejecthash){var _hashManage=mb.m._$$HashManager._$getInstance();_hashManage._$pop()}};__proValidator._$validate=function(_options){if(!this.__isLogin()){this._$dispatchEvent("onredirect","#m=0",true);return}this.__cache._$getUserInfo(_options.uname||"");!!this.__rejecthash?this._$dispatchEvent("onredirect",this.__rejecthash,true):this._$dispatchEvent("onpass",_options)}})(MWF.P("mb.m"),MWF.P("mb.d"),MWF.P("mb.m.m3"));(function(t,p){var __proConfiguration,__proConfigurationMA,__proConfigurationMB,__proConfigurationMF,__proConfigurationMG,__proConfigurationMH;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationMA=MWF.C();__proConfigurationMA=p._$$ConfigurationMA._$extend(t._$$Configuration,true);__proConfigurationMA.__getModule=function(){return p._$$ModuleA._$allocate(this.__mopt)};p._$$ConfigurationMB=MWF.C();__proConfigurationMB=p._$$ConfigurationMB._$extend(t._$$Configuration,true);__proConfigurationMB.__getModule=function(){return p._$$ModuleB._$allocate(this.__mopt)};p._$$ConfigurationMF=MWF.C();__proConfigurationMF=p._$$ConfigurationMF._$extend(t._$$Configuration,true);__proConfigurationMF.__getModule=function(){return p._$$ModuleF._$allocate(this.__mopt)};p._$$ConfigurationMH=MWF.C();__proConfigurationMH=p._$$ConfigurationMH._$extend(t._$$Configuration,true);__proConfigurationMH.__getModule=function(){return p._$$ModuleH._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m4"));(function(e,v,j,w,d,x,t,p){var __proModule,__supModule,__proModuleA,__supModuleA,__proModuleB,__supModuleB,__proModuleF,__supModuleF,__proModuleG,__supModuleG,__proModuleH,__supModuleH;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"4"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationMA,1:p._$$ConfigurationMB,2:p._$$ConfigurationMC,3:p._$$ConfigurationMD,4:p._$$ConfigurationME,5:p._$$ConfigurationMF,6:p._$$ConfigurationMG,7:p._$$ConfigurationMH},onerror:this._$dispatchEvent._$bind(this,"onredirect","#m=4&t=0",true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleA=MWF.C();__proModuleA=p._$$ModuleA._$extend(t._$$Module,true);__supModuleA=p._$$ModuleA._$supro;__proModuleA._$getId=function(){return"4-0"};__proModuleA._$show=function(_options){this.__bcache._$getDraftCount();__supModuleA._$show.apply(this,arguments)};__proModuleA.__hasTopbar=function(){return true};__proModuleA.__getXhtml=function(){return e._$getHtmlTemplate("m4-jst-0",{tag:this.__tkey})};__proModuleA.__buildModule=function(){__supModuleA.__buildModule.apply(this,arguments);this.__bcache=new d._$$CacheBlog();this.__bcache._$addEvent("onblogdraftcountload",this.__cbLoadDraftCount._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__ndf=_list[1];p.lo=this.__onExit._$bind(this);v._$addEvent(_list[2],"click",this.__onChangeAccount._$bind(this));e._$mbhover(_list[0],"js-click",function(e){return e.tagName=="A"})};__proModuleA.__onChangeAccount=function(_event){v._$stop(_event);mb.x.confirm("是否确定注销？",this.__confirmCallback._$bind(this))};__proModuleA.__confirmCallback=function(_result){if("true"==_result){mb.m.m4.lo()}};__proModuleA.__cbLoadDraftCount=function(_count){this.__ndf.innerText=!_count?"":"("+_count+")"};__proModuleA.__cbLoadFollowCount=function(_count){this.__nfw.innerText=_count};__proModuleA.__cbLoadFollowedCount=function(_count){this.__nfd.innerText=_count};__proModuleA.__onExit=function(){delete mb.d._$VISITOR;delete mb.d._$PHOTOVISITOR;mwf.j._$setDataInStorage("autologin",0);mwf.j._$clearStorageExclude({login:1,autologin:0,remember:1});window.setTimeout((function(){location.href="#m=0"})._$bind(this),10)};p._$$ModuleB=MWF.C();__proModuleB=p._$$ModuleB._$extend(t._$$Module,true);__supModuleB=p._$$ModuleB._$supro;__proModuleB._$getId=function(){return"4-1"};__proModuleB.__buildModule=function(){__supModuleB.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheBlog();this.__cache._$addEvent("onblogdraftload",this.__cbLoadDraft._$bind(this));this.__cache._$addEvent("onblogdraftdelete",this.__cbDeleteDraft._$bind(this));this.__cache._$addEvent("onblogdraftcountload",this.__cbLoadDraftCount._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__ndf=_list[0];this.__mdraft=new w._$$SimpleList({jst:"m4-jst-1a",box:_list[1],btn:_list[2],empty:"没有草稿数据！",onnext:this.__onLoadDraft._$bind(this)});e._$mbhover(_list[1],"js-click",function(e){return e.tagName=="A"});this.__bst=0;this.__dst=0};__proModuleB.__cbLoadDraftCount=function(_count){this.__ndf.innerText=!_count?"0":"("+_count+")"};__proModuleB._$show=function(){this.__cache._$getDraftCount();__supModuleB._$show.apply(this,arguments);if(this.__referrer.indexOf("m=6")>=0){mb.x.scrollTop(this.__bst,this.__dst)}else{this.__refreshModule()}};__proModuleB.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleB.__refreshModule=function(){mb.x.top();this.__mdraft._$refresh()};__proModuleB.__getXhtml=function(){return e._$getHtmlTemplate("m4-jst-1",{tag:this.__tkey})};__proModuleB.__onLoadDraft=function(_offset,_limit){this.__cache._$getDraftList(_offset,_limit)};__proModuleB.__cbLoadDraft=function(_offset,_limit){this.__mdraft._$append(this.__cache._$getDraftListInCache())};__proModuleB.__cbDeleteDraft=function(_result){if(!!_result){this.__mdraft._$refresh()}};var __regClassName=/(\s|^)(?:js-ok)(?=\s|$)/;p._$$ModuleF=MWF.C();__proModuleF=p._$$ModuleF._$extend(t._$$Module,true);__supModuleF=p._$$ModuleF._$supro;__proModuleF._$getId=function(){return"4-5"};__proModuleF.__buildModule=function(){__supModuleF.__buildModule.apply(this,arguments);this.__nodes=e._$getByClassName(this.__body,this.__tkey);p.f=this.__onNotification._$bind(this);p.f1=this.__onChoiceRingtone._$bind(this);p.f2=this.__onVibrate._$bind(this);if(j._$getDataInPreference("notification")=="1"){e._$addClassName(this.__nodes[0],"js-ok")}if(j._$getDataInPreference("vibrate")=="1"){e._$addClassName(this.__nodes[2],"js-ok")}if(!!j._$getDataInPreference("ring")){if(!j._$getDataInPreference("ring")||j._$getDataInPreference("ring")=="null"){j._$setDataInPreference("ringtitle","静音")}this.__nodes[1].innerText=j._$getDataInPreference("ringtitle")}};__proModuleF.__onNotification=function(_event){if(this.__nodes[0].className.search(__regClassName)>=0){e._$delClassName(this.__nodes[0],"js-ok");j._$setDataInPreference("notification","0")}else{e._$addClassName(this.__nodes[0],"js-ok");j._$setDataInPreference("notification","1")}};__proModuleF.__onChoiceRingtone=function(){navigator.notification.ringtone(j._$getDataInPreference("ring"),this.__choiceRingtoneCallback._$bind(this))};__proModuleF.__choiceRingtoneCallback=function(_uri,_title){if(_title=="null"){_title="静音"}this.__nodes[1].innerText=_title;j._$setDataInPreference("ring",_uri);j._$setDataInPreference("ringtitle",_title)};__proModuleF.__onVibrate=function(){if(this.__nodes[2].className.search(__regClassName)>=0){e._$delClassName(this.__nodes[2],"js-ok");j._$setDataInPreference("vibrate","0")}else{e._$addClassName(this.__nodes[2],"js-ok");j._$setDataInPreference("vibrate","1")}};__proModuleF.__getXhtml=function(){return e._$getHtmlTemplate("m4-jst-5",{tag:this.__tkey,})};p._$$ModuleH=MWF.C();__proModuleH=p._$$ModuleH._$extend(t._$$Module,true);__supModuleH=p._$$ModuleH._$supro;__proModuleH._$getId=function(){return"4-7"};__proModuleH.__getXhtml=function(){return e._$getHtmlTemplate("m4-jst-7",{tag:this.__tkey})}})(MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mwf.j"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.x"),MWF.P("mb.m"),MWF.P("mb.m.m4"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m4"));(function(t,p){var __proConfiguration,__proConfigurationMA,__proConfigurationMB,__proConfigurationMC,__proConfigurationMD,__proConfigurationME,__proConfigurationMF,__proConfigurationMG;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationMA=MWF.C();__proConfigurationMA=p._$$ConfigurationMA._$extend(t._$$Configuration,true);__proConfigurationMA.__getModule=function(){return p._$$ModuleA._$allocate(this.__mopt)};p._$$ConfigurationMB=MWF.C();__proConfigurationMB=p._$$ConfigurationMB._$extend(t._$$Configuration,true);__proConfigurationMB.__getModule=function(){return p._$$ModuleB._$allocate(this.__mopt)};p._$$ConfigurationMC=MWF.C();__proConfigurationMC=p._$$ConfigurationMC._$extend(t._$$Configuration,true);__proConfigurationMC.__getModule=function(){return p._$$ModuleC._$allocate(this.__mopt)};p._$$ConfigurationMD=MWF.C();__proConfigurationMD=p._$$ConfigurationMD._$extend(t._$$Configuration,true);__proConfigurationMD.__getModule=function(){return p._$$ModuleD._$allocate(this.__mopt)};p._$$ConfigurationME=MWF.C();__proConfigurationME=p._$$ConfigurationME._$extend(t._$$Configuration,true);__proConfigurationME.__getModule=function(){return p._$$ModuleE._$allocate(this.__mopt)};p._$$ConfigurationMF=MWF.C();__proConfigurationMF=p._$$ConfigurationMF._$extend(t._$$Configuration,true);__proConfigurationMF.__getModule=function(){return p._$$ModuleF._$allocate(this.__mopt)};p._$$ConfigurationMG=MWF.C();__proConfigurationMG=p._$$ConfigurationMG._$extend(t._$$Configuration,true);__proConfigurationMG.__getModule=function(){return p._$$ModuleG._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m5"));(function(e,v,j,w,d,x,t,p){var __proModule,__supModule,__proModuleA,__supModuleA,__proModuleB,__supModuleB,__proModuleC,__supModuleC,__proModuleD,__supModuleD,__proModuleE,__supModuleE,__proModuleF,__supModuleF,__proModuleG,__supModuleG;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"5"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationMA,1:p._$$ConfigurationMB,2:p._$$ConfigurationMC,3:p._$$ConfigurationMD,4:p._$$ConfigurationME,5:p._$$ConfigurationMF,6:p._$$ConfigurationMG},onerror:this._$dispatchEvent._$bind(this,"onredirect","#m=3&t=3&uname="+_options.uname,true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleA=MWF.C();__proModuleA=p._$$ModuleA._$extend(t._$$Module,true);__supModuleA=p._$$ModuleA._$supro;__proModuleA._$getId=function(){return"5-0"};__proModuleA._$show=function(_options){__supModuleA._$show.apply(this,arguments)};__proModuleA.__hasTopbar=function(){return true};__proModuleA.__getXhtml=function(){return e._$getHtmlTemplate("m5-jst-0",{tag:this.__tkey})};__proModuleA.__buildModule=function(){__supModuleA.__buildModule.apply(this,arguments)};p._$$ModuleB=MWF.C();__proModuleB=p._$$ModuleB._$extend(t._$$Module,true);__supModuleB=p._$$ModuleB._$supro;__proModuleB._$getId=function(){return"5-1"};__proModuleB.__buildModule=function(){__supModuleB.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheFriend();this.__cache._$addEvent("onfriendload",this.__cbLoadUser._$bind(this));this.__bcache=new d._$$CacheUser();this.__bcache._$addEvent("onblogfriendcountsload",this.__cbLoadBlogFriendCounts._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__nnmb=_list[0];this.__muser=new w._$$SimpleList({jst:"m5-jst-134a",box:_list[1],btn:_list[2],ext:{uname:this.__uname||d._$VISITOR.userName},empty:"没有用户数据！",onnext:this.__onLoadUser._$bind(this)})};__proModuleB._$show=function(_options){this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}__supModuleB._$show.apply(this,arguments);this.__refreshModule()};__proModuleB.__refreshModule=function(){this.__bcache._$getBlogFriendCounts(this.__uname||d._$VISITOR.userName);this.__muser._$refresh(null,{ext:{uname:this.__uname||d._$VISITOR.userName}})};__proModuleB.__getXhtml=function(){return e._$getHtmlTemplate("m5-jst-134",{tag:this.__tkey})};__proModuleB.__onLoadUser=function(_offset,_limit){this.__cache._$getFriendList(0,_offset,_limit,this.__uname||d._$VISITOR.userName)};__proModuleB.__cbLoadUser=function(_offset,_limit){this.__muser._$append(this.__cache._$getFriendListInCache(0,this.__uname||d._$VISITOR.userName))};__proModuleB.__cbLoadBlogFriendCounts=function(_count){var _data=this.__bcache._$getBlogFriendCountsInCache(this.__uname||d._$VISITOR.userName);if(!!_data&&!!_data.friendsCount){this.__nnmb.innerText=_data.friendsCount}else{this.__nnmb.innerText="0"}};p._$$ModuleC=MWF.C();__proModuleC=p._$$ModuleC._$extend(t._$$Module,true);__supModuleC=p._$$ModuleC._$supro;__proModuleC._$getId=function(){return"5-2"};__proModuleC.__buildModule=function(){__supModuleC.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheUser();this.__cache._$addEvent("onnbuserload",this.__cbLoadUser._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__npst=_list[0];this.__muser=new w._$$SimpleList({jst:"m5-jst-2a",box:_list[1],btn:_list[2],empty:"没有用户数据！",onnext:this.__onLoadUser._$bind(this)});this.__muser._$refresh()};__proModuleC.__getXhtml=function(){return e._$getHtmlTemplate("m5-jst-2",{tag:this.__tkey})};__proModuleC.__onLoadUser=function(_offset,_limit){this.__cache._$getNBUserList(_offset,_limit)};__proModuleC.__cbLoadUser=function(_offset,_limit){this.__muser._$append(this.__cache._$getNBUserListInCache())};p._$$ModuleD=MWF.C();__proModuleD=p._$$ModuleD._$extend(t._$$Module,true);__supModuleD=p._$$ModuleD._$supro;__proModuleD._$getId=function(){return"5-3"};__proModuleD.__buildModule=function(){__supModuleC.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheUser();this.__cache._$addEvent("onfollowload",this.__cbLoadUser._$bind(this));this.__cache._$addEvent("onfollowcountload",this.__cbLoadUserCount._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__nnmb=_list[0];this.__muser=new w._$$SimpleList({jst:"m5-jst-134a",box:_list[1],btn:_list[2],ext:{uname:this.__uname||d._$VISITOR.userName},empty:"没有用户数据！",onnext:this.__onLoadUser._$bind(this)})};__proModuleD._$show=function(_options){this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}__supModuleD._$show.apply(this,arguments);this.__refreshModule()};__proModuleD.__refreshModule=function(){this.__cache._$getFollowCount();this.__muser._$refresh(null,{ext:{uname:this.__uname||d._$VISITOR.userName}})};__proModuleD.__getXhtml=function(){return e._$getHtmlTemplate("m5-jst-134",{tag:this.__tkey})};__proModuleD.__onLoadUser=function(_offset,_limit){this.__cache._$getFollowList(_offset,_limit)};__proModuleD.__cbLoadUser=function(_offset,_limit){this.__muser._$append(this.__cache._$getFollowListInCache())};__proModuleD.__cbLoadUserCount=function(_count){this.__nnmb.innerText=_count||"0"};p._$$ModuleE=MWF.C();__proModuleE=p._$$ModuleE._$extend(t._$$Module,true);__supModuleE=p._$$ModuleE._$supro;__proModuleE._$getId=function(){return"5-4"};__proModuleE.__getXhtml=function(){return e._$getHtmlTemplate("m5-jst-134",{tag:this.__tkey})};__proModuleE.__buildModule=function(){__supModuleE.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheUser();this.__cache._$addEvent("onfollowedload",this.__cbLoadUser._$bind(this));this.__cache._$addEvent("onfollowedcountload",this.__cbLoadUserCount._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__nnmb=_list[0];this.__muser=new w._$$SimpleList({jst:"m5-jst-134a",box:_list[1],btn:_list[2],empty:"没有用户数据！",onnext:this.__onLoadUser._$bind(this)});this.__cache._$getFollowedCount();this.__muser._$refresh()};__proModuleE.__onLoadUser=function(_offset,_limit){this.__cache._$getFollowedList(_offset,_limit)};__proModuleE.__cbLoadUser=function(_offset,_limit){this.__muser._$append(this.__cache._$getFollowedListInCache())};__proModuleE.__cbLoadUserCount=function(_count){this.__nnmb.innerText=_count||"0"};p._$$ModuleF=MWF.C();__proModuleF=p._$$ModuleF._$extend(t._$$Module,true);__supModuleF=p._$$ModuleF._$supro;__proModuleF._$getId=function(){return"5-5"};__proModuleF.__getXhtml=function(){return e._$getHtmlTemplate("m5-jst-56",{tag:this.__tkey})};__proModuleF.__buildModule=function(){__supModuleF.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheHome();this.__cache._$addEvent("onvisitorload",this.__cbLoadUser._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__muser=new w._$$SimpleList({jst:"m5-jst-5a",box:_list[0],btn:_list[1],ext:{uname:this.__uname||d._$VISITOR.userName},empty:"没有用户数据！",onnext:this.__onLoadUser._$bind(this)})};__proModuleF._$show=function(_options){this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}__supModuleF._$show.apply(this,arguments);this.__refreshModule()};__proModuleF.__refreshModule=function(){this.__muser._$refresh(null,{ext:{uname:this.__uname||d._$VISITOR.userName}})};__proModuleF.__onLoadUser=function(_offset,_limit){this.__cache._$getVisitorList(_offset,_limit,this.__uname||d._$VISITOR.userName)};__proModuleF.__cbLoadUser=function(_offset,_limit){this.__muser._$append(this.__cache._$getVisitorListInCache(this.__uname||d._$VISITOR.userName))};p._$$ModuleG=MWF.C();__proModuleG=p._$$ModuleG._$extend(t._$$Module,true);__supModuleG=p._$$ModuleG._$supro;__proModuleG._$getId=function(){return"5-6"};__proModuleG.__getXhtml=function(){return e._$getHtmlTemplate("m5-jst-56",{tag:this.__tkey})};__proModuleG.__buildModule=function(){__supModuleG.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheHome();this.__cache._$addEvent("onvisitorwhoload",this.__cbLoadUser._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__muser=new w._$$SimpleList({jst:"m5-jst-6a",box:_list[0],btn:_list[1],empty:"没有用户数据！",onnext:this.__onLoadUser._$bind(this)});this.__muser._$refresh()};__proModuleG.__onLoadUser=function(_offset,_limit){this.__cache._$getVisitorWhoList(_offset,_limit)};__proModuleG.__cbLoadUser=function(_offset,_limit){this.__muser._$append(this.__cache._$getVisitorWhoListInCache())}})(MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mwf.j"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.x"),MWF.P("mb.m"),MWF.P("mb.m.m5"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m5"));(function(t,p){var __proConfiguration,__proConfigurationMA;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationMA=MWF.C();__proConfigurationMA=p._$$ConfigurationMA._$extend(t._$$Configuration,true);__proConfigurationMA.__getModule=function(){return p._$$ModuleA._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m6"));(function(o,f,u,e,v,x,w,d,t,j,p){var __proBlogCommentCache,__proModule,__supModule,__proModuleA,__supModuleA;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"6"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationMA},onerror:this._$dispatchEvent._$bind(this,"onredirect","m=1&t=0",true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleA=MWF.C();__proModuleA=p._$$ModuleA._$extend(t._$$Module,true);__supModuleA=p._$$ModuleA._$supro;__proModuleA._$getId=function(){return"6-0"};__proModuleA.__getXhtml=function(){return e._$getHtmlTemplate("m6-jst-0",{tag:this.__tkey,user:d._$VISITOR})};__proModuleA.__buildModule=function(){__supModuleA.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheBlog();this.__cache._$addEvent("onblogcontentload",this.__cbLoadBlogContent._$bind(this));this.__cache._$addEvent("onblogdelete",this.__cbDeleteBlogContent._$bind(this));this.__cache._$addEvent("onallowrecommend",this.__cbAllowRecommend._$bind(this));this.__ucache=new d._$$CacheUser();this.__ucache._$addEvent("onuserload",this.__onUserLoad._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);var _index=0;this.__uimg=_list[_index++];this.__nick=_list[_index++];this.__time=_list[_index++];this.__cmtCount=_list[_index++];this.__blogTtl=_list[_index++];this.__blogCnt=_list[_index++];this.__cmtbox=_list[_index++];this.__cmtOpt={cmtbox:this.__cmtbox,cacheClass:p._$$BlogCommentCache,onwrite:this.__onWriteBlogComment._$bind(this),onreply:this.__onReplyBlogComment._$bind(this),};this.__bst=0;this.__dst=0;mb.m["m"+this._$getId()].d=this.__deleteBlog._$bind(this);mb.m["m"+this._$getId()].r=this.__recommendBlog._$bind(this)};__proModuleA.__onWriteBlogComment=function(_options){this.__bst=e._$getByClassName(this.__body,"cmtbox")[0].offsetTop;this.__dst=document.documentElement.scrollTop;this._$dispatchEvent("onredirect","#m=7&uname="+this.__uname+"&bid="+_options.subjectId)};__proModuleA.__onReplyBlogComment=function(_options){this.__bst=e._$getByClassName(this.__body,"cmtbox")[0].offsetTop;this.__dst=document.documentElement.scrollTop;this._$dispatchEvent("onredirect","#m=7&uname="+this.__uname+"&bid="+_options.subjectId+"&cid="+_options.replyComId+"&mid="+_options.mainComId)};__proModuleA._$show=function(_options){this.__isRecommend=false;this.__uimg.parentNode.parentNode.parentNode.style.display="none";__supModuleA._$show.apply(this,arguments);this.__uname=_options.uname||"";this.__draft=_options.draft||0;if(!!this.__uname&&(this.__uname!=d._$VISITOR.userName)){this.__cache._$allowRecommendBlog(_options.bid)}else{if(!this.__draft){}else{}}this.__cache._$getBlogContent(_options.bid,_options.uname);this.__ucache._$getUserInfo(_options.uname);if(this.__referrer.indexOf("m=7")>=0){mb.x.scrollTop(this.__bst,this.__dst)}this.__bst=0;this.__dst=0;if(!this.__draft){this.__cmtCount.parentNode.style.display="";var _frommsg=_options.r||"f";if(!!_frommsg&&_frommsg=="t"){this.__commentCache=new this.__cmtOpt.cacheClass({ckey:_options.bid});this.__commentCache._$setCommentListInCache([])}this.__cmtOpt.id=_options.bid||"";if(!this.__blogcmt){this.__blogcmt=new w._$$CommentList(this.__cmtOpt)}else{this.__blogcmt._$resetOption(this.__cmtOpt)}}else{this.__cmtCount.parentNode.style.display="none"}};__proModuleA.__hasTopbar=function(){return true};__proModuleA.__deleteBlog=function(){mb.x.confirm("是否确定删除？",this.__confirmCallback._$bind(this))};__proModuleA.__confirmCallback=function(_result){if("true"==_result){this.__cache._$deleteBlog(this.__cmtOpt.id)}};__proModuleA.__recommendBlog=function(){if(!!this.__isRecommend){mb.x.alert("您已推荐过！");return}this._$dispatchEvent("onredirect","#m=16&bid="+this.__cmtOpt.id+"&uname="+this.__uname)};__proModuleA.__cbDeleteBlogContent=function(_bid){this._$dispatchEvent("onredirect","#m=3&t=0&r=t")};__proModuleA.__cbAllowRecommend=function(_allow){if(!!_allow){}else{this.__isRecommend=true}};__proModuleA.__cbLoadBlogContent=function(_bid,_blog){if(!_blog){_blog={}}this.__time.innerText=u._$format(_blog.publishTime||0,"yyyy-MM-dd HH:mm");this.__cmtCount.innerText="("+(_blog.commentCount||0)+")";this.__blogTtl.innerText=_blog.title||"";this.__blogCnt.innerHTML=_blog.content||"";w._$$ImgLazyLoad._$bind(this.__blogCnt,{lazyimgsrc:"lazysrc",granularity:"img",defaultimg:"../images/placeholder.png"});if(!this.__draft){this.__cmtbox.style.display=""}else{this.__cmtbox.style.display="none"}};__proModuleA.__onUserLoad=function(_user,_data){this.__uimg.src="http://os.blog.163.com/common/ava.s?host="+_data.userName;this.__uimg.parentNode.href="#m=3&t=0&r=t&uname="+_data.userName;this.__nick.innerText=_data.nickName;this.__uimg.parentNode.parentNode.parentNode.style.display=""};__proModuleA._$hide=function(){this.__blogTtl.innerText="";this.__blogCnt.innerHTML="";this.__cmtbox.style.display="none";this.__uimg.parentNode.parentNode.parentNode.style.display="none";__supModuleA._$hide.apply(this,arguments)};p._$$BlogCommentCache=MWF.C();__proBlogCommentCache=p._$$BlogCommentCache._$extend(w._$$CommentCache);__proBlogCommentCache._$getCommentList=function(_id,_ckey,_offset,_limit){this._$getListByDWR({offset:_offset,limit:_limit,url:"MobileBlogBean.getBlogComments",callback:["oncommentload",_ckey,_offset,_limit],key:_ckey,parse:function(_option){_option.param=[_id,_offset,_limit,-1]},filter:function(_data){return(_data.resultData||o).blogComments}})};__proBlogCommentCache._$publishMainCmt=function(_edtOpt,_content){_edtOpt=_edtOpt||{};var _blogId=_edtOpt.bid||"";var _options=this.__getDWROption();_options.param=[_content,_blogId];_options.method="POST";_options.onload=this.__cbAddMainBlogComment._$bind2(this,_blogId,_content);_options.onerror=this.__cbAddCommentError._$bind(this,_blogId,null);j._$requestByDWR("MobileBlogBean.addBlogComment",_options)};__proBlogCommentCache.__cbAddMainBlogComment=function(_data,_bid,_content){if(!!_data&&!!_data.resultData&&_data.resultData.result==1){var _user=d._$VISITOR,_data=_data.resultData;var _commentItem={blogId:_bid,content:_content,moveFrom:"wap",id:_data.commentId,replyToUserId:_user.userId,replyToUserName:_user.userName,replyToUserNick:_user.userNickname,publisherId:_user.userId,publisherName:_user.userName,publisherNickName:_user.userNickname,publishTime:_data.publishTime};var _options={commentItem:_commentItem,subjectId:_bid};this.__ckey=_bid;this._$cbAddMainComment(_options)}else{mb.x.alert("添加评论失败！")}};__proBlogCommentCache._$replyComment=function(_edtOpt,_content){_edtOpt=_edtOpt||{};var _replyComId=_edtOpt.cid||"-1";var _blogId=_edtOpt.bid||"";var _options=this.__getDWROption();_options.param=[_replyComId,_content,_blogId];_options.method="POST";_options.onload=this.__cbReplyBlogComment._$bind2(this,_edtOpt,_content);_options.onerror=this.__cbAddCommentError._$bind(this,_blogId,null);j._$requestByDWR("MobileBlogBean.replyBlogComment",_options)};__proBlogCommentCache.__cbReplyBlogComment=function(_data,_edtOpt,_content){_edtOpt=_edtOpt||{};var _mainComId=_edtOpt.mid||"-1";var _replyComId=_edtOpt.cid||"-1";var _blogId=_edtOpt.bid||"";var _replyToUserId=_edtOpt.replyToUserId||"";var _replyToUserName=_edtOpt.replyToUserName||"";var _replyToUserNick=_edtOpt.replyToUserNick||"";if(!!_data&&!!_data.resultData&&_data.resultData.result==1){var _user=d._$VISITOR,_data=_data.resultData;var _commentItem={blogId:_blogId,content:_content,moveFrom:"wap",id:_data.commentId,mainComId:_mainComId,replyComId:_replyComId,replyToUserId:_replyToUserId,replyToUserName:_replyToUserName,replyToUserNick:_replyToUserNick,publisherId:_user.userId,publisherName:_user.userName,publisherNickName:_user.userNickname,publishTime:_data.publishTime};var _options={commentItem:_commentItem,subjectId:_blogId};this.__ckey=_blogId;this._$cbReplyComment(_options)}else{mb.x.alert("添加评论失败！")}}})(MWF.O,MWF.F,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.x"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mwf.j"),MWF.P("mb.m.m6"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m6"));(function(t,p){var __proConfiguration;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m7"));(function(o,u,e,v,w,d,t,j,p){var __proBlogCommentCache,__proModule,__supModule;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$Module,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"7"};__proModule.__buildModule=function(_options){__supModule.__buildModule.apply(this,arguments);this.__cache=new mb.m.m6._$$BlogCommentCache();this.__cache._$addEvent("onmaincommentadd",this.__cbMainCommentAdd._$bind(this));this.__cache._$addEvent("onrelycomment",this.__cbReplyComment._$bind(this));this.__bcache=new d._$$CacheBlog();var _list=e._$getByClassName(this.__body,this.__tkey);this.__cnt=_list[0];this.__btn=_list[1];e._$mbfocus(this.__cnt);v._$addEvent(this.__cnt,"input",this.__onContentInput._$bind(this));v._$addEvent(this.__btn,"click",this.__addBlogComment._$bind(this))};__proModule.__getXhtml=function(){return e._$getHtmlTemplate("m7-jst-1",{tag:this.__tkey})};__proModule._$show=function(_options){__supModule._$show.apply(this,arguments);this.__options=_options;this.__cnt.placeholder="撰写内容...";if(!!this.__options.cid){this.__cnt.placeholder="回复内容..."}this.__cnt.value="";this.__cnt.focus();e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=true;this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}};__proModule.__onContentInput=function(_event){if(this.__cnt.value==""){e._$addClassName(this.__btn,"s-fc1");this.__btnDisabled=true}else{e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=false}};__proModule.__addBlogComment=function(){this.__cntvalue=this.__cnt.value;if(!this.__cntvalue){mb.x.alert("评论内容不能为空！");return}if(!!this.__btnDisabled){return}e._$addClassName(this.__btn,"s-fc1");this.__btnDisabled=true;if(!!this.__cntvalue){if(!!this.__options.cid){this.__cache._$replyComment(this.__options,this.__cntvalue)}else{this.__cache._$publishMainCmt(this.__options,this.__cntvalue)}}};__proModule.__cbMainCommentAdd=function(_subjectId){var _blog=this.__bcache._$getBlogInCache(this.__options.bid);if(!!_blog){_blog.commentCount+=1}e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=false;this._$dispatchEvent("onredirect","#m=6&t=0&uname="+mb.x._$getHostName()+"&bid="+this.__options.bid,true)};__proModule.__cbReplyComment=function(_subjectId){var _blog=this.__bcache._$getBlogInCache(this.__options.bid);if(!!_blog){_blog.commentCount+=1}e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=false;this._$dispatchEvent("onredirect","#m=6&t=0&uname="+mb.x._$getHostName()+"&bid="+this.__options.bid,true)}})(MWF.O,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mwf.j"),MWF.P("mb.m.m7"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m7"));(function(t,p){var __proConfiguration;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m8"));(function(e,v,d,t,p){var __proModule,__supModule;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$Module,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"8"};__proModule.__getXhtml=function(){return e._$getHtmlTemplate("m8-jst-0",{tag:this.__tkey})};__proModule.__buildModule=function(){__supModule.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("onfeedback",this.__cbSubmit._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__form=_list[0];this.__btn=_list[3];this.__cnt=_list[1];this.__num=_list[2];e._$mbfocus(this.__cnt);v._$addEvent(this.__cnt,"input",this.__onContentInput._$bind(this));v._$addEvent(this.__btn,"click",this.__onSubmit._$bind(this))};__proModule.__onContentInput=function(_event){if(this.__cnt.value==""){e._$addClassName(this.__btn,"s-fc1");this.__btnDisabled=true}else{e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=false}};__proModule._$show=function(){__supModule._$show.apply(this,arguments);this.__resetModule();this.__cnt.focus()};__proModule.__resetModule=function(){this.__cnt.value="";this.__num.value="";e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=true};__proModule.__onSubmit=function(){if(!!this.__btnDisabled){return}e._$addClassName(this.__btn,"s-fc1");this.__btnDisabled=true;if(!this.__cnt.value){mb.x.alert("请输入反馈内容！");_node.focus();return}this.__cache._$feedback(this.__cnt.value,this.__num.value)};__proModule.__cbSubmit=function(_isok){if(!_isok){mb.x.alert("暂时无法提交您的反馈信息，请稍后再试！")}else{mb.x.alert("反馈内容已提交！")}t._$$HashManager._$getInstance()._$back(true);e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=false}})(MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mb.m.m8"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m8"));(function(t,p){var __proConfiguration;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m9"));(function(o,f,u,e,v,x,w,d,t,j,p){var __proMoodCommentCache,__proModule,__supModule;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$Module,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"9"};__proModule.__getXhtml=function(){return e._$getHtmlTemplate("m9-jst-0",{tag:this.__tkey,user:d._$VISITOR})};__proModule.__buildModule=function(){__supModule.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMood();this.__cache._$addEvent("onmooddataload",this.__cbLoadMoodContent._$bind(this));this.__ucache=new d._$$CacheUser();this.__ucache._$addEvent("onuserload",this.__onUserLoad._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__uimg=_list[0];this.__nick=_list[1];this.__time=_list[2];this.__cmtCount=_list[3];this.__moodCnt=_list[4];this.__delMood=_list[5];this.__cmtbox=_list[6];v._$addEvent(this.__delMood,"click",this.__deleteMood._$bind(this));var __mianCommentItemStr1='        {if !!mitmdata}		<div id="${mitmdata.id}" class="maincmtitem">		  <div class="maincmtcnt">		    <div class="mainleft"><a class="avatar" hidefocus="true" {if mitmdata.publisherId > 0}href="#m=3&t=0&r=t&uname=${mitmdata.publisherName|escape}"{/if} ><img src="http://os.blog.163.com/common/ava.s?host=${mitmdata.publisherName|escape}" /></a></div>		    <div class="mainright" onclick="mb.w.g.mainReply(\'${mitmdata.id}\',\'${mitmdata.publisherId}\',\'${mitmdata.publisherName}\',\'${mitmdata.publisherNickname|escape}\')">		      <div class=""><div class="maintime thide">${mitmdata.publishTime|datetime}</div><div class="maimttl"><div class="ttltxt thide">${ext.fsubstr(mitmdata.publisherNickname,16)|escape}：</div></div></div>		      <div class="maincnt g_t_hide_mulline">${mitmdata.content|default:""}</div>		      <div>		        <div style="display:none;" class="mainreply" onclick="mb.w.g.mainReply(\'${mitmdata.id}\',\'${mitmdata.publisherId}\',\'${mitmdata.publisherName}\',\'${mitmdata.publisherNickname|escape}\')">回复</div>		      </div>		    </div>		  </div>		  <div class="subcomments">		';var __mianCommentItemStr2="			  </div>			</div>			{/if}			";var __subCommentItemStr='		    {if !!sitmdata}			<div id="${sitmdata.id}" class="subcmtitem">			  <div class="subleft"><a class="avatar" hidefocus="true" {if sitmdata.publisherId > 0}href="#m=3&t=0&r=t&uname=${sitmdata.publisherName|escape}"{/if} ><img src="http://os.blog.163.com/common/ava.s?host=${sitmdata.publisherName|escape}" /></a></div>			  <div class="subright" onclick="mb.w.g.subReply(\'${sitmdata.mainComId}\',\'${sitmdata.id}\',\'${sitmdata.publisherId}\',\'${sitmdata.publisherName}\',\'${sitmdata.publisherNickname|escape}\')">			    <div class=""><div class="subtime">${sitmdata.publishTime|datetime}</div><div class="subttl thide"><div class="">${ext.fsubstr(sitmdata.publisherNickname,16)|escape}：</div></div></div>		        <div class="subcnt g_t_hide_mulline">${sitmdata.content|default:""}</div>		        <div>		          <div style="display:none;" class="subreply" onclick="mb.w.g.subReply(\'${sitmdata.mainComId}\',\'${sitmdata.id}\',\'${sitmdata.publisherId}\',\'${sitmdata.publisherName}\',\'${sitmdata.publisherNickname|escape}\')">回复</div>		        </div>			  </div>			</div>			{/if}		    ';var __commentListStr="{if xlist.length>0}{list xlist as mitmdata}"+__mianCommentItemStr1+"{if !!mitmdata.subComments && mitmdata.subComments.length>0}{list mitmdata.subComments as sitmdata}"+__subCommentItemStr+"{/list}{/if}"+__mianCommentItemStr2+"{/list}{/if}";var __tkeyCommentList=e._$addHtmlTemplate(__commentListStr);this.__cmtOpt={cmtbox:this.__cmtbox,cacheClass:p._$$MoodCommentCache,onwrite:this.__onWriteMoodComment._$bind(this),onreply:this.__onReplyMoodComment._$bind(this),tkeyCommentListJst:__tkeyCommentList}};__proModule.__onWriteMoodComment=function(_options){this._$dispatchEvent("onredirect","#m=10&uname="+this.__uname+"&id="+_options.subjectId)};__proModule.__onReplyMoodComment=function(_options){this._$dispatchEvent("onredirect","#m=10&uname="+this.__uname+"&id="+_options.subjectId+"&cid="+_options.replyComId+"&mid="+_options.mainComId)};__proModule._$show=function(_options){__supModule._$show.apply(this,arguments);this.__cache._$getMood(_options.id,_options.uname);this.__ucache._$getUserInfo(_options.uname);this.__uname=_options.uname||"";this.__cmtOpt.id=_options.id||"";var _frommsg=_options.r||"f";if(!!_frommsg&&_frommsg=="t"){this.__commentCache=new this.__cmtOpt.cacheClass({ckey:_options.id});this.__commentCache._$setCommentListInCache([])}if(!this.__blogcmt){this.__blogcmt=new w._$$CommentList(this.__cmtOpt)}else{this.__blogcmt._$resetOption(this.__cmtOpt)}};__proModule.__hasTopbar=function(){return true};__proModule.__deleteMood=function(){mb.x.confirm("是否确定删除？",this.__confirmCallback._$bind(this))};__proModule.__confirmCallback=function(_result){if("true"==_result){}};__proModule.__cbLoadMoodContent=function(_mood){if(!_mood){_mood={}}this.__time.innerText=u._$format(_mood.publishTime||0,"yyyy-MM-dd HH:mm");this.__cmtCount.innerText="("+(_mood.commentCount||0)+")";this.__moodCnt.innerHTML=_mood.content||"";this.__cmtbox.style.display=""};__proModule.__onUserLoad=function(_user,_data){this.__uimg.src="http://os.blog.163.com/common/ava.s?host="+_data.userName;this.__uimg.parentNode.href="#m=3&t=2&r=t&uname="+_data.userName;this.__nick.innerText=_data.nickName};__proModule._$hide=function(){this.__moodCnt.innerHTML="";this.__cmtbox.style.display="none";__supModule._$hide.apply(this,arguments)};p._$$MoodCommentCache=MWF.C();__proMoodCommentCache=p._$$MoodCommentCache._$extend(w._$$CommentCache);__proMoodCommentCache._$getCommentList=function(_mid,_ckey,_offset,_limit){this._$getListByDWR({offset:_offset,limit:_limit,url:"MobileFeelingBean.getFeelingsCommentList",callback:["oncommentload",_ckey,_offset,_limit],key:_ckey,parse:function(_option){_option.param=[_mid,_offset,_limit,-1]}})};__proMoodCommentCache._$publishMainCmt=function(_edtOpt,_content){_edtOpt=_edtOpt||{};var _moodId=_edtOpt.id||"";var _options=this.__getDWROption();_options.param=[_moodId,_content];_options.method="POST";_options.onload=this.__cbAddMainComment._$bind2(this,_moodId,_content);_options.onerror=this.__cbAddCommentError._$bind(this,_moodId,null);j._$requestByDWR("MobileFeelingBean.addNewFeelingComment",_options)};__proMoodCommentCache.__cbAddMainComment=function(_data,_mid,_content){if(!!_data&&!!_data.resultData&&_data.resultData.result==1){var _user=d._$VISITOR,_data=_data.resultData;var _commentItem={cardId:_mid,content:_content,id:_data.commentId,replyToUserId:_user.userId,replyToUserName:_user.userName,replyToUserNick:_user.userNickname,publisherId:_user.userId,publisherName:_user.userName,publisherNickname:_user.userNickname,publishTime:_data.publishTime};var _options={commentItem:_commentItem,subjectId:_mid};this.__ckey=_mid;this._$cbAddMainComment(_options)}else{mb.x.alert("添加评论失败！")}};__proMoodCommentCache._$replyComment=function(_edtOpt,_content){_edtOpt=_edtOpt||{};var _replyComId=_edtOpt.cid||"-1";var _moodId=_edtOpt.id||"";var _options=this.__getDWROption();_options.param=[_moodId,_content,_replyComId];_options.method="POST";_options.onload=this.__cbReplyComment._$bind2(this,_edtOpt,_content);_options.onerror=this.__cbAddCommentError._$bind(this,_moodId,null);j._$requestByDWR("MobileFeelingBean.replyFeelingComment",_options)};__proMoodCommentCache.__cbReplyComment=function(_data,_edtOpt,_content){_edtOpt=_edtOpt||{};var _mainComId=_edtOpt.mid||"-1";var _replyComId=_edtOpt.cid||"-1";var _moodId=_edtOpt.id||"";var _replyToUserId=_edtOpt.replyToUserId||"";var _replyToUserName=_edtOpt.replyToUserName||"";var _replyToUserNick=_edtOpt.replyToUserNick||"";if(!!_data&&!!_data.resultData&&_data.resultData.result==1){var _user=d._$VISITOR,_data=_data.resultData;var _commentItem={cardId:_moodId,content:_content,moveFrom:"wap",id:_data.commentId,mainComId:_mainComId,replyComId:_replyComId,replyToUserId:_replyToUserId,replyToUserName:_replyToUserName,replyToUserNick:_replyToUserNick,publisherId:_user.userId,publisherName:_user.userName,publisherNickname:_user.userNickname,publishTime:_data.publishTime};var _options={commentItem:_commentItem,subjectId:_moodId};this.__ckey=_moodId;this._$cbReplyComment(_options)}else{mb.x.alert("添加评论失败！")}}})(MWF.O,MWF.F,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.x"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mwf.j"),MWF.P("mb.m.m9"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m9"));(function(t,p){var __proConfiguration;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m10"));(function(o,u,e,v,w,d,t,j,p){var __proMoodCommentCache,__proModule,__supModule;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$Module,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"10"};__proModule.__buildModule=function(_options){__supModule.__buildModule.apply(this,arguments);this.__cache=new mb.m.m9._$$MoodCommentCache();this.__cache._$addEvent("onmaincommentadd",this.__cbMainCommentAdd._$bind(this));this.__cache._$addEvent("onrelycomment",this.__cbReplyComment._$bind(this));this.__bcache=new d._$$CacheMood();var _list=e._$getByClassName(this.__body,this.__tkey);this.__cnt=_list[0];this.__btn=_list[1];e._$mbfocus(this.__cnt);v._$addEvent(this.__cnt,"input",this.__onContentInput._$bind(this));v._$addEvent(this.__btn,"click",this.__addMoodComment._$bind(this))};__proModule.__getXhtml=function(){return e._$getHtmlTemplate("m10-jst-1",{tag:this.__tkey})};__proModule._$show=function(_options){__supModule._$show.apply(this,arguments);this.__options=_options;this.__cnt.placeholder="撰写内容...";if(!!this.__options.cid){this.__cnt.placeholder="回复内容..."}this.__cnt.value="";this.__cnt.focus();e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=true;this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}};__proModule.__onContentInput=function(_event){if(this.__cnt.value==""){e._$addClassName(this.__btn,"s-fc1");this.__btnDisabled=true}else{e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=false}};__proModule.__addMoodComment=function(){this.__cntvalue=this.__cnt.value;if(!this.__cntvalue){mb.x.alert("评论内容不能为空！");return}if(!!this.__btnDisabled){return}e._$addClassName(this.__btn,"s-fc1");this.__btnDisabled=true;if(!!this.__cntvalue){if(!!this.__options.cid){this.__cache._$replyComment(this.__options,this.__cntvalue)}else{this.__cache._$publishMainCmt(this.__options,this.__cntvalue)}}};__proModule.__cbMainCommentAdd=function(_subjectId){var _mood=this.__bcache._$getMoodInCache(this.__options.id);if(!!_mood){_mood.commentCount+=1}e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=false;this._$dispatchEvent("onredirect","#m=9&uname="+mb.x._$getHostName()+"&id="+this.__options.id,true)};__proModule.__cbReplyComment=function(_subjectId){var _mood=this.__bcache._$getMoodInCache(this.__options.id);if(!!_mood){_mood.commentCount+=1}e._$delClassName(this.__btn,"s-fc1");this.__btnDisabled=false;this._$dispatchEvent("onredirect","#m=9&uname="+mb.x._$getHostName()+"&id="+this.__options.id,true)}})(MWF.O,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mwf.j"),MWF.P("mb.m.m10"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m10"));(function(t,p){var __proConfiguration,__proConfigurationMCB,__proConfigurationMCD;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationMCB=MWF.C();__proConfigurationMCB=p._$$ConfigurationMCB._$extend(t._$$Configuration,true);__proConfigurationMCB.__getModule=function(){return p._$$ModuleCB._$allocate(this.__mopt)};p._$$ConfigurationMCD=MWF.C();__proConfigurationMCD=p._$$ConfigurationMCD._$extend(t._$$Configuration,true);__proConfigurationMCD.__getModule=function(){return p._$$ModuleCD._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m11"));(function(o,u,e,v,w,d,t,p){var __proModule,__supModule,__proModuleCB,__supModuleCB,__proModuleCD,__supModuleCD;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"11"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationMCD,1:p._$$ConfigurationMCB},onerror:this._$dispatchEvent._$bind(this,"onredirect","m=3&t=1",true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleCB=MWF.C();__proModuleCB=p._$$ModuleCB._$extend(t._$$Module,true);__supModuleCB=p._$$ModuleCB._$supro;__proModuleCB._$getId=function(){return"11-1"};__proModuleCB._$show=function(_options){this.__pid=_options.pid;this.__uimg.parentNode.parentNode.parentNode.style.display="none";this.__ucache._$getUserInfo(_options.uname);var _data=this.__cache._$getPhotoInCache(this.__pid)||o;this.__aid=_data.albumId;this.__nimg.src=_data.m||"";this.__ntme.innerText=u._$format(parseInt(_data.createTime||"0"),"yyyy-MM-dd HH:mm");this.__desc.innerText=_data.desc||"";__supModuleCB._$show.apply(this,arguments)};__proModuleCB.__hasTopbar=function(){return true};__proModuleCB.__getXhtml=function(){return e._$getHtmlTemplate("m11-jst-1",{tag:this.__tkey,user:d._$VISITOR||o})};__proModuleCB.__buildModule=function(){__supModuleCB.__buildModule.apply(this,arguments);this.__cache=new d._$$CachePhoto();this.__ucache=new d._$$CacheUser();this.__ucache._$addEvent("onuserload",this.__onUserLoad._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__uimg=_list[0];this.__name=_list[1];this.__ntme=_list[2];this.__nimg=_list[3];this.__desc=_list[4];this.__ddiv=_list[5];this.__dbtn=_list[6];mb.m["m"+this._$getId()].d=this.__onDeletePhoto._$bind(this)};__proModuleCB.__onDeletePhoto=function(){mb.x.confirm("是否确定删除？",this.__confirmCallback._$bind(this))};__proModuleCB.__confirmCallback=function(_result){if("true"==_result){this.__cache._$deletePhoto(this.__pid,this.__aid)}};__proModuleCB.__onUserLoad=function(_user,_data){this.__uimg.src="http://os.blog.163.com/common/ava.s?host="+_data.userName;this.__uimg.parentNode.href="#m=3&t=0&r=t&uname="+_data.userName;this.__name.innerText=_data.nickName;this.__uimg.parentNode.parentNode.parentNode.style.display=""};__proModuleCB._$hide=function(){__supModuleCB._$hide.apply(this,arguments);this.__uimg.parentNode.parentNode.parentNode.style.display="none"};p._$$ModuleCD=MWF.C();__proModuleCD=p._$$ModuleCD._$extend(t._$$Module,true);__supModuleCD=p._$$ModuleCD._$supro;__proModuleCD._$getId=function(){return"11-0"};__proModuleCD.__hasTopbar=function(){return true};__proModuleCD._$show=function(_options){this.__uname=_options.uname;this.__ucache._$getUserInfo(this.__uname||d._$VISITOR.userName);this.__aid=_options.aid;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}__supModuleCD._$show.apply(this,arguments);if(this.__referrer.indexOf("m=11")>=0&&(_options.r||"")!="t"){mb.x.scrollTop(this.__bst,this.__dst)}else{this.__refreshModule()}};__proModuleCD.__refreshModule=function(){mb.x.top();this.__mphoto._$refresh(null,{ext:{uname:this.__uname||d._$VISITOR.userName}})};__proModuleCD.__getXhtml=function(){return e._$getHtmlTemplate("m11-jst-0",{tag:this.__tkey,user:d._$VISITOR||o})};__proModuleCD.__buildModule=function(){__supModuleCD.__buildModule.apply(this,arguments);this.__cache=new d._$$CachePhoto();this.__cache._$addEvent("onphotoload",this.__cbLoadPhoto._$bind(this));this.__ucache=new d._$$CacheUser();this.__ucache._$addEvent("onuserload",this.__onUserLoad._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__uimg=_list[0];this.__name=_list[1];this.__ntme=_list[2];this.__mphoto=new w._$$SimpleList({jst:"m11-jst-0a",box:_list[3],btn:_list[4],empty:"没有相片数据！",limit:18,onnext:this.__onLoadPhoto._$bind(this)});this.__aid=mb.x._$getParmvalByKey(location.hash,"aid");this.__bst=0;this.__dst=0};__proModuleCD.__onBeforeHide=function(){this.__bst=document.body.scrollTop;this.__dst=document.documentElement.scrollTop};__proModuleCD.__cbLoadAlbum=function(){var _album=this.__cache._$getAlbumInCache(this.__aid)||o;this.__ntme.innerText=u._$format(parseInt(_album.createTime||"0"),"yyyy-MM-dd HH:mm");if(!_album.createTime){(this.__ntme.parentNode||o).innerText=""}};__proModuleCD.__onUserLoad=function(_user,_data){this.__uimg.src="http://os.blog.163.com/common/ava.s?host="+_data.userName;this.__uimg.parentNode.href="#m=3&t=0&r=t&uname="+_data.userName;this.__name.innerText=_data.nickName;this.__uimg.parentNode.parentNode.parentNode.style.display=""};__proModuleCD.__onLoadPhoto=function(_offset,_limit){this.__cache._$getPhotoList(this.__aid,_offset,_limit,this.__uname||d._$VISITOR.userName);this.__cbLoadAlbum()};__proModuleCD.__cbLoadPhoto=function(_aid){this.__mphoto._$append(this.__cache._$getPhotoListInCache(_aid,this.__uname||d._$VISITOR.userName))}})(MWF.O,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mb.m.m11"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m11"));(function(t,p){var __proConfiguration;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m12"));(function(o,u,e,v,w,d,t,p){var __proModule,__supModule;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$Module,true);__supModule=p._$$Module._$supro;__proModule.__hasTopbar=function(){return true};__proModule._$getId=function(){return"12"};__proModule.__buildModule=function(_options){__supModule.__buildModule.apply(this,arguments);var _list=e._$getByClassName(this.__body,this.__tkey);this.__uimg=_list[0];this.__nick=_list[1];this.__userinfo=_list[2];this.__bloginfo=_list[3];this.__cache=new d._$$CacheUser();this.__cache._$addEvent("onuserload",this.__cbLoadUser._$bind(this));this.__cache._$addEvent("onbloginfoload",this.__cbLoadBlogInfo._$bind(this))};__proModule.__getXhtml=function(){return e._$getHtmlTemplate("m12-jst",{tag:this.__tkey})};__proModule._$show=function(_options){this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}__supModule._$show.apply(this,arguments);this.__cache._$getUserInfo(this.__uname||d._$VISITOR.userName);this.__cache._$getBlogInfo(this.__uname||d._$VISITOR.userName)};__proModule.__cbLoadUser=function(){var _data=this.__cache._$getUserInfoInCache(this.__uname||d._$VISITOR.userName);this.__uimg.src="http://os.blog.163.com/common/ava.s?host="+_data.userName;this.__nick.innerText=_data.nickName;this.__userinfo.innerHTML=e._$getHtmlTemplate("m12-jst-1",{user:_data})};__proModule.__cbLoadBlogInfo=function(){var _data=this.__cache._$getBlogInfoInCache(this.__uname||d._$VISITOR.userName);this.__bloginfo.innerHTML=e._$getHtmlTemplate("m12-jst-2",{bloginfo:_data})}})(MWF.O,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mb.m.m12"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m12"));(function(t,p){var __proConfiguration,__proConfigurationMA,__proConfigurationMB;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationMA=MWF.C();__proConfigurationMA=p._$$ConfigurationMA._$extend(t._$$Configuration,true);__proConfigurationMA.__getModule=function(){return p._$$ModuleA._$allocate(this.__mopt)};p._$$ConfigurationMB=MWF.C();__proConfigurationMB=p._$$ConfigurationMB._$extend(t._$$Configuration,true);__proConfigurationMB.__getModule=function(){return p._$$ModuleB._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m13"));(function(o,f,u,e,v,x,w,d,t,j,p){var __proModule,__supModule,__proModuleA,__supModuleA,__proModuleB,__supModuleB;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"13"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationMA,1:p._$$ConfigurationMB},onerror:this._$dispatchEvent._$bind(this,"onredirect","m=1&t=0",true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleA=MWF.C();__proModuleA=p._$$ModuleA._$extend(t._$$Module,true);__supModuleA=p._$$ModuleA._$supro;__proModuleA._$getId=function(){return"13-0"};__proModuleA.__getXhtml=function(){return e._$getHtmlTemplate("m13-jst-0",{tag:this.__tkey})};__proModuleA.__buildModule=function(){__supModuleA.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheMessage();this.__cache._$addEvent("onSendMsg",this.__cbSendMsg._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__cnt=_list[0];this.__btn=_list[1];e._$mbfocus(this.__cnt);v._$addEvent(this.__cnt,"input",this.__onContentInput._$bind(this));v._$addEvent(this.__btn,"click",this.__onSendMsg._$bind(this))};__proModuleA.__onContentInput=function(_event){if(this.__cnt.value==""){e._$addClassName(this.__btn,"s-fc1");this.__btn.disabled=true}else{e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=false}};__proModuleA._$show=function(_options){__supModuleA._$show.apply(this,arguments);this.__recuid=_options.recuid;this.__resetModule();this.__cnt.focus()};__proModuleA.__resetModule=function(){this.__cnt.value="";e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=true};__proModuleA.__onSendMsg=function(){this.__cache._$sendMsg(this.__recuid,this.__cnt.value)};__proModuleA.__cbSendMsg=function(_code){if(_code==1){try{u.showToast("发送消息成功！",5000)}catch(e){}t._$$HashManager._$getInstance()._$back(true);return}else{if(_code==-5){try{u.showToast("没有权限发送消息！",5000)}catch(e){}return}}try{u.showToast("发送消息失败！",5000)}catch(e){}};p._$$ModuleB=MWF.C();__proModuleB=p._$$ModuleB._$extend(t._$$Module,true);__supModuleB=p._$$ModuleB._$supro;__proModuleB._$getId=function(){return"13-1"};__proModuleB.__getXhtml=function(){return e._$getHtmlTemplate("m13-jst-1",{tag:this.__tkey})};__proModuleB.__buildModule=function(){__supModuleB.__buildModule.apply(this,arguments);this.__ucache=new d._$$CacheUser();this.__fcache=new d._$$CacheFriend();this.__fcache._$addEvent("ongroupload",this.__cbLoadGroup._$bind(this));this.__fcache._$addEvent("oninvitefriend",this.__cbInviteFriend._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);var _index=0;this.__frdgroup=_list[_index++];this.__frdgrouptxt=_list[_index++];this.__frdcnt=_list[_index++];this.__btnfrd=_list[_index++];v._$addEvent(this.__frdgroup,"tap",this.__showGroup._$bind(this));v._$addEvent(this.__btnfrd,"click",this.__onInviteFriend._$bind(this));window.x.m13t1=window.x.m13t1||{}};__proModuleB._$show=function(_options){__supModuleB._$show.apply(this,arguments);this.__uname=_options.uname;this.__resetModule();this.__strArr=[];this.__fcache._$getGroupList(d._$VISITOR.userName)};__proModuleB.__resetModule=function(){this.__frdcnt.value="";this.__frdgrouptxt.innerText="未分组博友";window.x.m13t1.onGroupSelect=this._$onGroupSelect._$bind(this)};__proModuleB.__cbLoadGroup=function(){var _list=this.__fcache._$getGroupListInCache(d._$VISITOR.userName),_strArr=[],_groupName;for(var i=0,l=_list.length;i<l;i++){_groupName=u._$escape(_list[i].groupName);_strArr.push('{"title":"'+_groupName+'","action":"window.x.m13t1.onGroupSelect(\''+_list[i].id+"','"+_groupName+"')\"}")}this.__strArr=_strArr};__proModuleB.__cbInviteFriend=function(_data){if(!!_data&&!!_data.resultData){if(_data.resultData.result>0||_data.resultData.result<-10){this.__ucache._$clearUserCache(this.__uname);x.alert("邀请发送成功！");t._$$HashManager._$getInstance()._$back(true)}else{if(_data.resultData.result==-5){x.alert("对方不接受任何邀请！")}else{x.alert("邀请失败")}}}else{x.alert("邀请发送失败！")}};__proModuleB.__showGroup=function(){if(!!this.__strArr){u.PopUpMenu("选择博友分类","["+this.__strArr.join(",")+"]")}else{x.alert("博友分组加载中...")}};__proModuleB._$onGroupSelect=function(_id,_groupName){this.__groupId=_id||0;this.__frdgrouptxt.innerText=_groupName||"未分组博友"};__proModuleB.__onInviteFriend=function(){this.__fcache._$addFriend(this.__uname,this.__groupId||0,this.__frdcnt.vaule||"")}})(MWF.O,MWF.F,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.x"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mwf.j"),MWF.P("mb.m.m13"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m13"));(function(t,p){var __proConfiguration,__proConfigurationA,__proConfigurationB;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationA=MWF.C();__proConfigurationA=p._$$ConfigurationA._$extend(t._$$Configuration,true);__proConfigurationA.__getModule=function(){return p._$$ModuleA._$allocate(this.__mopt)};p._$$ConfigurationB=MWF.C();__proConfigurationB=p._$$ConfigurationB._$extend(t._$$Configuration,true);__proConfigurationB.__getModule=function(){return p._$$ModuleB._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m14"));(function(o,e,v,d,t,w,p){var __proModule,__supModule,__proModuleA,__supModuleA,__proModuleB,__supModuleB;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"14"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationA,1:p._$$ConfigurationB},onerror:this._$dispatchEvent._$bind(this,"onredirect","m=14&t=0",true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleA=MWF.C();__proModuleA=p._$$ModuleA._$extend(t._$$Module,true);__supModuleA=p._$$ModuleA._$supro;__proModuleA._$getId=function(){return"14-0"};__proModuleA.__getXhtml=function(){return e._$getHtmlTemplate("m14-jst-0",{tag:this.__tkey})};__proModuleA.__buildModule=function(){__supModuleA.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheHome();this.__cache._$addEvent("onnoteload",this.__cbLoadNote._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__mmsg=new w._$$SimpleList({jst:"m14-jst-0a",box:_list[0],btn:_list[1],empty:"没有留言！",ext:{uname:this.__uname||d._$VISITOR.userName},onnext:this.__onLoadNote._$bind(this)});var _newNoteEntry=e._$getByClassName(this.__body,"m-input")||o;v._$addEvent(_newNoteEntry[0],"click",this.__onAddNotePage._$bind(this));e._$mbhover(_list[0],"js-click",function(e){return e.tagName=="A"})};__proModuleA.__onAddNotePage=function(_event){v._$stop(_event);var hash="#m=14&t=1";if(!!this.__uname&&(this.__uname!=d._$VISITOR.userName)){hash+="&uname="+this.__uname}this._$dispatchEvent("onredirect",hash)};__proModuleA._$show=function(_options){__supModuleA._$show.apply(this,arguments);this.__uname=_options.uname;if(!!this.__uname&&(this.__uname==d._$VISITOR.userName)){delete this.__uname}this.__refreshModule()};__proModuleA.__refreshModule=function(){this.__mmsg._$refresh()};__proModuleA.__onLoadNote=function(_offset,_limit){this.__cache._$getNoteList(_offset,_limit,this.__uname||d._$VISITOR.userName)};__proModuleA.__cbLoadNote=function(_offset,_limit){this.__mmsg._$append(this.__cache._$getNoteListInCache(this.__uname||d._$VISITOR.userName))};p._$$ModuleB=MWF.C();__proModuleB=p._$$ModuleB._$extend(t._$$Module,true);__supModuleB=p._$$ModuleB._$supro;__proModuleB._$getId=function(){return"14-1"};__proModuleB.__getXhtml=function(){return e._$getHtmlTemplate("m14-jst-1",{tag:this.__tkey})};__proModuleB.__buildModule=function(){__supModuleB.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheHome();this.__cache._$addEvent("oncbaddnote",this.__cbAddNote._$bind(this));this.__ucache=new d._$$CacheUser();this.__ucache._$addEvent("onuserload",this.__onUserLoad._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__cnt=_list[0];this.__btn=_list[1];e._$mbfocus(this.__cnt);v._$addEvent(this.__btn,"click",this.__onSubmit._$bind(this));v._$addEvent(this.__cnt,"input",this.__onContentInput._$bind(this))};__proModuleB.__onContentInput=function(_event){if(this.__cnt.value==""){e._$addClassName(this.__btn,"s-fc1");this.__btn.disabled=true}else{e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=false}};__proModuleB._$show=function(_options){__supModuleB._$show.apply(this,arguments);this.__ucache._$getUserInfo(d._$VISITOR.userName);this.__resetModule();window.setTimeout(function(){this.__cnt.focus()}._$bind(this),100)};__proModuleB.__resetModule=function(){this.__cnt.value="";e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=true};__proModuleB.__onUserLoad=function(_user,_data){this.__nickName=(_data||o).nickName};__proModuleB.__onSubmit=function(_offset,_limit){e._$addClassName(this.__btn,"s-fc1");this.__btn.disabled=true;__cntvalue=this.__cnt.value;if(!__cntvalue){mb.x.alert("留言内容不能为空！");return}this.__cache._$addNote(__cntvalue,this.__nickName)};__proModuleB.__cbAddNote=function(_code){e._$delClassName(this.__btn,"s-fc1");this.__btn.disabled=false;if(_code==1){mb.x.alert("添加留言成功！")}else{if(_code==-5){mb.x.alert("没有留言权限！")}else{mb.x.alert("添加留言失败！");return}}var hash="m=14&t=0";if(mb.x._$getHostName()!=d._$VISITOR.userName){hash+="&uname="+mb.x._$getHostName()}this._$dispatchEvent("onredirect",hash)}})(MWF.O,MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mb.w"),MWF.P("mb.m.m14"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m14"));(function(t,p){var __proConfiguration,__proConfigurationA;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)};p._$$ConfigurationA=MWF.C();__proConfigurationA=p._$$ConfigurationA._$extend(t._$$Configuration,true);__proConfigurationA.__getModule=function(){return p._$$ModuleA._$allocate(this.__mopt)};p._$$ConfigurationB=MWF.C();__proConfigurationB=p._$$ConfigurationB._$extend(t._$$Configuration,true);__proConfigurationB.__getModule=function(){return p._$$ModuleB._$allocate(this.__mopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m15"));(function(e,t,p){var __proModule,__supModule,__proModuleA,__supModuleA,__proModuleB,__supModuleB;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$ModuleSP,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"15"};__proModule.__buildModule=function(_options){this.__mopt={key:"t",config:{0:p._$$ConfigurationA,1:p._$$ConfigurationB},onerror:this._$dispatchEvent._$bind(this,"onredirect","m=15&t=0",true)};__supModule.__buildModule.apply(this,arguments)};p._$$ModuleA=MWF.C();__proModuleA=p._$$ModuleA._$extend(t._$$Module,true);__supModuleA=p._$$ModuleA._$supro;__proModuleA._$getId=function(){return"15-0"};__proModuleA.__getXhtml=function(){return e._$getHtmlTemplate("m15-jst-0",{tag:this.__tkey})};__proModuleA.__buildModule=function(){__supModuleA.__buildModule.apply(this,arguments)};p._$$ModuleB=MWF.C();__proModuleB=p._$$ModuleB._$extend(t._$$Module,true);__supModuleB=p._$$ModuleB._$supro;__proModuleB._$getId=function(){return"15-1"};__proModuleB.__getXhtml=function(){return e._$getHtmlTemplate("m15-jst-0",{tag:this.__tkey})};__proModuleB.__buildModule=function(){__supModuleB.__buildModule.apply(this,arguments);this.__list=e._$getByClassName(this.__body,this.__tkey);this.__list[0].innerText="由于该用户的权限设置，您无法访问该博客，请返回个人中心继续浏览，感谢您的支持！"}})(MWF.P("mwf.e"),MWF.P("mb.m"),MWF.P("mb.m.m15"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m15"));(function(t,p){var __proConfiguration;p._$$Configuration=MWF.C();__proConfiguration=p._$$Configuration._$extend(t._$$Configuration,true);__proConfiguration.__getModule=function(){return p._$$Module._$allocate(this.__mopt)};__proConfiguration.__getValidator=function(){return p._$$Validator._$allocate(this.__vopt)}})(MWF.P("mwf.ut"),MWF.P("mb.m.m16"));(function(o,u,e,v,w,d,t,j,p){var __proModule,__supModule;p._$$Module=MWF.C();__proModule=p._$$Module._$extend(t._$$Module,true);__supModule=p._$$Module._$supro;__proModule._$getId=function(){return"16"};__proModule.__buildModule=function(_options){__supModule.__buildModule.apply(this,arguments);this.__cache=new d._$$CacheBlog();this.__cache._$addEvent("onblogrecommend",this.__cbRecommendBlogContent._$bind(this));var _list=e._$getByClassName(this.__body,this.__tkey);this.__cnt=_list[0];this.__btn=_list[1];v._$addEvent(this.__btn,"click",this.__onRecommed._$bind(this))};__proModule.__getXhtml=function(){return e._$getHtmlTemplate("m16-jst-1",{tag:this.__tkey})};__proModule._$show=function(_options){__supModule._$show.apply(this,arguments);this.__bid=_options.bid;this.__uname=_options.uname;this.__resetModule()};__proModule.__resetModule=function(){this.__btnDisabled=false;this.__cnt.value=""};__proModule.__cbRecommendBlogContent=function(_bid){if(!!_bid){mb.x.alert("推荐成功！")}else{mb.x.alert("推荐失败！")}this.__btnDisabled=false;t._$$HashManager._$getInstance()._$back(true)};__proModule.__onRecommed=function(){if(!!this.__btnDisabled){return}this.__btnDisabled=true;this.__cache._$recommendBlog(this.__bid,this.__cnt.value||"")}})(MWF.O,MWF.P("mwf.u"),MWF.P("mwf.e"),MWF.P("mwf.v"),MWF.P("mb.w"),MWF.P("mb.d"),MWF.P("mb.m"),MWF.P("mwf.j"),MWF.P("mb.m.m16"));(function(t,p){var __proValidator;p._$$Validator=MWF.C();__proValidator=p._$$Validator._$extend(t._$$Validator,true)})(MWF.P("mb.m"),MWF.P("mb.m.m16"));(function(j,x){mwf.e._$parseTemplate("mwblog-template");window.setTimeout(function(){var _config={};for(var i=0;i<100;i++){_config[i]=MWF.P("mb.m.m"+i)._$$Configuration}var _manager=mb.m._$$HashManager._$getInstance({parent:"mwblog-container",config:_config,onerror:function(){location.hash="#m=0"},onbeforeback:function(_event){if(location.hash=="#m=0"||location.hash=="#m=1&t=0"||location.hash=="#m=2&t=0"||location.hash=="#m=4&t=0"||location.hash=="#m=3&t=0"||location.hash=="#m=3&t=0&r=t"||location.hash=="#m=3&t=1"||location.hash=="#m=3&t=2"||location.hash=="#m=3&t=3"){x.back();_event.stopped=true}}});var _trigger=_manager._$back._$bind(_manager);mwf.mb._$onButtonBack(_trigger)},10)})(MWF.P("mwf.j"),MWF.P("mb.x"));